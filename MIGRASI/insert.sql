ALTER TABLE "TASPEN"."SPTB_HIST"  		ADD CONSTRAINT "FK_SPTB_HIST_PENERIMA_SK"  FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."PENERIMA_SK" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."TMT_PENPOK_HIST" 	ADD CONSTRAINT "FK_TMT_PENPOK_HIST_PENERIMA_SK" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."PENERIMA_SK" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."KTRBYR_HIST"  	ADD CONSTRAINT "FK_KTRBYR_HIST_PENERIMA_SK"  FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."PENERIMA_SK" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."TANDAJASA_HIST"  	ADD CONSTRAINT "FK_TANDAJASA_HIST_PENERIMA_SK"  FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."PENERIMA_SK" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."HITUNG_HIST"  	ADD CONSTRAINT "FK_HITUNG_HIST_PENERIMA_SK"  FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."PENERIMA_SK" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."PENPOK_HIST"  	ADD CONSTRAINT "FK_PENPOK_HIST_PENERIMA_SK"  FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."PENERIMA_SK" ("KDHUBKEL", "NOTAS") ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE "TASPEN"."TRS_HTG_TERLANJUR"ADD CONSTRAINT "FK_TRS_HTG_TERLANJUR_PENERIMA_SK"  FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."PENERIMA_SK" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE RESTRICT;
ALTER TABLE "TASPEN"."KLAIM_ASURANSI" 	ADD CONSTRAINT "FK_KLAIM_ASURANSI_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE "TASPEN"."KLAIM_PENSIUN" 	ADD CONSTRAINT "FK_KLAIM_PENSIUN_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE "TASPEN"."ALAMAT_HIST" 		ADD CONSTRAINT "FK_ALAMAT_HIST_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."PESERTA" 			ADD CONSTRAINT "FK_PESERTA_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE CASCADE ON DELETE CASCADE;
ALTER TABLE "TASPEN"."PENERIMA_SK" 		ADD CONSTRAINT "FK_PENERIMA_SK_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE CASCADE ON DELETE RESTRICT;
ALTER TABLE "TASPEN"."TRS_HTG_SKPP" 	ADD CONSTRAINT "FK_TRS_HTG_SKPP_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE RESTRICT;
ALTER TABLE "TASPEN"."TRANS_ASURANSI" 	ADD CONSTRAINT "FK_TRANS_ASURANSI_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."STAWIN_HIST" 		ADD CONSTRAINT "FK_STAWIN_HIST_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."SKS_HIST" 		ADD CONSTRAINT "SKS_HIST_HIST_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."SKPP" 			ADD CONSTRAINT "FK_SKPP_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."MEDICAL_HIST" 	ADD CONSTRAINT "FK_MEDICAL_HIST_KELUARGA" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."KELUARGA" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;

INSERT INTO TASPEN.JENIS_TRANS_KIPI(JNS_TRANS, NM_JNSTRANS) SELECT JNS_TRANS, NM_JNSTRANS FROM MIG_ACB.JENIS_TRANS_KIPI;
INSERT INTO TASPEN.REF_JENIS_KIPI(JENIS, NM_JENIS) SELECT JENIS, NM_JENIS FROM MIG_ACB.JENIS_KI_PI;
INSERT INTO TASPEN.REF_APLIKASI(KDAPL, NMAPL, INPUTER, UPDSTAMP) SELECT KDAPL, NMAPL,'MIGRASI NCB',CURRENT_DATE FROM MIG_ACB.APLIKASI;
INSERT INTO TASPEN.JENIS_MORTALITA(JNS_MORTALITA, NM_MORTALITA, UPDSTAMP) SELECT JNS_MORTALITA, NM_MORTALITA, UPDSTAMP FROM MIG_ACB.JENIS_MORTALITA;
INSERT INTO TASPEN.REF_BENDAHARA(KDBENDAHARA, KDCABANG, NMBENDAHARA, UPDSTAMP, INPUTER) SELECT KDBENDAHARA, KDCABANG, NMBENDAHARA, UPDSTAMP, INPUTER FROM MIG_ACB.BENDAHARA;
UPSERT TASPEN.REF_CABANG (KDCABANG, NMCABANG, NICKCABANG, ALMTCABANG, KOTA, KODEPOS, TELEPON, LBLSURAT, JMLRUANG, JMLLAJUR, JMLLEMARI, JMLRAK, JMLBOX, KDWILAYAH, KDCABANGTP, KDDATI1, KDDATI2,NOSURAT, NOSKPP, NOSPR, NMKAS, NOGIRO_THT, NOGIRO_PENS, NOLIMPAH, NOJMN, NPWP, HOST_RFC, KDREFORMASI, HOST_ELO, COSTCENTRE, UPDSTAMP, INPUTER, HOST_ANTRI) SELECT KDCABANG, NMCABANG, NICKCABANG, ALMTCABANG, KOTA, KODEPOS, TELEPON, LBLSURAT, JMLRUANG, JMLLAJUR, JMLLEMARI, JMLRAK, JMLBOX, KDWILAYAH, KDCABANGTP, KDDATI1, KDDATI2,NOSURAT, NOSKPP, NOSPR,  NMKAS, NOGIRO_THT, NOGIRO_PENS, NOLIMPAH,NOJMN, NPWP, HOST_RFC, KDREFORMASI, HOST_ELO, COSTCENTRE,  UPDSTAMP,USER, NULL FROM MIG_ACB.CABANG_TBL;
UPSERT TASPEN.REF_DATI1(KDDATI1, NMDATI1, KTDATI1, TKD, KDTKD, UPDSTAMP) SELECT KDDATI1, NMDATI1, KTDATI1, TKD, KDTKD, UPDSTAMP FROM MIG_ACB.DATI1_TBL;
INSERT INTO TASPEN.REF_DATI2(KDDATI2, KDDATI1, NMDATI2, KTDATI2, UPDSTAMP) SELECT KDDATI2, KDDATI1, NMDATI2, KTDATI2, UPDSTAMP FROM MIG_ACB.DATI2_TBL;
INSERT INTO TASPEN.REF_DATI3(KDDATI3, KDDATI2, KDDATI1, NMDATI3, KTDATI3, UPDSTAMP) SELECT KDDATI3, KDDATI2, KDDATI1, NMDATI3, KTDATI3, UPDSTAMP FROM MIG_ACB.DATI3_TBL;
INSERT INTO TASPEN.REF_DATI4(KDDATI4,KDDATI3, KDDATI2, KDDATI1, NMDATI4,  UPDSTAMP)SELECT KDDATI4,KDDATI3, KDDATI2, KDDATI1, NMDATI4, UPDSTAMP FROM MIG_ACB.DATI4_TBL;
INSERT INTO TASPEN.REF_DIRJEN(KDDIRJEN, KDINSTANSI, NMDIRJEN, UPDSTAMP, INPUTER) SELECT KDDIRJEN, KDINSTANSI, NMDIRJEN, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.DIRJEN_TBL;
INSERT INTO TASPEN.REF_HITUNG(KDHIT, NMHIT, UPDSTAMP, INPUTER) SELECT KDHIT, NMHIT, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.HITUNG_TBL;
INSERT INTO TASPEN.REF_JNS_PENERIMA(KDJNSPENERIMA, NMJNSPENERIMA, HAKPEN, UPDSTAMP, INPUTER) SELECT KDJNSPENERIMA, NMJNSPENERIMA, HAKPEN,UPDSTAMP,  'MIGRASI NCB' FROM MIG_ACB.JNS_PENERIMA;
INSERT INTO TASPEN.REF_JNSBAYAR(JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NMJNSBAYAR, UPDSTAMP, INPUTER) SELECT JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NMJNSBAYAR, UPDSTAMP, INPUTER FROM MIG_ACB.JNSBAYAR_TBL;
INSERT INTO TASPEN.REF_JNSDAPEM(KDJNSDAPEM, NMJENDAPEM, UPDSTAMP, INPUTER) SELECT KDJNSDAPEM, NMJENDAPEM, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.JNSDAPEM;
INSERT INTO TASPEN.REF_JNSHUTANG(KDHUTANG, NMHUTANG, RUTIN, KDTRANS, UPDSTAMP, INPUTER) SELECT KDHUTANG, NMHUTANG, RUTIN, KDTRANS, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.JNSHUTANG;
INSERT INTO TASPEN.REF_KASUS(KDKASUS, NMKASUS, UPDSTAMP, INPUTER) SELECT KDKASUS, NMKASUS, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.KASUS_TBL;
INSERT INTO TASPEN.REF_KEJADIAN(KDYMKKEJADIAN, NMKEJADIAN, UPDSTAMP, INPUTER) SELECT KDKEJADIAN, NMKEJADIAN, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.KEJADIAN_TBL;
INSERT INTO TASPEN.REF_KELOMPOK_BAYAR(KDKELBAYAR, NMKELBAYAR, UPDSTAMP, HOSTFTP, FOLDER, FDRDOWNLOAD, FDRUPLOAD, F_EDAPEM, TMT_EDAPEM, TMT_LPJ, TMT_UDW, KDVENDOR, OTENTIKASI, F_LPJ, F_UPD_CABANG, TGLPOSTING, DESKRIPSI_EDAPEM, F_PENYALURAN_DAPEM, INPUTER) SELECT KDKELBAYAR, NMKELBAYAR, UPDSTAMP, HOSTFTP, FOLDER, FDRDOWNLOAD, FDRUPLOAD, F_EDAPEM, TMT_EDAPEM, TMT_LPJ, TMT_UDW, KDVENDOR, OTENTIKASI, F_LPJ, F_UPD_CABANG, TGLPOSTING, DESKRIPSI_EDAPEM, 1,'MIGRASI NCB' FROM MIG_ACB.KELOMPOK_BAYAR;
INSERT INTO TASPEN.REF_KELOMPOK_GAJI(KDKELOMPOK, NMKELOMPOK, MIN_USIA_MASUK, MAX_USIA_MASUK, TERUSAN, UPDSTAMP, KDNIP, UDW, KDJI, NORUT, TMT_GAPOK1, TMT_GAPOK2, TGLRENBAYAR, TMT_GAPOK3, TGLRENBAYAR3, TMT_PENPOK, TMT_PENPOK1, TMTBYR_PENS, TMTBYR_DPM, INPUTER) SELECT KDKELOMPOK, NMKELOMPOK, MIN_USIA_MASUK, MAX_USIA_MASUK, TERUSAN, UPDSTAMP, KDNIP, UDW, KDJI, NORUT, TMT_GAPOK1, TMT_GAPOK2, TGLRENBAYAR, TMT_GAPOK3, TGLRENBAYAR3, TMT_PENPOK, TMT_PENPOK1, TMTBYR_PENS, TMTBYR_DPM, 'MIGRASI NCB' FROM MIG_ACB.KELOMPOK_GAJI;
INSERT INTO TASPEN.REF_KONV_PENSIUN(KDJNSPENSIUN, KETERANGAN, KDJNSHAK, KDKELOMPOK, KDSUBKELPOK, KDKELPENSIUN, KDJNSPENERIMA, SHARINGDANA, UPDSTAMP, KDPTKAI, INPUTER) SELECT KDJNSPENSIUN, KETERANGAN, KDJNSHAK, KDKELOMPOK, KDSUBKELPOK, KDKELPENSIUN, KDJNSPENERIMA, SHARINGDANA, UPDSTAMP, KDPTKAI, 'MIGRASI NCB' FROM MIG_ACB.KONV_PENSIUN;
INSERT INTO TASPEN.REF_KPKN(KDKPKN, KDKPPN, NMKPKN, ALM_KPKN, KOTA, KODEPOS, TELEPON, NOREK, JENIS, KDKASIVA, UPDSTAMP, BANK, KDCABANG, INPUTER) SELECT KDKPKN, KDKPPN, NMKPKN, ALM_KPKN, KOTA, KODEPOS, TELEPON, NOREK, JENIS, KDKASIVA, UPDSTAMP, BANK, KDCABANG, 'MIGRASI NCB' FROM MIG_ACB.KPKN_TBL;
INSERT INTO TASPEN.REF_MAP(KDMAP, JNS_MAP, URAIAN, UPDSTAMP, INPUTER) SELECT KDMAKP, JNS_MAKP, URAIAN, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.MAP_TBL;
INSERT INTO TASPEN.REF_MAP_PAJAK(MAP, DESKIRPSI, UPDSTAMP, INPUTER) SELECT MAP, DESKIRPSI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.MAP_PAJAK;
INSERT INTO TASPEN.REF_PANGKAT(KDPANGKAT, KDKELOMPOK, NMPANGKAT, NMSHORT, KDKONV, UPDSTAMP, INPUTER) SELECT TRIM(KDPANGKAT), KDKELOMPOK, NMPANGKAT, NMSHORT, TRIM(KDKONV), UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.PANGKAT_TBL;
INSERT INTO TASPEN.REF_PRODUK(KDPRODUK, NMPRODUK, TMTPRODUK, UPDSTAMP, TYPE_VOUCHER, DAPEM, INPUTER) SELECT KDPRODUK, NMPRODUK, TMTPRODUK, UPDSTAMP, KDPROGRAM, DAPEM,'MIGRASI NCB' FROM MIG_ACB.PRODUK;
INSERT INTO TASPEN.REF_RETSPTB(KDRETSPTB, NMRETSPTB, UPDSTAMP, INPUTER) SELECT KDRETSPTB, NMRETSPTB, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.RETSPTB_TBL;
INSERT INTO TASPEN.REF_SIFAT_POKOK(KDSIFATPOK, NMSIFATPOK, UPDSTAMP) SELECT KDSIFATPOK, NMSIFATPOK, UPDSTAMP FROM MIG_ACB.SIFAT_POKOK;
INSERT INTO TASPEN.REF_STAWIN(KDSTAWIN, NMSTAWIN, UPDSTAMP) SELECT KDSTAWIN, NMSTAWIN, UPDSTAMP FROM MIG_ACB.STAWIN_TBL;
INSERT INTO TASPEN.REF_STS_STOP(KDSTOP, NMSTOP, UPDSTAMP, INPUTER) SELECT KDSTOP, NMSTOP, UPDSTAMP, INPUTER FROM MIG_ACB.STS_STOP;
INSERT INTO TASPEN.REF_TANDAJASA(KDTNDJASA, NMTNDJASA, TERUSAN, UPDSTAMP, INPUTER) SELECT KDTNDJASA, NMTNDJASA, TERUSAN, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.TANDAJASA_TBL;
INSERT INTO TASPEN.REF_WORKFLOW(KDFLOW, NMFLOW, KETERANGAN, UPDSTAMP, INPUTER) SELECT KDFLOW,  NMFLOW, KETERANGAN, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.WORKFLOW_TBL;
INSERT INTO TASPEN.ANTARA_TBL(KDHUBKEL, NOTAS, KDANTARA, NIPANTARA, NMTASPEN, NMANTARA, NIPTASPEN, KDCABANG, KDSATKER, UPDSTAMP, KDSSBP, KELSSBP) SELECT KDHUBKEL, NOTAS, KDANTARA, NIPANTARA, NMTASPEN, NMANTARA, NIPTASPEN, KDCABANG, KDSATKER, UPDSTAMP, KDSSBP, KELSSBP FROM MIG_ACB.ANTARA_TBL;
INSERT INTO TASPEN.MONITOR_KPR(KDKELBAYAR, TGLIMPORT, NMFILE, UPDSTAMP, INPUTER) SELECT KDKELBAYAR, TGLIMPORT, NMFILE, UPDSTAMP, TRIM(INPUTER) FROM MIG_ACB.MONITOR_KPR;
INSERT INTO TASPEN.REF_AGAMA(KDAGAMA, NMAGAMA, UPDSTAMP) SELECT KDAGAMA, NMAGAMA, UPDSTAMP FROM MIG_ACB.AGAMA_TBL;
INSERT INTO TASPEN.REF_ANUITAS(TGLBERLAKU, KDKELOMPOK, KDKLAIM, KDSTRUKTUR, MASAIUR, NILAI, UPDSTAMP, INPUTER) SELECT TGLBERLAKU, KDKELOMPOK, KDKLAIM, KDSTRUKTUR, MASAIUR, NILAI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.ANUITAS_TBL;
INSERT INTO TASPEN.REF_ASSIGN_JABATAN(TMT_JABATAN, KODE_KEDUDUKAN, KODE_FUNGSIONAL, BUP, NAMA_FUNGSIONAL, TUNJANGAN_FUNGSIONAL, KODE_FUNGSI, UPDSTAMP, INPUTER) SELECT TMT_JABATAN, KODE_KEDUDUKAN, KODE_FUNGSIONAL, BUP, NAMA_FUNGSIONAL, TUNJANGAN_FUNGSIONAL, KODE_FUNGSI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.ASSIGN_JABATAN;
INSERT INTO TASPEN.REF_BAGIAN(KDBAG, KDBIRO, KDDIRJEN, KDINSTANSI, NMBAG, UPDSTAMP, INPUTER) SELECT KDBAG, KDBIRO, KDDIRJEN, KDINSTANSI, NMBAG, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.BAGIAN_TBL;
INSERT INTO TASPEN.REF_BIAYA(TMT_BIAYA, PERSENTASE_BIAYA, UPDSTAMP, INPUTER) SELECT TMT_BIAYA, PERSENTASE_BIAYA, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.BIAYA;
INSERT INTO TASPEN.REF_BIRO(KDBIRO, KDDIRJEN, KDINSTANSI, NMBIRO, UPDSTAMP, INPUTER) SELECT KDBIRO, KDDIRJEN, KDINSTANSI, NMBIRO, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.BIRO_TBL;
INSERT INTO TASPEN.REF_BUNGA(TMT_BUNGA, TINGKAT_BUNGA, NILAI_BUNGA, BUNGA_KONV_BULANAN, UPDSTAMP, INPUTER) SELECT TMT_BUNGA, TINGKAT_BUNGA, NILAI_BUNGA, BUNGA_KONV_BULANAN, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.BUNGA;
INSERT INTO TASPEN.REF_CABANG_TP(KDCABANGTP, NMCABANGTP, UPDSTAMP, INPUTER) SELECT KDCABANGTP, NMCABANGTP, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.CABANG_TP;
INSERT INTO TASPEN.REF_DASARBAYAR(KDSURAT, DESKRIPSI, F1, G1, G2, G3, G4, H1, J1, UPDSTAMP, INPUTER) SELECT KDSURAT, DESKRIPSI, F1, G1, G2, G3, G4, H1, J1, UPDSTAMP, INPUTER FROM MIG_ACB.DASARBAYAR_TBL;
INSERT INTO TASPEN.REF_DANA(KDCABANG, KDPRODUK, KDVOUCHER, KDDANA, NMDANA, STATUS, UPDSTAMP, INPUTER)SELECT KDCABANG, KDPRODUK, KDVOUCHER, KDDANA, NMDANA, STATUS, UPDSTAMP, 'migrasi NCB' FROM  ( SELECT KDCABANG, KDPRODUK, KDVOUCHER, KDDANA, NMDANA, STATUS, UPDSTAMP,ROW_NUMBER() OVER (PARTITION BY KDCABANG, KDPRODUK, KDVOUCHER, KDDANA ORDER BY UPDSTAMP DESC) AS row_num FROM MIG_ACB.DANA_TBL ) WHERE row_num =1;
INSERT INTO TASPEN.REF_DOKUMEN_TP(KDDOKUMEN, NMDOKUMEN, UPDSTAMP) SELECT KDDOKUMEN, NMDOKUMEN, UPDSTAMP FROM MIG_ACB.DOKUMEN_TP;
INSERT INTO TASPEN.REF_ESELON(ECH_ECHCOD, ECH_ECHNAM, ECH_RNKMIN, UPDSTAMP, INPUTER) SELECT ECH_ECHCOD, ECH_ECHNAM, ECH_RNKMIN, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.ESELON;
INSERT INTO TASPEN.REF_FAKTOR_PIPNS(TMT_FAKTOR, KDKELOMPOK, MI, NILAI, UPDSTAMP, INPUTER) SELECT TMT_FAKTOR, KDKELOMPOK, MI, NILAI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.FAKTOR_PIPNS;
UPSERT 		TASPEN.REF_FUNGSI(KDFUNGSI, KDAPL, NMFUNGSI, UPDSTAMP, INPUTER) SELECT KDFUNGSI, KDAPL, NMFUNGSI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.FUNGSI;
INSERT INTO TASPEN.REF_GROUP(KDCABANG, KDBENDAHARA, KDGROUP, KDKELBAYAR, NMGROUPTBL, UPDSTAMP, INPUTER) SELECT KDCABANG, KDBENDAHARA, KDGROUP, KDKELBAYAR, NMGROUPTBL, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.GROUP_TBL;
INSERT INTO TASPEN.REF_GROUP_BAYAR(KDGROUP, KDBENDAHARA, KDCABANG, NMGROUP, FAX, ALM_GROUP, KOTA, KODEPOS, TELEPON, UPDSTAMP, INPUTER, NOURUT) SELECT KDGROUP, KDBENDAHARA, KDCABANG, NMGROUP, FAX, ALM_GROUP, KOTA, KODEPOS, TELEPON, UPDSTAMP, INPUTER, NOURUT FROM MIG_ACB.GROUP_BAYAR;
INSERT INTO TASPEN.REF_HITTRANS(TMTHIT, KDHIT, TMT_TRANS, KDTRANS, KETERANGAN_HIT, KODEX, UPDSTAMP, INPUTER) SELECT TMTHIT, KDHIT, TMT_TRANS, KDTRANS, KETERANGAN_HIT, KODEX, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.HITTRANS_TBL;
INSERT INTO TASPEN.REF_HOLIDAY(TGLHOLIDAY, JNSHOLIDAY, KETERANGAN, UPDSTAMP, INPUTER) SELECT TGLHOLIDAY, JNSHOLIDAY, KETERANGAN, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.HOLIDAY_TBL;
INSERT INTO TASPEN.REF_HUBKEL(KDHUBKEL, NMHUBKEL, UPDSTAMP, INPUTER) SELECT KDHUBKEL, NMHUBKEL, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.HUBKEL_TBL;
INSERT INTO TASPEN.REF_INFOMITRA(KDSTATUS, KETERANGAN, UPDSTAMP, INPUTER) SELECT KDSTATUS, KETERANGAN, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.INFOMITRA;
INSERT INTO TASPEN.REF_INSTANSI(KDINSTANSI, KDINSTANSITP, NMINSTANSI, UPDSTAMP, INPUTER) SELECT KDINSTANSI, KDINSTANSITP, NMINSTANSI, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.INSTANSI;
INSERT INTO TASPEN.REF_INSTANSI_BKN(INS_INSKOD, INS_NAMINS, INS_NEWKOD, KODE_LAMA, JENIS, LOKASI, LOKER, INS_KANREG, INS_NAMINSBR, UPDSTAMP, INPUTER) SELECT INS_INSKOD, INS_NAMINS, INS_NEWKOD, KODE_LAMA, JENIS, LOKASI, LOKER, INS_KANREG, INS_NAMINSBR, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.INSTANSI_BKN;
INSERT INTO TASPEN.REF_INSTANSI_TP(KDINSTANSITP, NMINSTANSITP, UPDSTAMP, INPUTER) SELECT KDINSTANSITP, NMINSTANSITP, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.INSTANSI_TP;
INSERT INTO TASPEN.REF_INTERNAL_ORDER(KDPRODUK, KDKELOMPOK, KDGSBER, NAMA_ORDER) SELECT KDPRODUK, KDKELOMPOK, KDGSBER, NAMA_ORDER FROM MIG_ACB.INTERNAL_ORDER;
INSERT INTO TASPEN.REF_JNS_SKEP(KDJNSSKEP, NMJNSSKEP, UPDSTAMP, INPUTER) SELECT KDJNSSKEP, NMJNSSKEP, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.JNS_SKEP;
INSERT INTO TASPEN.REF_JNSPEG(KDJNSPEG, NMJENPEG, KODE, UPDSTAMP, INPUTER) SELECT KDJENPEG, NMJENPEG,1, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.JENPEG_TBL;
INSERT INTO TASPEN.REF_JNSTRANS(KDJNSTRANS, KDPRODUK, KDKELOMPOK, NMJNSTRANS, UPDSTAMP, INPUTER) SELECT KDJNSTRANS, KDPRODUK, KDKELOMPOK, NMJNSTRANS, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.JNSTRANS;
INSERT INTO TASPEN.REF_KASIVA(KDKASIVA, NMKASIVA, KDDATI1) SELECT KDKASIVA, NMKASIVA, KDDATI1 FROM MIG_ACB.KASIVA_TBL;
INSERT INTO TASPEN.REF_KD_TRANSAKSI(KDSTATUS, DESKRISP, UPDSTAMP, INPUTER) SELECT KDSTATUS, DESKRISP, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KD_TRANSAKSI;
INSERT INTO TASPEN.REF_KEL_KEJADIAN(KDKELJADIAN, NMKELKEJADIAN, UPDSTAMP, INPUTER) SELECT KDKELJADIAN, NMKELKEJADIAN, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.KEL_KEJADIAN;
INSERT INTO TASPEN.REF_KELPENSIUN(KDKELPENSIUN, NMKELPENSIUN, UPDSTAMP, MAK, INPUTER) SELECT KDKELPENSIUN, NMKELPENSIUN, UPDSTAMP, MAK, 'MIGRASI NCB' FROM MIG_ACB.KELPENSIUN_TBL;
INSERT INTO TASPEN.REF_KENAIKAN_GAPOK(TMT_BERLAKU, KENAIKAN, UPDSTAMP, INPUTER) SELECT TMT_BERLAKU, KENAIKAN, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KENAIKAN_GAPOK;
INSERT INTO TASPEN.REF_KLAIM(KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, NMKLAIM, NMSHORT, UPDSTAMP, INPUTER) SELECT KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, NMKLAIM, NMSHORT, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.KLAIM;
INSERT INTO TASPEN.REF_KLAIM_PERSYARATAN(KDKLAIM, KDJNSTRANS, KDPRODUK, NMKLAIM, NMSHORT, UPDSTAMP, INPUTER) SELECT KDKLAIM, KDJNSTRANS, KDPRODUK, NMKLAIM, NMSHORT, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KLAIM_PERSYARATAN;
INSERT INTO TASPEN.REF_KODEPOS(KODEPOS, NOURUT, NMKODEPOS, UPDSTAMP, INPUTER) SELECT KODEPOS, NOURUT, NMKODEPOS, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KODEPOS_TBL;
INSERT INTO TASPEN.REF_KONSTANTA(NOMOR, KONSTANTA, DESCRIPTION, TMT_JABATAN, MAX, NOURUT, UPDSTAMP, INPUTER) SELECT NOMOR, KONSTANTA, DESCRIPTION, TMT_JABATAN, MAX, NOURUT, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KONSTANTA_TBL;
INSERT INTO TASPEN.REF_KONV_DAPEM(KDJNSDAPEM, KDJNSPENSIUN, KETERANGAN, UPDSTAMP, INPUTER) SELECT KDJNSDAPEM, KDJNSPENSIUN, KETERANGAN, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.KONV_DAPEM;
INSERT INTO TASPEN.REF_KTRBYR_SETOR(NOKTRSETOR, TGLKTRSETOR, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, UPDSTAMP, INPUTER) SELECT NOKTRSETOR, TGLKTRSETOR, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, UPDSTAMP, INPUTER FROM MIG_ACB.KTRBYR_SETOR;
INSERT INTO TASPEN.REF_LAMPIRAN_SK(NMLAMPIRAN, KDJNSTRANS, KDPRODUK, KDKELOMPOK, KDKLAIM, MANDATORI, ASLI, LEMBAR, UPDSTAMP, INPUTER) SELECT NMLAMPIRAN, KDJNSTRANS, KDPRODUK, KDKELOMPOK, KDKLAIM, MANDATORI, ASLI, LEMBAR, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.LAMPIRAN_SK;
INSERT INTO TASPEN.REF_LAMPIRAN_SPP(TGLKLAIM, KDHUBKEL, NOTAS, KDJNSTRANS, KDPRODUK, KDKELOMPOK, KDLAMPIRAN, UPDSTAMP, INPUTER) SELECT TGLKLAIM, KDHUBKEL, NOTAS, KDJNSTRANS, KDPRODUK, KDKELOMPOK, KDLAMPIRAN, UPDSTAMP, INPUTER FROM MIG_ACB.LAMPIRANSPP;
INSERT INTO TASPEN.REF_LAMPIRANFORMULIR(KDLAMPIRAN, NMLAMPIRAN, UPDSTAMP, INPUTER) SELECT KDLAMPIRAN, NMLAMPIRAN, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.LAMPIRANFORMULIR;
INSERT INTO TASPEN.REF_MEMFILE(KDCABANG, KDPRODUK, TAHUN, NOVOUCHER, NOCEKPOS, UPDSTAMP, INPUTER) SELECT KDCABANG, KDPRODUK, TAHUN, NOVOUCHER, NOCEKPOS, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.MEMFILE;
INSERT INTO TASPEN.REF_MISC(UPDDATE, JABPCT, JABMAX, PSNPCT, PSNMAX,  SELF, COUPLE, DEPEND, DEPENDMAX, SHF11, SHF12, SHF13, SHF21, SHF22, SHF23, SHF31, SHF32, SHF33, VACBON, THRBON, REMOTE_1, REMOTE_2, REMOTE_3, STBYN, STBYS, STBYH, ASTEK, ASTEK_COY, WHR_MONTH, DAY_MONTH, OVTWKD, OVTNWKD, OVTNWKD7, INSURANCE, THT, THT_COY, PHT, PHT_COY, AKTK, AKTK_COY, BC, BC_COY, KDUPD, TGLINP, USERINP, TGLOTO, USEROTO, OVT1, OVT2, OVT3, GANTI, PTKPT, TAXSUB, TAXMAX, OPTSHIFT, UPDSTAMP, INPUTER) SELECT UPDDATE, JABPCT, JABMAX, PSNPCT, PSNMAX, SELF, COUPLE, DEPEND, DEPENDMAX, SHF11, SHF12, SHF13, SHF21, SHF22, SHF23, SHF31, SHF32, SHF33, VACBON, THRBON, REMOTE_1, REMOTE_2, REMOTE_3, STBYN, STBYS, STBYH, ASTEK, ASTEK_COY, WHR_MONTH, DAY_MONTH, OVTWKD, OVTNWKD, OVTNWKD7, INSURANCE, THT, THT_COY, PHT, PHT_COY, AKTK, AKTK_COY, BC, BC_COY, KDUPD, TGLINP, USERINP, TGLOTO, USEROTO, OVT1, OVT2, OVT3, GANTI, PTKPT, TAXSUB, TAXMAX, OPTSHIFT, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.MISC_TBL;
INSERT INTO TASPEN.REF_NODOSIR(KDCABANG, KDPRODUK, NODOSIR, UPDSTAMP, INPUTER) SELECT KDCABANG, KDPRODUK, NODOSIR, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.NODOSIR_TBL;
INSERT INTO TASPEN.REF_NODOSIR_PUNAH(KDCABANG, KDPRODUK, NODOSIR, UPDSTAMP, NODOSIR_B, INPUTER) SELECT KDCABANG, KDPRODUK, NODOSIR, UPDSTAMP, NODOSIR_B,'MIGRASI NCB' FROM MIG_ACB.NODOSIR_PUNAH;
INSERT INTO TASPEN.REF_PENERBIT_SKEP(KDPENSKEP, ALM_PNBTSKEP, KOTA, KODEPOS, TELEPON, KEPADA_AJUAN, UPDSTAMP, INPUTER) SELECT KDPENSKEP, ALM_PNBTSKEP, KOTA, KODEPOS, TELEPON, KEPADA_AJUAN, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.PENERBIT_SKEP;
INSERT INTO TASPEN.REF_POS(KODEPOS, NOURUT, NMKODEPOS, UPDSTAMP, INPUTER) SELECT KODEPOS, NOURUT, NMKODEPOS, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.POS_TBL;
INSERT INTO TASPEN.REF_PROGRAM(KODE_AREA, NMPROGRAM, TYPE_VOUCHER, NMPRODUK, TMTPROGRAM, UPDSTAMP, INPUTER) SELECT KDPROGRAM, NMPROGRAM, TYPE_VOUCHER, NMPRODUK, TMTPROGRAM, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.PROGRAM;
INSERT INTO TASPEN.REF_SANTUNAN_CACAT(KDCACAT, DESCRIPTION, PROSENTASE, JNSCACAT, UPDSTAMP, INPUTER) SELECT KDCACAT, DESCRIPTION, PROSENTASE, JNSCACAT,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.SANTUNAN_CACAT;
INSERT INTO TASPEN.REF_SANTUNAN_STOP(KDSTOP, NMSTOP, UPDSTAMP, INPUTER) SELECT KDSTOP, NMSTOP, UPDSTAMP, INPUTER FROM MIG_ACB.SANTUNAN_STOP;
INSERT INTO TASPEN.REF_SATKER_HUTANG(KDKEMENTRIAN, NMKEMENTRIAN, KD_ESELON, KD_SATKER, NM_SATKER, KDINST, NMINSTANSI, UPDSTAMP, INPUTER) SELECT KDKEMEN, NAMA_KEMENTRIAN, KD_ESELON, KD_SATKER, NM_SATKER, KDINST, NMINSTANSI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.SATKER_HUTANG;
INSERT INTO TASPEN.REF_SETORAN_KASNEG(KODE_SATKER, NAMA_SATKER, NAMA_KEMENTRIAN, KDMAP, NTPN, NO_SETOR, TGL_SETOR, NOMINAL, KDCABANG, JNS_SETOR, UPDSTAMP, INPUTER) SELECT KODE_SATKER, NAMA_SATKER, NAMA_KEMENTRIAN, KDMAP, NTPN, NO_SETOR, TGL_SETOR, NOMINAL, KDCAB, JNS_SETOR, UPDSTAMP, INPUTER FROM MIG_ACB.SETORAN_KASNEG;
INSERT INTO TASPEN.REF_SIMGAJI(KDCABANG, KDDATI1, KDDATI2, NMDATI2, SOSIALISASI, WORKSHOP, PARALEL, IMPLEMENTASI, PKS, KETERANGAN, INTEGRASI, UPDSTAMP, INPUTER) SELECT KDCABANG, KDDATI1, KDDATI2, NMDATI2, SOSIALISASI, WORKSHOP, PARALEL, IMPLEMENTASI, PKS, KETERANGAN, INTEGRASI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.SIMGAJI;
UPSERT 		TASPEN.REF_SKEP(NOSKEP, TGLSKEP, STSSKEP, KDSKPO, TMTSKEP, TMTREKAM, KDJNSSKEP, KDPENSKEP, TGLTERIMA, UPDSTAMP, INPUTER) SELECT NOSKEP, TGLSKEP, STSSKEP, KDSKPO, TMTSKEP, TMTREKAM, KDJNSSKEP, KDPENSKEP, TGLTERIMA, UPDSTAMP, INPUTER FROM MIG_ACB.SKEP;
INSERT INTO TASPEN.REF_STAPEG(KDSTAPEG, NMSTAPEG, UPDSTAMP, INPUTER) SELECT KDSTAPEG, NMSTAPEG, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.STAPEG_TBL;
INSERT INTO TASPEN.REF_STS_DAMU(KDSTSDAMU, NMSTSDAMU, UPDSTAMP, INPUTER) SELECT KDSTSDAMU, NMSTSDAMU, UPDSTAMP, INPUTER FROM MIG_ACB.STS_DAMU;
INSERT INTO TASPEN.REF_SUMBER_SPP(KD_SUMBER_SPP, NM_SUMBER_SPP) SELECT KD_SUMBER_SPP, NM_SUMBER_SPP FROM MIG_ACB.SUMBER_SPP;
INSERT INTO TASPEN.REF_SYARATKLIM(KDPRODUK, KDKELOMPOK, KDJNSTRANS, KDKLAIM, KDLAMPIRAN, MANDATORI) SELECT KDPRODUK, KDKELOMPOK, KDJNSTRANS, KDKLAIM, KDLAMPIRAN, MANDATORI FROM MIG_ACB.SYARATKLIM;
INSERT INTO TASPEN.REF_TANGGAL_LKO(TMT_AWAL, TAT_AKHIR, TGLRENCANA_BAYAR) SELECT TMT_AWAL, TAT_AKHIR, TGLRENCANA_BAYAR FROM MIG_ACB.TANGGAL_LKO;
INSERT INTO TASPEN.REF_TAX(TMTBERLAKU, TAXSEQ, INCOME_LIMIT, TAXLIMIT, PERCENT, INCOME_MIN, KDUPD, TGLINP, USERINP, TGLOTO, USEROTO, TAXSLIMIT, PERCENTS, INCOME_MINS, UPDSTAMP, INPUTER) SELECT TMTBERLAKU, TAXSEQ, INCOME_LIMIT, TAXLIMIT, PERCENT, INCOME_MIN, KDUPD, TGLINP, USERINP, TGLOTO, USEROTO, TAXSLIMIT, PERCENTS, INCOME_MINS, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.TAX_TBL;
INSERT INTO TASPEN.REF_TBL_BUNGA(TMT_BERLAKU, NILAI, NILAI1, BUNGA) SELECT TMT_BERLAKU, NILAI, NILAI1, BUNGA FROM MIG_ACB.TBL_BUNGA;
INSERT INTO TASPEN.REF_THP_KLAIM(TMT_THPKLAIM, KDKELOMPOK, RGAPOK, RINSTRI, RANAK, RPERUS, RSTRUK, UPDSTAMP) SELECT TMT_THPKLAIM, KDKELOMPOK, RGAPOK, RINSTRI, RANAK, RPERUS, RSTRUK, UPDSTAMP FROM MIG_ACB.THP_KLAIM;
INSERT INTO TASPEN.REF_TPP_TKD(KDPRODUK, KDKELOMPOK, TMT_TRANS, KDTRANS, PCTSAL, NOMSAL, UPDSTAMP, INPUTER) SELECT KDPRODUK, KDKELOMPOK, TMT_TRANS, KDTRANS, PCTSAL, NOMSAL, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KELOMPOK_TUN;
INSERT INTO TASPEN.REF_TRANS(TMT_TRANS, KDTRANS, NMTRANS, DKTRANS, KDPRODUK, TRRUTIN, REFSAL, INSCALC, UDW, NOMINAL, UPDSTAMP, NORUT, REFINS, TMT_EFEKTIF, TMT_DAPEM, INPUTER) SELECT TMT_TRANS, KDTRANS, NMTRANS, DKTRANS, KDPRODUK, TRRUTIN, REFSAL, INSCALC, UDW, NOMINAL, UPDSTAMP, NORUT, REFINS, TMT_EFEKTIF, TMT_DAPEM, 'MIGRASI NCB' FROM MIG_ACB.TRANS_TBL;
INSERT INTO TASPEN.REF_TRANS_JKKJKM(TMT_TRANS, KDTRANS, NMTRANS, DKTRANS, KDPRODUK, KDJNSTRANS, PROSENTASE, PENGALI, TARIF, MAKSIMAL, TARIFSD, TARIFSMP, TARIFSMA, TARIFMAHASISWA, BERKALA, BLNBERKALA, TMT_EFEKTIF, TMT_DAPEM, NORUT, UPDSTAMP, INPUTER, ANGKUTDARAT, ANGKUTLAUT, ANGKUTUDARA) SELECT TMT_TRANS, KDTRANS, NMTRANS, DKTRANS, KDPRODUK, KDJNSTRANS, PROSENTASE, PENGALI, TARIF, MAKSIMAL, TARIFSD, TARIFSMP, TARIFSMA, TARIFMAHASISWA, BERKALA, BLNBERKALA, TMT_EFEKTIF, TMT_DAPEM, NORUT, UPDSTAMP, INPUTER, ANGKUTDARAT, ANGKUTLAUT, ANGKUTUDARA FROM MIG_ACB.TRANSTBL_JKKJKM;
INSERT INTO TASPEN.REF_TUNJANGAN_CACAT(KDCACAT, DESCRIPTION, PROSENTASE, UPDSTAMP, INPUTER) SELECT KDCACAT, DESCRIPTION, PROSENTASE, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.TUNJANGAN_CACAT;
INSERT INTO TASPEN.REF_UKP(KDUKP, NMUKP) SELECT KD_UKP, NM_UKP FROM MIG_ACB.UKP_TBL;
INSERT INTO TASPEN.REF_VACUM(KDVACUM, NMVAKUM, UPDSTAMP, INPUTER) SELECT KDVACUM, NMVAKUM, UPDSTAMP, INPUTER FROM MIG_ACB.VACUM_TBL;
INSERT INTO TASPEN.REF_WLY_KERJA(KDCABANG, KDDATI1, KDDATI2, NMDATI2, UPDSTAMP, INPUTER) SELECT KDCABANG, KDDATI1, KDDATI2, NMDATI2, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.WILAYAH_KERJA;
INSERT INTO TASPEN.REF_WILAYAH(KDWILAYAH, NMWILAYAH) SELECT KDWILAYAH, NMWILAYAH FROM MIG_ACB.WILAYAH_TBL;
INSERT INTO TASPEN.SURAT_PENGANTAR(NOSURANTAR, TGLSURATANTAR, KDCABANG, KDPENSKEP, UPDSTAMP, INPUTER) SELECT NOSURANTAR, TGLSURATANTAR, KDCABANG, KDPENSKEP, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.SURAT_PENGANTAR;
INSERT INTO TASPEN.REF_FAKTOR(TMT_FAKTOR, TAHUN_MI, KDKELOMPOK, MASAIURAN, NILAI, NILAI1, UPDSTAMP, KDPRODUK, NILAI2, INPUTER) SELECT TMT_FAKTOR, TAHUN_MI, KDKELOMPOK, MASAIURAN, NILAI, NILAI1, UPDSTAMP, KDPRODUK, NILAI2, 'MIGRASI NCB' FROM MIG_ACB.FAKTOR_TBL;
INSERT INTO TASPEN.REF_FORMULAKLIM(TMT_FORMULA, KDYMKKEJADIAN, KDKELJADIAN, KDKLAIM, KDPRODUK, KDKELOMPOK, KOOFISIEN1, KOOFISIEN2, ASKEM, FAKTOR1, FAKTOR2, MANFAAT_MINIMAL, ASKEM_MINIMAL, URAIAN_FORMULA, KETERANGAN, UPDSTAMP, INPUTER) SELECT TMT_FORMULA, KDKEJADIAN, KDKELJADIAN, KDKLAIM, KDPRODUK, KDKELOMPOK, KOOFISIEN1, KOOFISIEN2, ASKEM, FAKTOR1, FAKTOR2, MANFAAT_MINIMAL, ASKEM_MINIMAL, URAIAN_FORMULA, KETERANGAN, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.FORMULA_KLIM;
INSERT INTO TASPEN.REF_GAPOK(MASKER, TMT_GAPOK, KDPANGKAT, KDKELOMPOK, NILAI_BAWAH, NILAI_ATAS, UPDSTAMP, INPUTER) SELECT MASKER, TMT_GAPOK, TRIM(KDPANGKAT), KDKELOMPOK, NILAI_BAWAH, NILAI_ATAS, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.GAPOK_TBL;
INSERT INTO TASPEN.REF_HAKUDW(TMT_HAKUDW, KDJNSPENERIMA, KDKELOMPOK, NILAI_UDW, UPDSTAMP, INPUTER) SELECT TMT_HAKUDW, KDJNSPENERIMA, KDKELOMPOK, NILAI_UDW, UPDSTAMP, 'MIGRASI NCB' FROM MIG_ACB.HAKUDW_TBL;
INSERT INTO TASPEN.REF_JNSSETORPAJAK(MAP, JENIS_SETORAN, JNS_PAJAK, DESKRIPSI, UPDSTAMP, INPUTER) SELECT MAP, JENIS_SETORAN, JNS_PAJAK, DESKRIPSI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.JNS_SETOR_PAJAK;
INSERT INTO TASPEN.REF_MINIMAL_HAK(KDKELOMPOK, KDPRODUK, KDKLAIM, TMT_BERLAKU, NILAI, UPDSTAMP, INPUTER) SELECT KDKELOMPOK, KDPRODUK, KDKLAIM, TMT_BERLAKU, NILAI, CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.MINIMAL_HAK;
INSERT INTO TASPEN.REF_PENPOK(MASKER, JMLANAK, TMT_PENPOK, KDJNSPENERIMA, KDPANGKAT, KDKELOMPOK, KDSIFATPOK, PENPOK, UPDSTAMP, MASKER_LAST, INPUTER) SELECT MASKER, JMLANAK, TMT_PENPOK, KDJNSPENERIMA, TRIM(KDPANGKAT), KDKELOMPOK, KDSIFATPOK, PENPOK, UPDSTAMP, MASKER_LAST, 'MIGRASI NCB' FROM MIG_ACB.PENPOK_TBL;
INSERT INTO TASPEN.REF_JURU_BAYAR(KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NMKANBYR, ALM_JRBYR, KODEPOS, TELEPON, KDDATI2, KDDATI1, UPDSTAMP, INPUTER, NOURUT, KDBACKUPDPM, KDCEKPOS, KDKELBAYAR, KODE, KDJURUBAYAR, KDKPKN, STATUS) SELECT KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NMKANBYR, ALM_JRBYR, KODEPOS, TELEPON, KDDATI2, KDDATI1, UPDSTAMP, INPUTER, NOURUT, KDBACKUPDPM, KDCEKPOS, KDKELBAYAR, KODE, KDJURUBAYAR, KDKPKN, STATUS FROM MIG_ACB.JURU_BAYAR;
INSERT INTO TASPEN.REF_SSBP(KDCABANG, KELSSBP, KDKPKN, KDSSBP, NMSSBP, KDDATI1, KDDATI2, KDKELOMPOK, NEWCUST, OLDCUST_ASS, OLDCUST_PENS, ID_ASS, ID_PENS, FLAG, TMTBERLAKU, ID_JKK, ID_JKM, UPDSTAMP, INPUTER) SELECT KDCABANG, KELSSBP, KDKPKN, KDSSBP, NMSSBP, KDDATI1, KDDATI2, KDKELOMPOK, NEWCUST, OLDCUST_ASS, OLDCUST_PENS, ID_ASS, ID_PENS, FLAG, TMTBERLAKU, ID_JKK, ID_JKM, UPDSTAMP, INPUTER FROM MIG_ACB.SSBP_TBL WHERE NMSSBP IS NOT NULL;
upsert 		TASPEN.REF_SKPD(KDCABANG, KDSSBP, KDSKPD, NMSKPD, UPDSTAMP, INPUTER, KELSSBP) SELECT A.KDCABANG, A.KDSSBP, A.KDSKPD, A.NMSKPD, A.UPDSTAMP, A.INPUTER, A.KELSSBP FROM MIG_ACB.SKPD_TBL  A inner join TASPEN.REF_SSBP b on a.KDCABANG = b.KDCABANG and a.KELSSBP = b.KELSSBP and a.KDSSBP = b.KDSSBP;
INSERT INTO TASPEN.REF_FORMKLIM(KDPRODUK, KDKLAIM, URAIAN, NORUT, UPDSTAMP, INPUTER, ISMANDATORY) SELECT KDPRODUK, KDKLAIM, URAIAN, NORUT, UPDSTAMP, INPUTER, ISMANDATORY FROM (SELECT KDPRODUK, KDKLAIM, URAIAN, NORUT, CURRENT_DATE UPDSTAMP,'MIGRASI NCB' INPUTER,TRUE ISMANDATORY,ROW_NUMBER() OVER (PARTITION BY KDPRODUK, KDKLAIM, NORUT ORDER BY NORUT DESC) RN FROM MIG_ACB.FORMKLIM) WHERE RN =1;
INSERT INTO TASPEN.REF_SATKER(KDSATKER, KDBAG, KDBIRO, KDDIRJEN, KDINSTANSI, KDDATI4, KDDATI3, KDDATI2, KDDATI1, NMSATKER, KDKPKN, ALAMAT, NOTELP, UPDSTAMP, KDCABANG, INPUTER, KDSKPD, KDSSBP, SATKERPEMDA, KELSSBP) SELECT KDSATKER, KDBAG, KDBIRO, KDDIRJEN, KDINSTANSI, KDDATI4, KDDATI3, KDDATI2, KDDATI1, NMSATKER, KDKPKN, ALAMAT, NOTELP, A.UPDSTAMP, A.KDCABANG, A.INPUTER, A.KDSKPD, A.KDSSBP, A.SATKERPEMDA, A.KELSSBP FROM MIG_ACB.SATKER_TBL as A INNER JOIN TASPEN.REF_SKPD B ON A.KDCABANG = B.KDCABANG AND A.KDSSBP   = B.KDSSBP   AND A.KDSKPD   = B.KDSKPD   AND A.KELSSBP  = B.KELSSBP;

-- LEVEL1
INSERT INTO TASPEN.ALAT_HIST(KODE, NOTAS, TGLKLAIM, NOURUT, TARIF, PROSENTASE, PENGGANTIAN, UPDSTAMP, INPUTER) SELECT 1,TRIM(NOTAS), TGLKLAIM, NOURUT, TARIF, PROSENTASE, PENGGANTIAN, UPDSTAMP,INPUTER  FROM MIG_ACB.ALAT_BANTU;
INSERT INTO TASPEN.ALAT_HIST(KODE, NOTAS, TGLKLAIM, NOURUT, TARIF, PROSENTASE, PENGGANTIAN, UPDSTAMP, INPUTER) SELECT 2,TRIM(NOTAS), TGLKLAIM, NOURUT, TARIF, PROSENTASE, PENGGANTIAN, UPDSTAMP,INPUTER  FROM MIG_ACB.ALAT_GANTI;
INSERT INTO TASPEN.ANTRIAN_HIST(KDCABANG, NOANTRI, NOTAS, TGLANTRI, TGLPANGGIL, KDANTRI, TGLKLAIM, KDTUNDA, STSPANGGIL, SUMBER_SPP, KDLOKASI, UPDSTAMP, INPUTER) SELECT KDCABANG, NO_ANTRI, TRIM(NOTAS), TGL_ANTRI, TGL_PANGGIL, KDANTRI, TGLKLAIM, KD_TUNDA, STS_PANGGIL, SUMBER_SPP,NULL,CURRENT_DATE,INPUTER  FROM MIG_ACB.ANTRIAN_HIST;
INSERT INTO TASPEN.APPROVE_AKTIF(BLTHLAPORAN, KDCABANG, KDKELOMPOK, NMKELOMPOK, BULANLALU, PMK, BARU, HAPUS, BULANKINI, INPUTER, UPDSTAMP) SELECT BLTHLAPORAN, KDCABANG, KDKELOMPOK, NMKELOMPOK, BULANLALU, PMK, BARU, HAPUS, BULANKINI, INPUTER, UPDSTAMP FROM MIG_ACB.APPROVE_AKTIF;
INSERT INTO TASPEN.APPROVE_DENDA(KDCABANG, TGLCATAT, TGL_SETUJU, OTORISATOR, UPDSTAMP, INPUTER) SELECT KDCABANG, TGLCATAT, TGL_SETUJU, OTORISATOR,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.APPROVAL_DENDA;
INSERT INTO TASPEN.APPROVE_KLAIM(KDCABANG, BLTHLAPORAN, KDPRODUK, NMPRODUK, DITERIMA, CLOSING, POSTING, JUMLAH, INPUTER, UPDSTAMP) SELECT KDCABANG, BLTHLAPORAN, KDPRODUK, NMPRODUK, DITERIMA, CLOSING, POSTING, JUMLAH, INPUTER, UPDSTAMP FROM MIG_ACB.APPROVE_KLAIM;
INSERT INTO TASPEN.APPROVE_KTRBYR(TMT_KTRBYR, KDHUBKEL, NOTAS, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NORUT_DAPEM, NOREKA, INPUTER_MUTASI, TGL_MUTASI, INPUTER_APPROVE, TGL_APPROVE, FLAG, UPDSTAMP, ALAMAT, KOTA, KDPOS, KDDATI1, KDDATI2, KDDATI3, KDDATI4, NOHP, TELEPON, EMAIL, KDCABANG_LAMA) SELECT TMT_KTRBYR, KDHUBKEL, TRIM(NOTAS), KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NORUT_DAPEM, NOREKA, INPUTER_MUTASI, TGL_MUTASI, INPUTER_APPROVE, TGL_APPROVE, FLAG, UPDSTAMP,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM MIG_ACB.APPROVE_KTRBYR;
INSERT INTO TASPEN.ASUR_CEKPOS(KDHUBKEL, NOTAS, NOCEKPOS, TGLKLAIM, STSKEMBALI, TGLCAIR, TGLKEMBALI, KDCEKPOS, UPDSTAMP, INPUTER) SELECT KDHUBKEL, TRIM(NOTAS), NOCEKPOS, TGLKLAIM, STSKEMBALI, TGLCAIR, TGLKEMBALI, KDCEKPOS, UPDSTAMP, INPUTER FROM MIG_ACB.ASUR_CEKPOS;
INSERT INTO TASPEN.B1KELUAR(TGLKLAIM, NOTAS, TGLTRANSAKSI, NILAI, KDCABANG, UPDSTAMP, INPUTER, NOTASLAIN) SELECT TGLKLAIM, TRIM(NOTAS), TGLTRANSAKSI, NILAI, KDCABANG, UPDSTAMP, INPUTER, NOTASLAIN FROM MIG_ACB.B1KELUAR;
INSERT INTO TASPEN.BATCH_RIWAYAT_KIPI(PERIODE, NOTAS, JENIS_KIPI, TMT_KIPI, TAT_KIPI, TGLVALUASI, MI_KIPI_THT_YY, MI_KIPI_THT_MM, MI_KIPI_PEN_YY, MI_KIPI_PEN_MM, KETERANGAN, TGLPMK, UPDSTAMP, INPUTER) SELECT PERIODE, TRIM(NOTAS), JENIS_KIPI, TMT_KIPI, TAT_KIPI, TGLVALUASI, MI_KIPI_THT_YY, MI_KIPI_THT_MM, MI_KIPI_PEN_YY, MI_KIPI_PEN_MM, KETERANGAN, TGLPMK,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.BATCH_RIWAYAT_KIPI;
INSERT INTO TASPEN.BATCH_RIWAYAT_UPAH(KDKELOMPOK, NOTAS, TMT_UPAH, TAT_UPAH, ISTRI, ANAK, GAPOK, PROSENTASE, PANGKAT, KETERANGAN, JABATAN, TAHUN, BULAN, N_BULAN, M1_BULAN, M2_BULAN, THP, PREMI_THT, PREMI_PENS, M1_BUNGA, M2_BUNGA, RP_BUNGA_PENS, RP_BUNGA_THT, JNS_TRANS, RP_JABATAN, PREMI_MGS, RP_BUNGA_MGS, JNS_PESERTA, JENIS_KIPI, TGLVALUASI, UPDSTAMP, INPUTER) SELECT KDKELOMPOK, TRIM(NOTAS), TMT_UPAH, TAT_UPAH, ISTRI, ANAK, GAPOK, PROSENTASE, PANGKAT, KETERANGAN, JABATAN, TAHUN, BULAN, N_BULAN, M1_BULAN, M2_BULAN, THP, PREMI_THT, PREMI_PENS, M1_BUNGA, M2_BUNGA, RP_BUNGA_PENS, RP_BUNGA_THT, JNS_TRANS, RP_JABATAN, PREMI_MGS, RP_BUNGA_MGS, JNS_PESERTA, JENIS_KIPI, TGLVALUASI,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.BATCH_RIWAYAT_UPAH;
INSERT INTO TASPEN.BELANJA_PENSIUN(BLTHPENCAIRAN, KDKELPENSIUN, JMLPENSIUN, RUPIAH, UPDSTAMP, INPUTER, KDJNSTRANS, SISA, REALISASI, KOMPENSASI, KURANGLEBIH) SELECT BLTHPENCAIRAN, KDKELPENSIUN, JMLPENSIUN, RUPIAH, UPDSTAMP, INPUTER, KDJNSTRANS, SISA, REALISASI, KOMPENSASI, KURANGLEBIH FROM MIG_ACB.BELANJA_PENSIUN;
INSERT INTO TASPEN.BIAYAANGKUT_HIST(NOURUT, KDANGKUT, NOTAS, TGLKLAIM, TARIF, KETERANGAN, UPDSTAMP, INPUTER) SELECT NOURUT,1,TRIM(NOTAS), TGLKLAIM, TARIFDARAT, 'MOBIL',UPDSTAMP,INPUTER  FROM MIG_ACB.BIAYAANGKUT_HIST WHERE TARIFDARAT >0 UNION SELECT NOURUT,2,TRIM(NOTAS), TGLKLAIM, TARIFLAUT, 'KAPAL LAUT',UPDSTAMP,INPUTER  FROM MIG_ACB.BIAYAANGKUT_HIST WHERE TARIFLAUT >0 UNION SELECT NOURUT,3,TRIM(NOTAS), TGLKLAIM, TARIFUDARA, 'PESAWAT',UPDSTAMP,INPUTER  FROM MIG_ACB.BIAYAANGKUT_HIST WHERE TARIFUDARA >0;
INSERT INTO TASPEN.BUKTI_SETOR(KODE, NOSETOR, TGLSETOR, JMLSETOR, NOPGS, TGLPGS, KDKPKN, KETERANGAN, UPDSTAMP, INPUTER) SELECT 1,NOSETOR, TGLSETOR, JMLSETOR, NOPGS, TGLPGS, KDKPKN, KETERANGAN, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.BUKTI_SETOR;
INSERT INTO TASPEN.BUKTI_SETOR(KODE, NOSETOR, TGLSETOR, JMLSETOR, NOPGS, TGLPGS, KDKPKN, KETERANGAN, UPDSTAMP, INPUTER) SELECT 2,NOSETOR, TGLSETOR, JMLSETOR, NOPGS, TGLPGS, KDKPKN, KETERANGAN, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.BUKTI_SETORNONDAPEM;
INSERT INTO TASPEN.BULOG_KOMPENSASI(NOTAS, NAMA, GOL, TGL_LHR, TMT_TASPEN, KDJIWA, GAPOK, PREMI, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), NAMA, GOL, TGL_LHR, TMT_TASPEN, KDJIWA, GAPOK, PREMI,CURRENT_DATE,'MIGRASI TASPEN' FROM MIG_ACB.BULOG_KOMPENSASI;
INSERT INTO TASPEN.BUNGA_DENDA(TMT_BUNGA, PERSEN_BUNGA, UPDSTAMP, INPUTER) SELECT TMT_BUNGA, PERSEN_BUNGA,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.BUNGA_DENDA;
INSERT INTO TASPEN.BUP_SKBKN(NIP_BARU, TGL_LHR, NAMA_SK, NOMOR_USUL, TANGGAL_USUL, INSTANSI_PSK, CEPAT_KODE, PENSIUN, NOTA_PERSE, SK_NOMOR, SK_TANGGAL, TANGGAL_DI, TMT_PENS, GOLONGAN, GOL_KPP, NOMOR_KPP, TANGGAL_KP, NOTAS, FLAG) SELECT NIP_BARU, TGL_LHR, NAMA_SK, NOMOR_USUL, TANGGAL_USUL, INSTANSI_PSK, CEPAT_KODE, PENSIUN, NOTA_PERSE, SK_NOMOR, SK_TANGGAL, TANGGAL_DI, TMT_PENS, GOLONGAN, GOL_KPP, NOMOR_KPP, TANGGAL_KP, TRIM(NOTAS), FLAG FROM MIG_ACB.BUP_SKBKN;
INSERT INTO TASPEN.CACAT_HIST(NOTAS, TGLKLAIM, KDCACAT, PERSENTASE, NILAI_SANTUNAN, INPUTER, UPDSTAMP, PENGALI, JNS, FUNGSI) SELECT TRIM(NOTAS), TGLKLAIM, KDCACAT, PERSENTASE, NILAI_SANTUNAN, INPUTER, UPDSTAMP, PENGALI, JNS, FUNGSI FROM MIG_ACB.CACAT_HIST;
INSERT INTO TASPEN.CLOSE_PENS13(TGLPROSES, KDKELOMPOK, TGLCLOSING, TGLBAYAR, UPDSTAMP,INPUTER) SELECT TGLPROSES, KDKELOMPOK, TGLCLOSING, TGLBAYAR,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.CLOSING_PENS13;
INSERT INTO TASPEN.CLOSE_PST_CUTOFF(TMT_PREMI, KDCABANG, KDCLOSING, KETERANGAN, JMLDATA, JMLPROSES, TGLCLOSING, PETUGAS, UPDSTAMP, INPUTER) SELECT TMT_PREMI, KDCAB, KDCLOSING, KETERANGAN, JMLDATA, JMLPROSES, TGLCLOSING, PETUGAS,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.CLOSE_PST_CUTOFF;
INSERT INTO TASPEN.CLOSE_SANTUNAN(TGLPROSES, KDPRODUK, KDCABANG, KDJNSTRANS, KDCLOSE, KETERANGAN, UPDSTAMP, INPUTER) SELECT TGLPROSES, KDPRODUK, KDCABANG, KDJNSTRANS, KDCLOSE, KETERANGAN, UPDSTAMP, INPUTER FROM MIG_ACB.CLOSE_SANTUNAN;
INSERT INTO TASPEN.CLOSE_SPJ(TGLDAMU, KDCABANG, UPDSTAMP, INPUTER) SELECT TGLDAMU, KDCABANG, UPDSTAMP, INPUTER FROM MIG_ACB.CLOSE_SPJ;
INSERT INTO TASPEN.COMPLAIN(COMPLAINID, KDCABANG, PROBLEM, KEYWORD, TITLE, KATEGORI, STATUS, PEMOHON, PETUGAS, TGLAJUAN, TGLKERJA, TGLSELESAI, DOKUMEN, KETERANGAN, UPDSTAMP, INPUTER) SELECT COMPLAINID, KDCABANG, PROBLEM, KEYWORD, TITLE, KATEGORI, STATUS, PEMOHON, PETUGAS, TGLAJUAN, TGLKERJA, TGLSELESAI, DOKUMEN, KETERANGAN,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.COMPLAIN;
INSERT INTO TASPEN.CONTROL_POSTING(GSBER, NOMOR_VOUCH, TGLPERUBAHAN, NOTAS, NMPENERIMA, RUPIAH, TGLPOSTING_LM, TGLPOSTING_BR, NOSURAT, TGLSURAT, KETERANGAN, INPUTER, UPDSTAMP) SELECT GSBER, NOMOR_VOUCH, TGLPERUBAHAN, TRIM(NOTAS), NMPENERIMA, RUPIAH, TGLPOSTING_LM, TGLPOSTING_BR, NOSURAT, TGLSURAT, KETERANGAN, INPUTER,CURRENT_DATE FROM MIG_ACB.CONTROL_POSTING;
INSERT INTO TASPEN.DASAR_PEMBAYARAN(NOTAS, KDSURAT, KDHUBKEL, TGL_KEJADIAN, KDPRODUK, NO_SURAT, TGL_SURAT, PENERBIT_SURAT, TMT_MULAI, TMT_AKHIR, TMP_KEJADIAN, TGL_CETAKJMNAN, NO_SURATJAMINAN, INPUTER, UPDSTAMP, KDSKS, TGLWAFAT, FLAGBAYAR, KDCASE) SELECT TRIM(NOTAS), KDSURAT, KDHUBKEL, TGL_KEJADIAN, KDPRODUK, NO_SURAT, TGL_SURAT, REPLACE_REGEXPR ( '[\x80-\xFF]' IN trim(PENERBIT_SURAT) WITH '' ) PENERBIT_SURAT ,/*bintohex(REPLACE_REGEXPR ( '[\x80-\xFF]' IN trim(PENERBIT_SURAT) WITH '' ) ),*/TMT_MULAI, TMT_AKHIR, REPLACE_REGEXPR ( '[\x80-\xFF]' IN trim(TMP_KEJADIAN) WITH '' )TMP_KEJADIAN, TGL_CETAKJMNAN, NO_SURATJAMINAN, INPUTER, UPDSTAMP, KDSKS, TGLWAFAT,1,0 FROM MIG_ACB.DASAR_PEMBAYARAN;
INSERT INTO TASPEN.DEBITUR_HIST(KDKELBAYAR, NIP, NOTAS, NAMA_PESERTA, NOREK, NMKANBYR, ALAMAT, NIK_KTP, TMT_KREDIT, TAT_KREDIT, NILAI_KREDIT, CICILAN, SISA_KREDIT, TGL_TAGIH, TGL_REALISASI, STATUS_TAGIHAN, KDBLOCK, TGLUPDATE, INPUTER, NOTASMITRA, FLAG, UPDSTAMP) SELECT KDKELBAYAR, NIP, TRIM(NOTAS), NAMA_PESERTA, NOREK, NMKANBYR, ALAMAT, NIK_KTP, TMT_KREDIT, TAT_KREDIT, NILAI_KREDIT, CICILAN, SISA_KREDIT, TGL_TAGIH, TGL_REALISASI, STATUS_TAGIHAN, KDBLOCK, TGLUPDATE, trim(INPUTER), NOTASMITRA, FLAG, UPDSTAMP FROM MIG_ACB.DEBITUR_HIST;
INSERT INTO TASPEN.DEBITUR_MITRA(KDKELBAYAR, NIP, NOTAS, NAMA_PESERTA, NOREK, NMKANBYR, ALAMAT, NIK_KTP, TMT_KREDIT, TAT_KREDIT, NILAI_KREDIT, CICILAN, SISA_KREDIT, TGLKIRIM, SUMBER, UPDSTAMP, INPUTER) SELECT KDKELBAYAR, NIP, TRIM(NOTAS), NAMA_PESERTA, NOREK, NMKANBYR, ALAMAT, NIK_KTP, TMT_KREDIT, TAT_KREDIT, NILAI_KREDIT, CICILAN, SISA_KREDIT, TGLKIRIM,0,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.DEBITUR_MITRA;
INSERT INTO TASPEN.DELKELUARGA(NOTAS, NIP, NOKPE, NAMA, TGLLHR, TMTKERJA, TMTMUTASI, KETMUTASI, KDSTAPEG, ALAMAT, KETHAPUS, TGLHAPUS, INPUTER, KDCABANG) SELECT TRIM(NOTAS), NIP, NOKPE, NAMA, TGLLHR, TMTKERJA, TMTMUTASI, KETMUTASI, KDSTAPEG, ALAMAT, KETHAPUS, TGLHAPUS, INPUTER, KDCABANG FROM MIG_ACB.DELKELUARGA;
INSERT INTO TASPEN.DEVIASI_GAPOK(BLTHGAJI, KDCABANG, KELSSBP, KDSSBP, NOTAS, NIP, NAMA, TGLAHIR, GAPOK, GAPOKDO, KETERANGAN, UPDSTAMP, INPUTER, JNSGAJI) SELECT BLTHGAJI, KDCABANG, KELSSBP, KDSSBP, TRIM(NOTAS), NIP, NAMA, TGLAHIR, GAPOK, GAPOKDO, KETERANGAN,CURRENT_DATE,'MIGRASI NCB',NULL FROM MIG_ACB.DEVIASI_GAPOK;
INSERT INTO TASPEN.DOSIR_TERSEDIA(KDCABANG, NODOSIR, UPDSTAMP, INPUTER) SELECT KDCABANG, NODOSIR,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.DOSIR_TERSEDIA;
INSERT INTO TASPEN.DPCEKPOSBANK(NU, GABUNGAN, NMKANBYR, NOTAS, NMPENERIMA, NMDATI4, NMDATI3, NMDATI2, NMDATI1, ALAMAT, VOCASUR, VOCMULTI, VOCEKAG, VOCENONDAP, VOCBULOG, NOREKASUR, NOREKMULTI, NOREKEKAG, NOREKNONDAP, NOREKBULOG, RPJNSASUR, RPJNSMULTI, RPJNSEKAG, RPJNSNONDAP, RPJNSBULOG, JUMLAH, VOCPTKAI, NOREKPTKAI, RPJNSPTKAI, KDVOUCHER, KDCABANG, INPUTER, VOCJKK, VOCJKM, NOREKJKK, NOREKJKM, RPJKK, RPJKM, UPDSTAMP) SELECT NU, GABUNGAN, NMKANBYR, TRIM(NOTAS), NMPENERIMA, NMDATI4, NMDATI3, NMDATI2, NMDATI1, ALAMAT, VOCASUR, VOCMULTI, VOCEKAG, VOCENONDAP, VOCBULOG, NOREKASUR, NOREKMULTI, NOREKEKAG, NOREKNONDAP, NOREKBULOG, RPJNSASUR, RPJNSMULTI, RPJNSEKAG, RPJNSNONDAP, RPJNSBULOG, JUMLAH, VOCPTKAI, NOREKPTKAI, RPJNSPTKAI, KDVOUCHER, KDCABANG, INPUTER, VOCJKK, VOCJKM, NOREKJKK, NOREKJKM, RPJKK, RPJKM,CURRENT_DATE FROM MIG_ACB.DPCEKPOSBANK;
INSERT INTO TASPEN.DPM_PRIORITAS(TGLDAPEM, NOTAS, NAMA_PENERIMA, KDJNSPENSIUN, INPUTER, UPDSTAMP, NIKREF, NAMAREF, KETERANGAN, AKTIF) SELECT TGLDAPEM, TRIM(NOTAS), NAMA_PENERIMA,JENIS, INPUTER, UPDSTAMP, NIKREF, NAMAREF, KETERANGAN,1 FROM MIG_ACB.DPM_PRIORITAS;
INSERT INTO TASPEN.DROPPING_DANA(NOTAS, KDHUBKEL, TGLPROSES, KDJNSTRANS, TGLKLAIM, TGLDAMU, TGLWAFAT, NILAI_TAGIHAN, NILAI_REALISASI, ASAL_TAGIHAN, KDJNSTRANS1, SELISIH, TGLUPDATE, NMKEL, KDCABANG, KDBENDAHARA, KDGROUP, JNSBAYAR, KDKANBYR, NMJNSBAYAR, NOREKA, ASKES, ASSOS, POTKPKN, POTKASDA, PAJAK, SRUMAH, ALIMENTASI, JKOTOR, JPOTONGAN, INFOBANK) SELECT TRIM(NOTAS), KDHUBKEL, TGLPROSES, KDJNSTRANS, TGLKLAIM, TGLDAMU, TGLWAFAT, NILAI_TAGIHAN, NILAI_REALISASI, ASAL_TAGIHAN, KDJNSTRANS1, SELISIH, TGLUPDATE, NMKEL, KDCABANG, KDBENDAHARA, KDGROUP, JNSBAYAR, KDKANBYR, NMJNSBAYAR, NOREKA, ASKES, ASSOS, POTKPKN, POTKASDA, PAJAK, SRUMAH, ALIMENTASI, JKOTOR, JPOTONGAN, INFOBANK FROM MIG_ACB.DROPPING_DANA;
INSERT INTO TASPEN.DUKCAPIL_PENS(NORUT, NOTAS, NAMATSP, JKTSP, LHRTSP, TMPTSP, NIK, NOKK, NAMA_SIAK, JK_SIAK, KET_JKSIAK, TMPSIAK, LHRSIAK, AGAMA, KET_AGAMA, STATUS, KET_STATUS, NO_PROP, NAMA_PROP, NO_KAB, NAMA_KAB, NO_KEC, NAMA_KEC, NO_KEL, NAMA_KEL, KET_EL_SAN, KODE, UPDSTAMP, INPUTER) SELECT NORUT, TRIM(NOTAS), NAMATSP, JKTSP, LHRTSP, TMPTSP, NIK, NOKK, NAMA_SIAK, JK_SIAK, KET_JKSIAK, TMPSIAK, LHRSIAK, AGAMA, KET_AGAMA, STATUS, KET_STATUS, NO_PROP, NAMA_PROP, NO_KAB, NAMA_KAB, NO_KEC, NAMA_KEC, NO_KEL, NAMA_KEL, KET_EL_SAN, KODE,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.DUKCAPIL_PENS;
INSERT INTO TASPEN.DOSIR_HIST(KDCABANG, NODOSIR, KDHUBKEL, NOTAS, TMT_DOSIR, UPDSTAMP, INPUTER, TGLSCAN, FLAG) SELECT KDCABANG, NODOSIR, KDHUBKEL, NOTAS, TMT_DOSIR, UPDSTAMP, INPUTER, TGLSCAN, FLAG FROM (SELECT KDCABANG, NODOSIR, KDHUBKEL, TRIM(NOTAS) NOTAS, TMT_DOSIR, UPDSTAMP, INPUTER, TGL_SCAN AS TGLSCAN,1 AS FLAG ,ROW_NUMBER() OVER(PARTITION BY KDCABANG, NODOSIR, KDHUBKEL, TRIM(NOTAS) ORDER BY TGL_SCAN DESC) AS RN FROM MIG_ACB.DOSIR_HIST)WHERE RN =1;
INSERT INTO TASPEN.PENERIMA_SK(KDHUBKEL, NOTAS, TMT_PENSIUN, ISLOCK, KDSIFATPOK, KDJNSPENSIUN, KDJIWA, TMT_STOP, KDSTOP, NIPPA, KDPANGKAT, KDKELOMPOK, KDPRODUK, NMKEL, TGLLHR, TGLSKEP, NOSKEP, KDPENSKEP, TMTSKEP, KDTP, UPDSTAMP, INPUTER, KDHUBKELWALI, NMKELWALI, TGLLHRWALI, KDSTSWALI, NOMOR_PIAGAM, TANGGAL_PIAGAM, PENERBIT_PIAGAM) SELECT A.KDHUBKEL, TRIM(A.NOTAS), TMT_PENSIUN, ISLOCK, KDSIFATPOK, KDJNSPENSIUN, KDJIWA, TMT_STOP, KDSTOP, NIPPA, TRIM(KDPANG), KDKELOM, KDPRODU, NMKELA, TGLLHRA, TGLSKEPA, NOSKEPA, KDPENSKEPA, TMTSKEPA, KDTP, A.UPDSTAMP, A.INPUTER, KDHUBKELWALI, NMKELWALI, TGLLHRWALI, KDSTSWALI, NULL,NULL,NULL FROM MIG_ACB.PENERIMA_SK A INNER JOIN TASPEN.KELUARGA B ON TRIM(A.NOTAS) = B.NOTAS AND A.KDHUBKEL = B.KDHUBKEL;

INSERT INTO TASPEN.F_RAPEL(KODECABANG, NOTAS, KDHUBKEL, JENIS, TMTPENSIUN, TGLDAPEM, KDJNSTRANS, KDJIWA, KDHIT, HAKBAGI, PENPOKB, TISTRIB, TANAKB, TPB, TKDB, TPPB, TPAJAKB, TBERASB, TCACATB, TTEWASB, TDAHORB, TBULATB, KOTORB, PPAJAKB, PASKESB, PKPKNB, PKASDAB, PTASPENB, PSEWAB, PASSOSB, PALIMENTASIB, POTONGANB, BERSIHB, PENPOKL, TISTRIL, TANAKL, TPL, TKDL, TPPL, TPAJAKL, TBERASL, TCACATL, TTEWASL, TDAHORL, TBULATL, KOTORL, PPAJAKL, PASKESL, PKPKNL, PKASDAL, PTASPENL, PSEWAL, PASSOSL, PALIMENTASIL, POTONGANL, BERSIHL, PENPOK, TISTRI, TANAK, TP, TKD, TPP, TPAJAK, TBERAS, TCACAT, TTEWAS, TDAHOR, TBULAT, KOTOR, PPAJAK, PASKES, PKPKN, PKASDA, PTASPEN, PSEWA, PASSOS, PALIMENTASI, POTONGAN, BERSIH, TGRB, TGRL, TGR, UPDSTAMP, INPUTER) SELECT KODECABANG, TRIM(NOTAS), KDHUBKEL, JENIS, TMTPENSIUN, TGLDAPEM, KDJNSTRANS, KDJIWA, KDHIT, HAKBAGI, PENPOKB, TISTRIB, TANAKB, TPB, TKDB, TPPB, TPAJAKB, TBERASB, TCACATB, TTEWASB, TDAHORB, TBULATB, KOTORB, PPAJAKB, PASKESB, PKPKNB, PKASDAB, PTASPENB, PSEWAB, PASSOSB, PALIMENTASIB, POTONGANB, BERSIHB, PENPOKL, TISTRIL, TANAKL, TPL, TKDL, TPPL, TPAJAKL, TBERASL, TCACATL, TTEWASL, TDAHORL, TBULATL, KOTORL, PPAJAKL, PASKESL, PKPKNL, PKASDAL, PTASPENL, PSEWAL, PASSOSL, PALIMENTASIL, POTONGANL, BERSIHL, PENPOK, TISTRI, TANAK, TP, TKD, TPP, TPAJAK, TBERAS, TCACAT, TTEWAS, TDAHOR, TBULAT, KOTOR, PPAJAK, PASKES, PKPKN, PKASDA, PTASPEN, PSEWA, PASSOS, PALIMENTASI, POTONGAN, BERSIH, TGRB, TGRL, TGR,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.F_RAPEL;
INSERT INTO TASPEN.FMUTASI(NOTAS, KDHUBKEL, TGLMUTASI, JNSMUTASI, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, TGLMUTASI, JNSMUTASI, UPDSTAMP, INPUTER FROM MIG_ACB.FMUTASI;
INSERT INTO TASPEN.FORMULIR_AJUAN(NOTAS, KDKLAIM_ASUR, KDKLAIM_PENS, KDKLAIM_MGS, NAMAPESERTA, TGLLHRPST, ALM_PESERTA, KDDATI4, KDDATI3, KDDATI2, KDDATI1, NOTELP, KDHUBKELYMK, NAMAYMK, TGLLHRYMK, TGLKEJADIAN, JENISBAYAR, TGLAJUAN, NOREK, KDCABANGSPP, KDBENDAHARASPP, KDGORUPSPP, JNSBAYARSPP, KDKANBYRSPP, KDCABANGDPM, KDBENDAHARADPM, KDGROUPDPM, JNSBAYARDPM, KDKANBYRDPM, UPDSTAMP, NIP_SILANG, NOTAS_SILANG, NPWP, SUMBER_SPP, INPUTER, NOKTP) SELECT TRIM(NOTAS), KDKLAIM_ASUR, KDKLAIM_PENS, KDKLAIM_MGS, NAMAPESERTA, TGLLHRPST, ALM_PESERTA, KDDATI4, KDDATI3, KDDATI2, KDDATI1, NOTELP, KDHUBKELYMK, NAMAYMK, TGLLHRYMK, TGLKEJADIAN, JENISBAYAR, TGLAJUAN, NOREK, KDCABANGSPP, KDBENDAHARASPP, KDGORUPSPP, JNSBAYARSPP, KDKANBYRSPP, KDCABANGDPM, KDBENDAHARADPM, KDGROUPDPM, JNSBAYARDPM, KDKANBYRDPM, UPDSTAMP, NIP_SILANG, TRIM(NOTAS_SILANG), NPWP, SUMBER_SPP, INPUTER, NOKTP FROM MIG_ACB.FORMULIR_AJUAN;
INSERT INTO TASPEN.FORMULIR_BATCH(NOTAS, KDKLAIM_ASUR, KDKLAIM_PENS, KDKLAIM_MGS, NAMAPESERTA, TGLLHRPST, ALM_PESERTA, KDDATI4, KDDATI3, KDDATI2, KDDATI1, NOTELP, KDHUBKELYMK, NAMAYMK, TGLLHRYMK, TGLKEJADIAN, JENISBAYAR, TGLAJUAN, NOREK, KDCABANGSPP, KDBENDAHARASPP, KDGORUPSPP, JNSBAYARSPP, KDKANBYRSPP, KDCABANGDPM, KDBENDAHARADPM, KDGROUPDPM, JNSBAYARDPM, KDKANBYRDPM, UPDSTAMP, NIP_SILANG, NOTAS_SILANG, NPWP, KDCETAK, INPUTER) SELECT TRIM(NOTAS), KDKLAIM_ASUR, KDKLAIM_PENS, KDKLAIM_MGS, NAMAPESERTA, TGLLHRPST, ALM_PESERTA, KDDATI4, KDDATI3, KDDATI2, KDDATI1, NOTELP, KDHUBKELYMK, NAMAYMK, TGLLHRYMK, TGLKEJADIAN, JENISBAYAR, TGLAJUAN, NOREK, KDCABANGSPP, KDBENDAHARASPP, KDGORUPSPP, JNSBAYARSPP, KDKANBYRSPP, KDCABANGDPM, KDBENDAHARADPM, KDGROUPDPM, JNSBAYARDPM, KDKANBYRDPM, UPDSTAMP, NIP_SILANG, TRIM(NOTAS_SILANG), NPWP, KDCETAK,'MIGRASI NCB' FROM MIG_ACB.FORMULIR_BATCH;
INSERT INTO TASPEN.FORMULIR_HIST(NMLAMPIRAN, KDJNSTRANS, KDPRODUK, KDKELOMPOK, TGLKLAIM, NOTAS, KDHUBKEL, KDFLOW, PASSNOT, KETERANGAN, UPDSTAMP, INPUTER) SELECT NMLAMPIRAN, KDJNSTRANS, KDPRODUK, KDKELOMPOK, TGLKLAIM, TRIM(NOTAS), KDHUBKEL, KDFLOW, PASSNOT, KETERANGAN,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.FORMULIR_HIST;
INSERT INTO TASPEN.GDOTARTASPEN(KDCABANG, KDSSBP, KELSSBP, KODESATKER, KDDATI1, KDDATI2, NIP, NAMA, TGLAHIR, KDSEX, ISTRI, ANAK, GAPOK, KDGOL, KDKELOMPOK, KDSTAPEG, KDDUDUKAN, KDJNSTRANS, BLTHGAJI, UPDSTAMP, INPUTER) SELECT KDCABANG, KDSSBP, KELSSBP, KODESATKER, KDDATI1, KDDATI2, NIP, NAMA, TGLAHIR, KDSEX, ISTRI, ANAK, GAPOK, KDGOL, KDKELOMPOK, KDSTAPEG, KDDUDUKAN, KDJNSTRANS, BLTHGAJI, UPDSTAMP, INPUTER FROM MIG_ACB.GDOTARTASPEN;
INSERT INTO TASPEN.HIST_DATAPENPOK(NOTAS, KDHUBKEL, TGLDAPEM, KDJNSTRANS, KDKELOMPOK, TMT_PENSIUN, KDJIWA, KDPANGKAT, TMT_PENPOKL, JMLANAK, KDSIFATPOK, MASKER, PENPOK100_L, PEMBAGI, PENPOK, TMT_PENPOKB, PENPOK100_B, PENPOK_B, KDCABANG, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, TGLDAPEM, KDJNSTRANS, KDKELOMPOK, TMT_PENSIUN, KDJIWA, TRIM(KDPANGKAT), TMT_PENPOKL, JMLANAK, KDSIFATPOK, MASKER, PENPOK100_L, PEMBAGI, PENPOK, TMT_PENPOKB, PENPOK100_B, PENPOK_B, KDCABANG, UPDSTAMP, INPUTER FROM MIG_ACB.HIST_DATAPENPOK;
INSERT INTO TASPEN.HIST_JABAT(NOTAS, TGLLAHIR, TGLTASPEN, KDKELOMPOK, KEJADIAN, KDJABATAN, TMT_JABAT, TAT_JABAT, GAPOK, TAHUN_UM, BULAN_UM, UM, TAHUN_UB, BULAN_UB, UB, TAHUN_MI, BULAN_MI, MI, FAKTORMI1, FAKTORMI2, FAKTOR, THP, KDJIWA, MANFAAT, ASKEM, NOURUT, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), TGLLAHIR, TGLTASPEN, KDKELOMPOK, KEJADIAN, KDJABATAN, TMT_JABAT, TAT_JABAT, GAPOK, TAHUN_UM, BULAN_UM, UM, TAHUN_UB, BULAN_UB, UB, TAHUN_MI, BULAN_MI, MI, FAKTORMI1, FAKTORMI2, FAKTOR, THP, KDJIWA, MANFAAT, ASKEM, NOURUT,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.HIST_JABAT;
INSERT INTO TASPEN.INDIVIDU_DUKCAPIL(NOTAS, NIK, NAMA_LGKP, TGL_LHR, TMPT_LHR, AGAMA, ALAMAT, GOL_DARAH, JENIS_KLMIN, KAB_NAME, KEC_NAME, KEL_NAME, NO_KAB, NO_KEC, NO_KEL, NO_KK, NO_PROP, NO_RT, NO_RW, PROP_NAME, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), NIK, NAMA_LGKP, TGL_LHR, TMPT_LHR, AGAMA, ALAMAT, GOL_DARAH, JENIS_KLMIN, KAB_NAME, KEC_NAME, KEL_NAME, NO_KAB, NO_KEC, NO_KEL, NO_KK, NO_PROP, NO_RT, NO_RW, PROP_NAME,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.INDIVIDU_DUKCAPIL;
INSERT INTO TASPEN.INDIVIDU_LKO(TMT_AWAL, KDCABANG, NOTAS, TGLKLAIM, TGLRENBAYAR, KDPRODUK, KDKLAIM, UPDSTAMP, INPUTER) SELECT TMT_AWAL, KDCABANG, TRIM(NOTAS), TGLKLAIM, TGLRENBAYAR,0,0, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.INDIVIDU_LKO;
INSERT INTO TASPEN.INDIVIDU_PSUP(KDCABANG, NOTAS, TGLPROSES, TGLDAMU, TGLCAIR, KDSTSDAMU, JENIS, KOTOR, POTONGAN, BERSIH, KODEBYR, NMKANBYR, KDKELBAYAR, UMURPIUTANG, TGLDAPEM, PILKAI, UPDSTAMP, INPUTER) SELECT KDCABANG, TRIM(NOTAS), TGLPROSES, TGLDAMU, TGLCAIR, KDSTSDAMU, JENIS, KOTOR, POTONGAN, BERSIH, KODEBYR, NMKANBYR, KDKELBAYAR, UMURPIUTANG, TGLDAPEM, PILKAI,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.INDIVIDU_PSUP;
INSERT INTO TASPEN.INDIVIDURAMPUNG(NO, NOTAS, KDHUBKEL, KDCABANG, TAHUN, KODE, KODEBYR, UPDSTAMP, INPUTER) SELECT NO, TRIM(NOTAS), KDHUBKEL, KDCABANG, TAHUN, KODE, KODEBYR,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.INDIVIDURAMPUNG;
INSERT INTO TASPEN.INVALID_PESERTA_CUTOFF(TMT_PREMI, NOTAS, NIPPA, NAMA, SEX, TGLLHR, TMT_TASPEN, TMT_KERJA, KDCABANG, KDSTAPEG, KDDUDUKAN, KDJNSPEG, KDKELOMPOK, KDPANGKAT, KDSATKER, GAPOK, USIA_PEGAWAI, USIA_MASUK, BUP_MAX, TMT_MUTASI, TMT_GAPOK, TGLUPDATE, INVALID1, INVALID2, INVALID3, INVALID4, INVALID5, INVALID6, INVALID7, INVALID8, INVALID9, INVALID10, INVALID11, INVALID12, INVALID13, INVALID14, INVALID15, UPDSTAMP, INPUTER) SELECT TMT_PREMI, TRIM(NOTAS), NIPPA, REPLACE_REGEXPR ( '[\x80-\xFF]' IN trim(NAMA) WITH '' ) NAMA, SEX, TGLLHR, TMT_TASPEN, TMT_KERJA, KDCAB, KDSTAPEG, KDDUDUKAN, KDJENPEG, KDKELOMPOK, TRIM(KDPANGKAT), KDSATKER, GAPOK, USIA_PEGAWAI, USIA_MASUK, BUP_MAX, TMT_MUTASI, TMT_GAPOK, TGLUPDATE, INVALID1, INVALID2, INVALID3, INVALID4, INVALID5, INVALID6, INVALID7, INVALID8, INVALID9, INVALID10, INVALID11, INVALID12, INVALID13, INVALID14, INVALID15,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.INVALID_PST_CUTOFF WHERE TRIM(KDPANGKAT) IS NOT NULL AND NAMA IS NOT NULL;
INSERT INTO TASPEN.JOBREPORT(JOBID, NO_SRT_NDS, TITLE, DESKRIPSI, TMTJOB, TATJOB, TGL_TARGET, STATUS, KATEGORI, PROGRAMER, SUMBER, CATATAN, DOKUMEN, UPDSTAMP, INPUTER) SELECT JOBID, NO_SRT_NDS, TITLE, DESKRIPSI, TMTJOB, TATJOB, TGL_TARGET, STATUS, KATEGORI, PROGRAMER, SUMBER, CATATAN, DOKUMEN,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.JOBREPORT WHERE CATATAN IS NOT NULL;
INSERT INTO TASPEN.INDIVIDU_RAMPUNG(NO, NOTAS, KDHUBKEL, KDCABANG, TAHUN, KODE, KODEBYR, NPWP, NMKEL, NIP, ALM, GOL, JNSKEL, STATUS, TANGGUNG, MP1, MP2, FLAG, A1, A2, A3, A4, A5, A7, A9, A10, A11, A14, A16, A17, A18, JENIS, NORUTDAPEM, ALM_PST, A15, NOTAS_CD, FLAG_UPLOAD, NOTAS_DAPEM, UPDSTAMP, INPUTER) SELECT NO, TRIM(NOTAS), KDHUBKEL, KDCABANG, TAHUN, KODE, KODEBYR, NPWP, NMKEL, NIP, ALM, GOL, JENKEL, STATUS, TANGGUNG, MP1, MP2, FLAG, A1, A2, A3, A4, A5, A7, A9, A10, A11, A14, A16, A17, A18, JENIS, NORUTDAPEM, ALM_PST, A15,NULL,0,NULL,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.INDIVIDU_RAMPUNG WHERE JENKEL IN(1,2) ;
INSERT INTO TASPEN.KLAIM_ASS(NIPPA, KEJADIAN, TGLKEJ, TYPEVOC, NOVOUCER_ASS, TGLKLAIM, TGLTRANS, GAPOK, THP1, THP2, NAMA_YMK, TGLLHR_YMK, NMPENERIMA, CASH_VAL, RP_ASUNIL, RP_ASKEM, RP_KEKIU, RP_TABRMH, RP_SISASUR, RP_CEKPOS, RP_BULAT, DK_BULAT, RP_TEDIB, RP_HAK, NO_CEKPOS, TGLCEKPOS, KDCABANG, KDHUBKEL, NOTAS, KDKELOMPOK, GAPOK97, TEDIB_ASKEM, UPDSTAMP, INPUTER) SELECT NIPPA, KEJADIAN, TGLKEJ, TYPEVOC, NOVOUCER_ASS, TGLKLAIM, TGLTRANS, GAPOK, THP1, THP2, NAMA_YMK, TGLLHR_YMK, NMPENERIMA, CASH_VAL, RP_ASUNIL, RP_ASKEM, RP_KEKIU, RP_TABRMH, RP_SISASUR, RP_CEKPOS, RP_BULAT, DK_BULAT, RP_TEDIB, RP_HAK, NO_CEKPOS, TGLCEKPOS, KDCAB, KDHUBKEL, TRIM(NOTAS), KDKELOMPOK, GAPOK97, TEDIB_ASKEM,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KLAIM_ASS;
INSERT INTO TASPEN.KLAIM_PENS(NOTAS, KDHUBKEL, KDKLAIM, TGLKLAIM, TGLRENBAYAR, TGLTRANS, NOVOUCHER_PENS, NMPENERIMA, KDVOUCHER, KDDANA, JENIS, KDSIFAT, KDHIT, KDCABANG, TMT_RAPEL, TAT_RAPEL, KDKELOMPOK, KDPANGKAT, JMLISTRI, PENPOK, TISTRI, TANAK, TPM, TKD, TPP, TP, TTEWAS, TBERAS, TCACAT, TKHUSUS, TBULAT, JML_KOTOR, PPAJAK, PASKES, PKPKN, PKASDA, PASSOS, PSEWA, PALIMENTASI, PTASPEN, JML_POTONG, JML_BERSIH, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, KDKLAIM, TGLKLAIM, TGLRENBAYAR, TGLTRANS, NOVOUCHER_PENS, NMPENERIMA, KDVOUCHER, KDDANA, JENIS, KDSIFAT, KDHIT, KDCAB, TMT_RAPEL, TAT_RAPEL, KDKELOMPOK, TRIM(KDPANGKAT), JMLISTRI, PENPOK, TISTRI, TANAK, TPM, TKD, TPP, TP, TTEWAS, TBERAS, TCACAT, TKHUSUS, TBULAT, JML_KOTOR, PPAJAK, PASKES, PKPKN, PKASDA, PASSOS, PSEWA, PALIMENTASI, PTASPEN, JML_POTONG, JML_BERSIH,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KLAIM_PENS;
INSERT INTO TASPEN.KLAIM_UKPPENPOK(TGLKLAIM, KDHUBKEL_YMK, NOTAS, KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, FLOW_STS, BMS, NOANTRI, KDCABANG, LANGSUNG, NOVOUCHER_PENS, TGLTERIMA_PENS, TGLRENBAYAR, BANKGRP, BANKNAMA, BANKACCT, NMPENERIMA, ALM_KLIMPENS, KDDATI1, KDDATI2, KDDATI3, KDDATI4, KODEPOS, TELEPON, NOKTP, NOREK, MASKER, JMLANAK, TMT_PENPOK, KDJNSPENERIMA, KDPANGKAT, KDSIFATPOK, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KEBERAPA, KDJNSPENSIUN, KDVOUCHER, KDDANA, TMT_RAPEL, TAT_RAPEL, TGLLHR_PENERIMA, JENKEL_PENERIMA, JMLISTRI, KDHIT, PENPOK, TISTRI, TANAK, TBERAS, TP, TKD, TPP, TCACAT, TPAJAK, TDAHOR, TTEWAS, TBULAT, KOTOR, PPAJAK, PALIMENTASI, PASKES, PASSOS, PKASDA, PKPKN, PSEWA, POTONGAN, BERSIH, NEWTGLKLAIM, STATUS, NEWTGLPOSTING, NOCEKPOS, KDCEKPOS, UPDSTAMP, INPUTER) SELECT TGLKLAIM, KDHUBKEL, TRIM(NOTAS), KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, FLOW_STS, BMS, NOANTRI, KDCABANG, LANGSUNG, NOVOUCHER_PENS, TGLTERIMA_PENS, TGLRENBAYAR, BANKGRP, BANKNAMA, BANKACCT, NMPENERIMA, ALM_KLIMPENS, KDDATI1, KDDATI2, KDDATI3, KDDATI4, KODEPOS, TELEPON, NOKTP, NOREK, MASKER, JMLANAK, TMT_PENPOK, KDJNSPENERIMA, TRIM(KDPANGKAT), KDSIFATPOK, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KEBERAPA, KDJNSPENSIUN, KDVOUCHER, KDDANA, TMT_RAPEL, TAT_RAPEL, TGLLHR_PENERIMA, JENKEL_PENERIMA, JMLISTRI, KDHIT, PENPOK, TISTRI, TANAK, TBERAS, TP, TKD, TPP, TCACAT, TPAJAK, TDAHOR, TTEWAS, TBULAT, KOTOR, PPAJAK, PALIMENTASI, PASKES, PASSOS, PKASDA, PKPKN, PSEWA, POTONGAN, BERSIH, NEWTGLKLAIM, STATUS, NEWTGLPOSTING, NOCEKPOS, KDCEKPOS, UPDSTAMP, INPUTER FROM MIG_ACB.KLAIM_UKPPENPOK;
INSERT INTO TASPEN.KOLEKTIBILITAS_IURAN(TMTKOLEKTIBILITAS, NUM, KDCABANG, NMCABANG, JMLPEMDA, SETOR1, SETOR2, SETOR3, JMLSETOR, TGLSETOR1, TGLSETOR2, TGLSETOR3, JMLTGLSETOR, NILAI, UPDSTAMP, INPUTER, PROPORSIONAL) SELECT TMTKOLEKTIBILITAS, NUM, KDCABANG, NMCABANG, JMLPEMDA, SETOR1, SETOR2, SETOR3, JMLSETOR, TGLSETOR1, TGLSETOR2, TGLSETOR3, JMLTGLSETOR, NILAI, UPDSTAMP, INPUTER,NULL FROM MIG_ACB.KOLEKTIBILITAS_IURAN;
INSERT INTO TASPEN.KOMPENSASI_PAJAK(TGLDAPEM, KDJNSTRANS, JENIS, NOTAS, KDJIWA, PENPOK, TISTRI, TANAK, TP, TKD, TPP, TPAJAK, TBERAS, TCACAT, TTEWAS, TBULAT, RAPEL, TDAHOR, KOTOR, PPAJAK, BERSIH, KODECABANG, KDHITUNG, NPWP, NAMA_PENERIMA, JENKEL_PENERIMA, KDJIWA_PTKP, NEWKDJIWA_PTKP, MTPAJAK, MPPAJAK, UPDSTAMP, INPUTER) SELECT TGLDAPEM, KDJNSTRANS, JENIS, TRIM(NOTAS), KDJIWA, PENPOK, TISTRI, TANAK, TP, TKD, TPP, TPAJAK, TBERAS, TCACAT, TTEWAS, TBULAT, RAPEL, TDAHOR, KOTOR, PPAJAK, BERSIH, KODECABANG, KDHITUNG, NPWP, NAMA_PENERIMA, JENKEL_PENERIMA, KDJIWA_PTKP, NEWKDJIWA_PTKP, MTPAJAK, MPPAJAK, UPDSTAMP, INPUTER FROM MIG_ACB.KOMPENSASI_PAJAK;
INSERT INTO TASPEN.KONFIRMASI(KDCABANG, KDCABANG_TUJUAN, KDCABANG_ASAL, STATUS, NOTAS, NMKEL, ID_PEMINTA, NAMAPEMINTA, TGLMINTA, ID_PENGIRIM, NAMAPENGIRIM, TGLKIRIM, URAIAN, JENIS) SELECT KDCABANG, KDCABANGT, KDCABANGA, STATUS, TRIM(NOTAS), NMKEL, ID_PEMINTA, NAMAPEMINTA, TGLMINTA, ID_PENGIRIM, NAMAPENGIRIM, TGLKIRIM, URAIAN, JENIS FROM MIG_ACB.KONFIRMASI;
INSERT INTO TASPEN.KPI(TGL_KPI, NOTAS, KDHUBKEL, NO_KPI, KDPENSKEP, NOREGISTER, TGLTERIMA, TGLREKAM, UPDSTAMP, INPUTER) SELECT TGL_KPI, TRIM(NOTAS), KDHUBKEL, NO_KPI, KDPENSKEP, NOREGISTER, TGLTERIMA, TGLREKAM,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.KPI;
INSERT INTO TASPEN.LSUP(KDCABANG, BLTH, KELPENS, SALDOAWAL, INDSSL, RAPEL, PENS13, DAMUINDSSL, DAMURAPEL, DAMUP13, NONDAPEM, KOMINDSSL, KOMRAPEL, KOMP13, KOMDAMUINDSSL, KOMDAMURAPEL, KOMDAMUP13, KOMNONDAPEM, SALDOAKHIR, INPUTER, UPDSTAMP, THR, DAMUTHR, KOMTHR, KOMDAMUTHR) SELECT KDCABANG, BLTH, KELPENS, SALDOAWAL, INDSSL, RAPEL, PENS13, DAMUINDSSL, DAMURAPEL, DAMUP13, NONDAPEM, KOMINDSSL, KOMRAPEL, KOMP13, KOMDAMUINDSSL, KOMDAMURAPEL, KOMDAMUP13, KOMNONDAPEM, SALDOAKHIR, INPUTER, UPDSTAMP, THR, DAMUTHR, KOMTHR, KOMDAMUTHR FROM MIG_ACB.LSUP;
INSERT INTO TASPEN.MONITORING_ALAMAT(TGL_REKAM, KDCABANG, SSBP, JUMLAH, REKAM, SISA) SELECT TGL_REKAM, KDCAB, SSBP, JUM, REKAM, SISA FROM MIG_ACB.MON_ALAMAT;
INSERT INTO TASPEN.MONITORING_KELUARGA(TGL_REKAM, KDCABANG, SSBP, JUM, REKAM, SISA) SELECT TGL_REKAM, KDCAB, SSBP, JUM, REKAM, SISA FROM MIG_ACB.MON_KELUARGA;
INSERT INTO TASPEN.MONITORING_STAPEG20(NOTAS, TMTMAX, STAPEGMAX, TMTAWAL, STAPEGAWAL, INPUTER, UPDSTAMP) SELECT TRIM(NOTAS), TMTMAX, STAPEGMAX, TMTAWAL, STAPEGAWAL, INPUTER, UPDSTAMP FROM MIG_ACB.MONSTAPEG20;
INSERT INTO TASPEN.MSTPUPNS(NIPPA, PAC010, PAC020, PAC030, PAC040, PAC050, PAC055, PAC060, PAC070, PAC080, PAC120, PAC130, PAC140, PAC160, PAC170, PAC180, PAC190, NIP_BARU, KDPUPNS, NOTAS, INPUTER, GELAR_DEPAN, GELAR_BELAKANG, UPDSTAMP) SELECT NIPPA, PAC010, PAC020, PAC030, PAC040, PAC050, PAC055, PAC060, PAC070, PAC080, PAC120, PAC130, PAC140, PAC160, PAC170, PAC180, PAC190, NIP_BARU, KDPUPNS, TRIM(NOTAS), INPUTER, GELAR_DEPAN, GELAR_BELAKANG,CURRENT_DATE FROM MIG_ACB.MSTPUPNS;
INSERT INTO TASPEN.MUTASI_CABANG(TMT_MUTASI_CABANG, KDCABANG, KDHUBKEL, NOTAS, KASIPA, TGLKIRIM, TGLCETAK, KDDOKUMEN, KDKPKN, NOSKPP, KETERANGAN, UPDSTAMP) SELECT TMT_MUTCAB, KDCABANG, KDHUBKEL, TRIM(NOTAS), KASIPA, TGLKIRIM, TGLCETAK, KDDOKUMEN, KDKPKN, NOSKPP, KETERANGAN, UPDSTAMP FROM MIG_ACB.MUTASI_CABANG;
INSERT INTO TASPEN.NONDAPEM(NOTAS, KDHUBKEL, NMPENERIMA, KDKLAIM, NMSHORT, KDJNSTRANS, NOMOR, TGLKLAIM, TGLPOSTING, KDJNSPENSIUN, MAK, KDKEL, KDKELOMPOK, KDCABANG, KDJIWA, KDKELPENSIUN, TMT_RAPEL, TAT_RAPEL, POKOK, TISTRI, TANAK, TPM, TKD, TPP, TP, THUSUS, TCACAT, TBERAS, TTEWAS, BULAT, KOTOR, PAJAK, ASKES, POTKPKN, POTKASDA, ASSOS, SRUMAH, ALIMENTASI, POTASPEN, JMLPOTONGAN, BERSIH, TDAHOR, TGR, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, NMPENERIMA, KDKLAIM, NMSHORT, KDJNSTRANS, NOMOR, TGLKLAIM, TGLPOSTING, KDJNSPENSIUN, MAK, KDKEL, KDKELOMPOK, KDCABANG, KDJIWA, KDKELPENSIUN, TMT_RAPEL, TAT_RAPEL, POKOK, TISTRI, TANAK, TPM, TKD, TPP, TP, THUSUS, TCACAT, TBERAS, TTEWAS, BULAT, KOTOR, PAJAK, ASKES, POTKPKN, POTKASDA, ASSOS, SRUMAH, ALIMENTASI, POTASPEN, JMLPOTONGAN, BERSIH, TDAHOR, TGR,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.NONDAPEM;
INSERT INTO TASPEN.ONTHESPOT(TGLREKAM, NOTAS, KDHUBKEL, JENIS, NAMAPENSIUNAN, TGL_LAHIR_PENSIUNAN, NAMA_PENERIMA, TGL_LAHIR_PENERIMA, KODECABANG, KODEBYR, NOREK, TMTPENSIUN, KDPANGKAT, TGLONTHESPOT, KETERANGAN, PETUGAS, TGLDAPEM, UPDSTAMP, INPUTER) SELECT TGLREKAM, TRIM(NOTAS), KDHUBKEL, JENIS, NAMAPENSIUNAN, TGL_LAHIR_PENSIUNAN, NAMA_PENERIMA, TGL_LAHIR_PENERIMA, KODECABANG, KODEBYR, NOREK, TMTPENSIUN, TRIM(KDPANGKAT), TGLONTHESPOT, KETERANGAN, PETUGAS, TGLDAPEM, UPDSTAMP, INPUTER FROM MIG_ACB.ONTHESPOT;
INSERT INTO TASPEN.PANGGIL_KASIR(TGLKLAIM, KDHUBKEL, NOTAS, KDFLOW, TGLWORK, USERINP, KETERANGAN, STATUS, STATUS_AKTIF_SOV, UPDSTAMP, INPUTER) SELECT TGLKLAIM, KDHUBKEL, TRIM(NOTAS), KDFLOW, TGLWORK, USERINP, KETERANGAN,1,0, UPDSTAMP, INPUTER FROM MIG_ACB.WKT_PANGGIL_KSR;
INSERT INTO TASPEN.PENGAJUAN_SK(TGL_AJUAN, NOTAS, KDHUBKEL, NO_AJUAN, NOSKDIHASILKAN, TGL_REVIEW, AJUAN_KE, KDJNSPENERIMA, NOSURANTAR, JNS_SURAT, UPDSTAMP, KETERANGAN, TGLREF, NOREF, KDPENSK, KDKPKN, INPUTER, NAMA, TGL_LAHIR) SELECT TGL_AJUAN, TRIM(NOTAS), KDHUBKEL, NO_AJUAN, NOSKDIHASILKAN, TGL_REVIEW, AJUAN_KE, KDJNSPENERIMA, NOSURANTAR, JNS_SURAT, UPDSTAMP, KETERANGAN, TGLREF, NOREF, KDPENSK, KDKPKN,'MIGRASI NCB',null,null FROM MIG_ACB.PENGAJUAN_SK;
INSERT INTO TASPEN.PENGHASILAN_RPL(NOTAS, BLNTHGAJI, KDJIWA, GAPOK, TUNJ_ISTRI, TUNJ_ANAK, TPP, TUNJ_ESELON, TUNJ_FUNGSIONAL, TUNJ_GURU, TUNJ_LANGKA, TKD, TUNJ_TERPENCIL, TUNJ_KHUSUS, TUNJ_PAJAK, TUNJ_ASKES, TUNJ_BERAS, TUNJ_UMUM, PEMBULATAN, PENGHASILAN_KOTOR, JMLBERSIH, POT_IWP, PERSENGAPOK, IURAN_JKK, IURAN_JKM, KD_ESELON, KD_FUNGSIONAL, KDGURU, TMT_GAPOK, KDJNSTRANS, KDKELOMPOK, KDJNSPEG, MASKER, KDPANGKAT, TMTRAPEL, TATRAPEL, NILAI_RAPEL, KELSSBP, KDSSBP, KDCABANG, SATKERPEMDA, NIP, NAMA, TGLAHIR, KDSEX, ISTRI, ANAK, IURAN_RAPEL, KDDUDUKAN, NIK, NPWP, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), BLNTHGAJI, KDJIWA, GAPOK, TUNJ_ISTRI, TUNJ_ANAK, TPP, TUNJ_ESELON, TUNJ_FUNGSIONAL, TUNJ_GURU, TUNJ_LANGKA, TKD, TUNJ_TERPENCIL, TUNJ_KHUSUS, TUNJ_PAJAK, TUNJ_ASKES, TUNJ_BERAS, TUNJ_UMUM, PEMBULATAN, PENGHASILAN_KOTOR, JMLBERSIH, POT_IWP, PERSENGAPOK, IURAN_JKK, IURAN_JKM, KD_ESELON, KD_FUNGSIONAL, KDGURU, TMT_GAPOK, KDJNSTRANS, KDKELOMPOK, KDJENPEG, MASKER, KDPANGKAT, TMTRAPEL, TATRAPEL, NILAI_RAPEL, KELSSBP, KDSSBP, KDCABANG, SATKERPEMDA, NIP, NAMA, TGLAHIR, KDSEX, ISTRI, ANAK, IURAN_RAPEL, KDDUDUKAN, NIK, NPWP,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.PENGHASILAN_RPL;
INSERT INTO TASPEN.PENPOK_PEJABAT(TMT_PENPOK, KDHUBKEL, NOTAS, KDJNSPENERIMA, KDKELOMPOK, KDPANGKAT, NORUT, PCTGAPOK, GAPOK, UPDSTAMP, INPUTER) SELECT TMT_PENPOK, KDHUBKEL, TRIM(NOTAS), KDJNSPENERIMA, KDKELOMPOK, KDPANGKAT, NORUT, PCTGAPOK, GAPOK,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.PENPOK_PEJABAT;
INSERT INTO TASPEN.PENSIUN_PUNAH(NOPEN, KODEPROG, JENIS, DAPEM, NIPPA, SIFAT, NAMA_PESERTA, SEX, TGL_LAHIR, PANGKAT, KP050, KP060, KP070, KP080, KP090, KP100, KP110, KP120, KP130, KP140, KP150, KP160, KP170, KP175, TMT_PENSIUN, KP185, KP190, KP200, KP210, KP220, KP230, KP240, KP250, KP270, KP280, KP290, KP300, KP310, KP315, KP320, KP330, KP335, KP340, KP350, KP360, KP370, KP380, KP390, KP400, KP410, KP420, KP430, KP440, KP450, KP460, KP470, DK_KP470, KP480, KP485, DK_KP485, KP490, KP500, KP510, KP515, KP520, KP530, KP540, KP550, KP560, KP570, KP580, KP590, KP600, NAMA_PENERIMA, SEX_PNRM, TGL_LAHIR_PEN, ALAMAT, KP650, KANTOR_BAYAR, KP670, STOP_PERMANEN, BLTH_STOP_PERM, KP700, KP710, KP720, KP730, KP740, NOMOR_DOSIR, KP760, STOP_SEMENTARA, BLTH_STOP_SEMEN, KP800, KP810, KP820, KP830, KP840, KP550R, KP510R, KODE_CABANG, FL_BYR, UPDSTAMP, INPUTER) SELECT NOPEN, KODEPROG, JENIS, DAPEM, NIPPA, SIFAT, NAMA_PESERTA, SEX, TGL_LAHIR, PANGKAT, KP050, KP060, KP070, KP080, KP090, KP100, KP110, KP120, KP130, KP140, KP150, KP160, KP170, KP175, TMT_PENSIUN, KP185, KP190, KP200, KP210, KP220, KP230, KP240, KP250, KP270, KP280, KP290, KP300, KP310, KP315, KP320, KP330, KP335, KP340, KP350, KP360, KP370, KP380, KP390, KP400, KP410, KP420, KP430, KP440, KP450, KP460, KP470, DK_KP470, KP480, KP485, DK_KP485, KP490, KP500, KP510, KP515, KP520, KP530, KP540, KP550, KP560, KP570, KP580, KP590, KP600, NAMA_PENERIMA, SEX_PNRM, TGL_LAHIR_PEN, ALAMAT, KP650, KANTOR_BAYAR, KP670, STOP_PERMANEN, BLTH_STOP_PERM, KP700, KP710, KP720, KP730, KP740, NOMOR_DOSIR, KP760, STOP_SEMENTARA, BLTH_STOP_SEMEN, KP800, KP810, KP820, KP830, KP840, KP550R, KP510R, KODE_CABANG, FL_BYR,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.PENSIUN_PUNAH;
INSERT INTO TASPEN.PERHITUNGAN_THT(NOTAS, KDKEJADIAN, KDPRODUK, KDKELOMPOK, TGLLHR, TMT_TASPEN, TGLPMK, TGLKEJADIAN, TANGGALMI2, PENYEBUT, PEMBAGI, HAKBAGITHT, HAKBAGIASKEM, BUP, TAHUN_UM, BULAN_UM, UM, TAHUN_UB, BULAN_UB, UB, TAHUN_MI1, BULAN_MI1, MI1, TAHUN_MI2, BULAN_MI2, MI2, TAHUN_Y1, BULAN_Y1, Y1, TAHUN_Y2, BULAN_Y2, Y2, TAHUN_MIB, BULAN_MIB, MIB, FAKTOR_THNMI1, FAKTOR_BLNMI1, FAKTOR1, FAKTOR_THNMI2, FAKTOR_BLNMI2, FAKTOR2, FORMULA, TAHUN_US2001, BULAN_US2001, KEDUDUKAN, JENISPEGAWAI, TAHUN_USB2004, BULAN_USB2004, USB2004, RUMUS_ASKEM,        KDPANGKAT, GAPOK, GAPOK97, MASKER, ISTRI, ANAK, THP2, THP_97, THP3, THT, NILTUN, ASKEM, SALDO_SIUR, KI, TEDIB, ASKEMTEDIB, SISA_ASUR, BULAT, DK_BULAT, MATERAI, BERSIH, TYPEVOC, GAPOK2003, THPBULOG, MINIMAL_THT, MINIMAL_ASKEM, PERSENTHT, PI, KIPENS, TAPERUM, GAPOK_AKHIR, TGLKLAIM) SELECT TRIM(NOTAS), KDKEJADIAN, KDPRODUK, KDKELOMPOK, TGLLHR, TMT_TASPEN, TGLPMK, TGLKEJADIAN, TANGGALMI2, PENYEBUT, PEMBAGI, HAKBAGITHT, HAKBAGIASKEM, BUP, TAHUN_UM, BULAN_UM, UM, TAHUN_UB, BULAN_UB, UB, TAHUN_MI1, BULAN_MI1, MI1, TAHUN_MI2, BULAN_MI2, MI2, TAHUN_Y1, BULAN_Y1, Y1, TAHUN_Y2, BULAN_Y2, Y2, TAHUN_MIB, BULAN_MIB, MIB, FAKTOR_THNMI1, FAKTOR_BLNMI1, FAKTOR1, FAKTOR_THNMI2, FAKTOR_BLNMI2, FAKTOR2, FORMULA, TAHUN_US2001, BULAN_US2001, KEDUDUKAN, JENISPEGAWAI, TAHUN_USB2004, BULAN_USB2004, USB2004, RUMUS_ASKEM, TRIM(KDPANGKAT), GAPOK, GAPOK97, MASKER, ISTRI, ANAK, THP1, THP2, THP3, THT, NILTUN, ASKEM, SALDO_SIUR, KI, TEDIB, ASKEMTEDIB, SISA_ASUR, BULAT, DK_BULAT, MATERAI, BERSIH, TYPEVOC, GAPOK2003, THPBULOG, MINIMAL_THT, MINIMAL_ASKEM, PERSENTHT, PI, KIPENS, TAPERUM,0,null FROM MIG_ACB.PERHITUNGAN_THT;
INSERT INTO TASPEN.PKS_RUMAH_SAKIT(KODE_RS_KLINIK_FASKES, KDCABANG, NMR_PKS_TASPEN, NMR_PKS_RS, TGL_PKS, TMT_PKS, TAT_PKS, KETERANGAN, UPDSTAMP, INPUTER) SELECT KODE_RS_KLINIK_FASKES, KDCABANG, NMR_PKS_TASPEN, NMR_PKS_RS, TGL_PKS, TMT_PKS, TAT_PKS, KETERANGAN, UPDSTAMP, INPUTER FROM MIG_ACB.RUMAH_SAKIT;
INSERT INTO TASPEN.PMK_PUNAH(NIPPA, KDKEJ, MODE, PMK010, PMK020, PMK030, PMK040, PMK050, PMK060, PMK070, PMK080, PMK090, PMK095, PMK100, PMK105, PMK110, PMK120, PMK130, PMK140, PMK150, PMK160, PMK170, PMK180, PMK190, PMK200, PMK205, PMK210, PMK220, PMK230, PMK235, PMK240, PMK250, PMK260, PMK265, PMK270, PMK280, PMK290, PMK295, PMK300, PMK310, PMK320, PMK330, PMK335, PMK340, PMK345, PMK350, PMK360, PMK365, PMK370, PMK380, PMK390, PMK400, PMK405, PMK410, PMK420, PMK430, PMK435, PMK440, PMK450, PMK460, PMK465, PMK470, PMK480, PMK490, PMK500, PMK510, PMK520, PMK530, UPDSTAMP, INPUTER) SELECT NIPPA, KDKEJ, MODE, PMK010, PMK020, PMK030, PMK040, PMK050, PMK060, PMK070, PMK080, PMK090, PMK095, PMK100, PMK105, PMK110, PMK120, PMK130, PMK140, PMK150, PMK160, PMK170, PMK180, PMK190, PMK200, PMK205, PMK210, PMK220, PMK230, PMK235, PMK240, PMK250, PMK260, PMK265, PMK270, PMK280, PMK290, PMK295, PMK300, PMK310, PMK320, PMK330, PMK335, PMK340, PMK345, PMK350, PMK360, PMK365, PMK370, PMK380, PMK390, PMK400, PMK405, PMK410, PMK420, PMK430, PMK435, PMK440, PMK450, PMK460, PMK465, PMK470, PMK480, PMK490, PMK500, PMK510, PMK520, PMK530,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.PMK_PUNAH;
INSERT INTO TASPEN.PMKTHT(NO_TSP, NOTAS, KDKEJ, TGLKEJ, TYPEVOC, NOVOC, THVOC, TGLKLIM, TGLTRANS, GAPOK, THP, NAMAYMK, TGLLHR_YMK, PENERIMA, CASH_VAL, RP_ASUNIL, RP_ASKEM, RP_KI, RP_TAPERUM, RP_SISAASUR, RP_CEKPOS, RP_BULAT, DK_BULAT, RP_TEDIB, RP_HAK, NO_CEKPOS, TGL_CEKPOS, KDCAB, FLAG, KDHUBKEL) SELECT NO_TSP, TRIM(NOTAS), KDKEJ, TGLKEJ, TYPEVOC, NOVOC, THVOC, TGLKLIM, TGLTRANS, GAPOK, THP, NAMAYMK, TGLLHR_YMK, PENERIMA, CASH_VAL, RP_ASUNIL, RP_ASKEM, RP_KI, RP_TAPERUM, RP_SISAASUR, RP_CEKPOS, RP_BULAT, DK_BULAT, RP_TEDIB, RP_HAK, NO_CEKPOS, TGL_CEKPOS, KDCAB, FLAG, KDHUBKEL FROM MIG_ACB.PMKTHT;
INSERT INTO TASPEN.PREMI_DPB(NOTAS, JENIS_DPB, NORUT, TMT_PREMI, TAT_PREMI, JMLBLN, PREMI_THT, JPREMI_THT, PREMI_PENS, JPREMI_PENS, KE, KETERANGAN, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), JENIS_DPB, NORUT, TMT_PREMI, TAT_PREMI, JMLBLN, PREMI_THT, JPREMI_THT, PREMI_PENS, JPREMI_PENS, KE, KETERANGAN, UPDSTAMP, INPUTER FROM MIG_ACB.PREMI_DPB;
INSERT INTO TASPEN.PREMI_HIST_GAJIDO(KDCABANG, JNSGAJI, BLTHGAJI, PEGAWAI, GAPOK, ISTRI, ANAK, KELSSBP, KDSSBP, KDSKPD, KDKELOMPOK, KDSATKER, THP, IURAN_DO, KDPRODUK) SELECT KDCABANG, KDJNSTRANS, BLTHGAJI, PEGAWAI, GAPOK, ISTRI, ANAK, KELSSBP, KDSSBP, KDSKPD, KDKELOMPOK, KODESSATKER, THP, IURAN_DO,0 FROM MIG_ACB.PREMI_HISTGDO;
INSERT INTO TASPEN.PROSES_MEDIA(KDCABANG, KELSSBP, KDSSBP, BLTHGAJI, PROSES2A, PROSES2B, PROSES3A, PROSES3B, PROSES4A, PROSES4B, PROSES1A, PROSES1B, JNSGAJI) SELECT KDCABANG, KELSSBP, KDSSBP, BLTHGAJI, PROSES2A, PROSES2B, PROSES3A, PROSES3B, PROSES4A, PROSES4B, PROSES1A, PROSES1B, JNSGAJI FROM MIG_ACB.PROSES_MEDIA;
INSERT INTO TASPEN.RAPEL_GAPOK(NOTAS, NIP, KDPANGKAT, GAJI, TISTRI, TANAK, IURAN_THT, IURAN_PENS, IURAN_JKK, IURAN_JKM, SATKERPEMDA, JMLBLN, TMT_RAPEL, TAT_RAPEL, BLTHGAJI, KDSATKER, KDSKPD, KDSSBP, KELSSBP, KDCABANG, FILLER, TMT_KERJA, SUMBER, JNSGAJI, TMT_BERLAKU) SELECT TRIM(NOTAS), NIP, TRIM(KDPANGKAT), GAJI, TISTRI, TANAK, IURAN_THT, IURAN_PENS, IURAN_JKK, IURAN_JKM, SATKERPEMDA, JMLBLN, TMT_RAPEL, TAT_RAPEL, BLTHGAJI, KDSATKER, KDSKPD, KDSSBP, KELSSBP, KDCABANG, FILLER, TMT_KERJA, SUMBER, JNSGAJI, TMT_BERLAKU FROM MIG_ACB.RAPEL_GAPOK;
INSERT INTO TASPEN.RAWAT_INAP(NOTAS, TGLKLAIM, TMT_RAWAT, TAT_RAWAT, NAMA_RS, ALAMAT_RS, KDDATI1, KDDATI2, KDDATI3, KDDATI4, NMDOKTER, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), TGLKLAIM, TMT_RAWAT, TAT_RAWAT, NMRUMAHSAKIT, ALM_RMHSAKIT, KDDATI1, KDDATI2, KDDATI3, KDDATI4, NMDOKTER, UPDSTAMP, INPUTER FROM MIG_ACB.RAWAT_INAP;
INSERT INTO TASPEN.REKAP_ELO(NOTAS, KDPRODUK, KDKLAIM, NOVOUCHER, TGLPOSTING, TGLREKAM, KDCABANG, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDPRODUK, KDKLAIM, NOVOUCHER, TGLPOSTING, TGLREKAM, KDCABANG,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.REKAP_ELO;
INSERT INTO TASPEN.REKAP_INDIVIDU_RAMPUNG(NOTAS, TAHUN, NPWP, JLHBLN, TPAJAKDPM, PPAJAKDPM, TPAJAKNEW, PPAJAKNEW, SELTPAJAK, SELPPAJAK, KOMPENSASI, TPAJAKNORMALDES, PAJAKSETAHUN, PAJAKRAMPUNGDES, KETERANGAN, FLAG, PINALTY_NPWP, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), TAHUN, NPWP, JLHBLN, TPAJAKDPM, PPAJAKDPM, TPAJAKNEW, PPAJAKNEW, SELTPAJAK, SELPPAJAK, KOMPENSASI, TPAJAKNORMALDES, PAJAKSETAHUN, PAJAKRAMPUNGDES, KETERANGAN, FLAG, PINALTY_NPWP,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.REKAP_INDIVIDU_RAMPUNG;
INSERT INTO TASPEN.REKAP_PERSETUJUAN(KDCABANG, TGLDAPEM, KDJNSTRANS, KDKELBAYAR, JML_JURUBAYAR, NMKELBAYAR, JML_PENS, BERSIH, POT_DROPPING, RP_POTDROPPING, JML_DROPPING, RP_DROPPING, TGL_SETUJU, OTORISATOR, JENIS, UPDSTAMP, INPUTER) SELECT KDCAB, TGLDAPEM, KDJNSTRANS, KDKELBAYAR, JML_JURUBAYAR, NMKELBAYAR, JML_PENS, BERSIH, POT_DROPPING, RP_POTDROPPING, JML_DROPPING, RP_DROPPING, TGL_SETUJU, OTORISATOR, JENIS,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.REKAP_PERSETUJUAN;
INSERT INTO TASPEN.REKAP_RAMPUNG(KDCABANG, TAHUN, JMLPENS, A1, A2, A3, A4, A5, A7, A9, A10, A11, A14, A15, A16, A17, A18, A1_WEB, A2_WEB, A3_WEB, A4_WEB, A5_WEB, A7_WEB, A9_WEB, A10_WEB, A11_WEB, A14_WEB, A15_WEB, A16_WEB, A17_WEB, A18_WEB, KODE_PERSETUJUAN, USER_PERSETUJUAN, TGL_PERSETUJUAN, KODE_UPLOAD, USER_UPLOAD, TGL_UPLOAD, JPENSWEB, UPDSTAMP, INPUTER) SELECT KDCABANG, TAHUN, JMLPENS, A1, A2, A3, A4, A5, A7, A9, A10, A11, A14, A15, A16, A17, A18, A1_WEB, A2_WEB, A3_WEB, A4_WEB, A5_WEB, A7_WEB, A9_WEB, A10_WEB, A11_WEB, A14_WEB, A15_WEB, A16_WEB, A17_WEB, A18_WEB, KODE_PERSETUJUAN, USER_PERSETUJUAN, TGL_PERSETUJUAN, KODE_UPLOAD, USER_UPLOAD, TGL_UPLOAD, JPENSWEB,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.REKAP_RAMPUNG;
INSERT INTO TASPEN.REKAP_TAGIHAN_PENS(KDCABANG, TGLCATAT, KODEBYR, THN2011, ASAL, SALDOAWAL, TAGIHAN, KOREKSITAGIHAN, REALISASI, KOREKSIREALISASI, CAIR, UPDSTAMP, INPUTER) SELECT KDCABANG, TGLCATAT, KODEBYR, THN2011, ASAL, SALDOAWAL, TAGIHAN, KOREKSITAGIHAN, REALISASI, KOREKSIREALISASI, CAIR, UPDSTAMP, INPUTER FROM MIG_ACB.RKPTAGIHAN_PENS;
INSERT INTO TASPEN.RIWAYAT_KIPI(PERIODE, NOTAS, JENIS_KIPI, TMT_KIPI, TAT_KIPI, TGLVALUASI, MI_KIPI_THT_YY, MI_KIPI_THT_MM, MI_KIPI_PEN_YY, MI_KIPI_PEN_MM, KETERANGAN, TGLPMK, SETORAN, TGLRENCANA, TGLPOSTING, UPDSTAMP, INPUTER) SELECT PERIODE, TRIM(NOTAS), JENIS_KIPI, TMT_KIPI, TAT_KIPI, TGLVALUASI, MI_KIPI_THT_YY, MI_KIPI_THT_MM, MI_KIPI_PEN_YY, MI_KIPI_PEN_MM, KETERANGAN, TGLPMK, SETORAN, TGLRENCANA, TGLPOSTING,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.RIWAYAT_KIPI;
INSERT INTO TASPEN.RIWAYAT_UPAH(KDKELOMPOK, NOTAS, TMT_UPAH, TAT_UPAH, ISTRI, ANAK, GAPOK, PROSENTASE, PANGKAT, KETERANGAN, JABATAN, TAHUN, BULAN, N_BULAN, M1_BULAN, M2_BULAN, THP, PREMI_THT, PREMI_PENS, M1_BUNGA, M2_BUNGA, RP_BUNGA_PENS, RP_BUNGA_THT, JNS_TRANS, RP_JABATAN, PREMI_MGS, RP_BUNGA_MGS, JNS_PESERTA, JENIS_KIPI, UPDSTAMP, INPUTER) SELECT KDKELOMPOK, TRIM(NOTAS), TMT_UPAH, TAT_UPAH, ISTRI, ANAK, GAPOK, PROSENTASE, PANGKAT, KETERANGAN, JABATAN, TAHUN, BULAN, N_BULAN, M1_BULAN, M2_BULAN, THP, PREMI_THT, PREMI_PENS, M1_BUNGA, M2_BUNGA, RP_BUNGA_PENS, RP_BUNGA_THT, JNS_TRANS, RP_JABATAN, PREMI_MGS, RP_BUNGA_MGS, JNS_PESERTA, JENIS_KIPI,CURRENT_DATE,'MIGRASI NCB' FROM MIG_ACB.RIWAYAT_UPAH;
INSERT INTO TASPEN.RPPN(NORUT, NPWP, NAMAWP, JNS_PAJAK, KDCABANG, KD_ACCPJK, KD_JNS_SETORAN, URAIAN, MASA_PAJAK, RUPIAH, NO_NTPN, TGL_SETOR, NM_SETOR, SERIFAKTUR, NOVOUCHER, TGLPOSTING, TGLFAKTUR, UPDSTAMP, INPUTER) SELECT NORUT, NPWP, NAMAWP, JNS_PAJAK, KDCAB, KD_ACCPJK, KD_JNS_SETORAN, URAIAN, MASA_PAJAK, RUPIAH, NO_NTPN, TGL_SETOR, NM_SETOR, SERIFAKTUR, NOVOUCHER, TGLPOSTING, TGLFAKTUR, UPDSTAMP, INPUTER FROM MIG_ACB.RPPN;
INSERT INTO TASPEN.RSSBP(NO_SETOR, TGLSETOR, JNS_STR, JNS_DPM, JNS_LR, KDKPKN, JNS_MAP, KDMAP, KDCABANG, NILAI_STR, NMR_SPN, TGL_SPN, URAIAN, NM_SETOR, NO_NTPN, NOVOUCHER, TGLPOSTING, UPDSTAMP, INPUTER) SELECT NO_SETOR, TGLSETOR, JNS_STR, JNS_DPM, JNS_LR, KDKPKN, JNSMAKP, KDMAP, KDCAB, NILAI_STR, NMR_SPN, TGL_SPN, URAIAN, NM_SETOR, NO_NTPN, NOVOUCHER, TGLPOSTING, UPDSTAMP, INPUTER FROM MIG_ACB.RSSBP;
INSERT INTO TASPEN.SALDO_HARIAN(KDCABANG, TGLTRANS, KDPROGRAM, NORUT, SALDO, INPUTER, UPDSTAMP, KDVOUCHER, KDDANA) SELECT KDCABANG, TGLTRANS, KDPROGRAM, NORUT, SALDO, INPUTER, UPDSTAMP, KDVOUCHER, KDDANA FROM MIG_ACB.SALDO_HARIAN;
INSERT INTO TASPEN.SALDO_INDIVIDUAL_ACCOUNT(NOTAS, JNSGAJI, TMT_IURAN, KDCABANG, TGL_SETOR, KDPANGKAT, KDJIWA, SALDO_AWAL, GAPOK, GAPOK_CUTOFF, REALISASI_BULANAN, REALISASI_CUTOFF, IURAN_PASTI, IURAN_PEMBERI_KERJA, HASIL_INVESTASI, BIAYA, TINGKAT_INVESTASI, SALDO_IURAN_PASTI, SALDO_HASIL_INVESTASI, SALDO_AKHIR, NILAI_MANFAAT, JUMLAH_HAK, STS_KLIM, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDTRANSAKSI, TMT_IURAN, KDCABANG, TGL_SETOR, TRIM(KDPANGKAT), KDJIWA, SALDO_AWAL, GAPOK, GAPOK_CUTOFF, REALISASI_BULANAN, REALISASI_CUTOFF, IURAN_PASTI, IURAN_PEMBERI_KERJA, HASIL_INVESTASI, BIAYA, TINGKAT_INVESTASI, SALDO_IURAN_PASTI, SALDO_HASIL_INVESTASI, SALDO_AKHIR, NILAI_MANFAAT, JUMLAH_HAK, STS_KLIM, UPDSTAMP, INPUTER FROM MIG_ACB.SALDO_INDIVIDU_B;
INSERT INTO TASPEN.SANTUNAN_BERKALA(BLTHSANTUNAN, KDCABANG, NOTAS, KDHUBKEL, KDPRODUK, KDJNSTRANS, KDLAYANAN, NMYGBERHAK, NMPENERIMA, KODEBYR, NOREK, TMT_MULAI, NO_SURAT, TGL_SURAT, PENERBIT_SURAT, TGLKEJADIAN, KOTOR, PEMBULATAN, BERSIH, INPUTER, UPDSTAMP) SELECT BLTHSANTUNAN, KDCABANG, TRIM(NOTAS), KDHUBKEL, KDPRODUK, KDJNSTRANS, KDLAYANAN, NMYGBERHAK, NMPENERIMA, KODEBYR, NOREK, TMT_MULAI, NO_SURAT, TGL_SURAT, PENERBIT_SURAT, TGLKEJADIAN, KOTOR, PEMBULATAN, BERSIH, INPUTER, UPDSTAMP FROM MIG_ACB.SANTUNAN_BERKALA;
INSERT INTO TASPEN.STS_DAPEM(NOTAS, KDHUBKEL, TMT_STATUS, KETERANGAN, TMT_STOP, KDSTOP, UPDSTAMP, JNSSTOP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, TMT_STATUS, KETERANGAN, TMT_STOP, KDSTOP, UPDSTAMP, JNSTOP, INPUTER FROM MIG_ACB.STS_DAPEM;
INSERT INTO TASPEN.STS_SANTUNAN(NOTAS, KDHUBKEL, KDLAYANAN, TMT_STATUS, KDSTOP, TMT_STOP, KETERANGAN, INPUTER, UPDSTAMP) SELECT TRIM(NOTAS), KDHUBKEL, KDLAYANAN, TMT_STATUS, KDSTOP, TMT_STOP, KETERANGAN, INPUTER, UPDSTAMP FROM MIG_ACB.STS_SANTUNAN;
INSERT INTO TASPEN.TAGIHAN_UDW_HAPUS(NOTAS, KDHUBKEL, TGLPROSES, KDJNSTRANS, TGLKLAIM, TGLDAMU, TGLWAFAT, NILAI_TAGIHAN, NILAI_REALISASI, ASAL_TAGIHAN, KDCABANG, UPDSTAMP, TMT_DICADANGKAN, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, TGLPROSES, KDJNSTRANS, TGLKLAIM, TGLDAMU, TGLWAFAT, NILAI_TAGIHAN, NILAI_REALISASI, ASAL_TAGIHAN, KDCABANG, UPDSTAMP, TMT_DICADANGKAN,'MIGRASI NCB' FROM MIG_ACB.TAGIHAN_UDW_HAPUS;
INSERT INTO TASPEN.TAPERUM_DANA(TMT_DANA, JENIS, FLAT_DANA, SETORAN_DANA, REC_REALISASI, RP_REALISASI, SALDO, UPDSTAMP, INPUTER) SELECT TMT_DANA, JENIS, FLAT_DANA, SETORAN_DANA, REC_REALISASI, RP_REALISASI, SALDO, UPDSTAMP,'MIGRASI NCB' FROM MIG_ACB.TAPERUM_DANA;
INSERT INTO TASPEN.TAPERUM_H2H(PNS_NIPPNS, PNS_NIPBARU, NAMA, TANGGALLAHIR, MS_TGLRLS, INSTANSI, ALAMAT, SALDO, BANK, KDSTATUS_BOOK, RESPON_BOOK, KDSTATUS_PAYMENT, RESPON_PAYMENT, TGLBOOK, TGLPAYMENT, UPDSTAMP, INPUTER, NOTAS) SELECT PNS_NIPPNS, PNS_NIPBARU, NAMA, TANGGALLAHIR, MS_TGLRLS, INSTANSI, ALAMAT, SALDO, BANK, KDSTATUS_BOOK, RESPON_BOOK, KDSTATUS_PAYMENT, RESPON_PAYMENT, TGLBOOK, TGLPAYMENT, UPDSTAMP, INPUTER, TRIM(NOTAS) FROM MIG_ACB.TAPERUM_H2H;
INSERT INTO TASPEN.TAPERUM_TRX(NOTAS, NIP_KPE, NAMA, TGLLHR, TMT_PEGAWAI, TGLKEJADIAN, KDKLAIM, KDPANGKAT, NOMINAL_TAPERUM, TGLTRANS, KODETRANS, TGLKLAIM, INPUTER, UPDSTAMP) SELECT TRIM(NOTAS), NIP_KPE, NAMA, TGLLHR, TMT_PEGAWAI, TGLKEJADIAN, KDKLAIM, TRIM(KDPANGKAT), NOMINAL_TAPERUM, TGLTRANS, KODETRANS, TGLKLAIM,'MIGRASI NCB',CURRENT_DATE FROM MIG_ACB.TAPERUM_TRX;
INSERT INTO TASPEN.TARNALA(NOTAS, NIP, NAMA, TGLLHR, MASKER, TMT_GAPOK, KDPANGKAT, KDKELOMPOK, GAPOK, TMTKERJA, KDJIWA, KDTAR, KDAKSI, KDDATI1, KDDATI2, KDDATI3, KDDATI4, KDINSTANSITP, KDINSTANSI, KDDIRJEN, KDBIRO, KDBAG, KDSATKER, KDCABANG, KDJNSPEG, UPDSTAMP, KDCABANG_BARU, FILLER, KELSSBP, KDSSBP) SELECT TRIM(NOTAS), NIP, NAMA, TGLLHR, MASKER, TMT_GAPOK, TRIM(KDPANGKAT), KDKELOMPOK, GAPOK, TMTKERJA, KDJIWA, KDTAR, KDAKSI, KDDATI1, KDDATI2, KDDATI3, KDDATI4, KDINSTANSITP, KDINSTANSI, KDDIRJEN, KDBIRO, KDBAG, KDSATKER, KDCABANG, KDJENPEG, UPDSTAMP, KDCAB_BARU, FILLER, KELSSBP, KDSSBP FROM MIG_ACB.TARNALA;
INSERT INTO TASPEN.TERLANJUR_BYR(NOTAS, KDHUBKEL, NO_URUT, NIL_TAGIHAN, NIL_REALISASI, NOSAP, TGL_TRANSAKSI, INPUTER, UPDSTAMP, TGL_SURAT, NO_SURAT) SELECT TRIM(NOTAS), KDHUBKEL, NO_URUT, NIL_TAGIHAN, NIL_REALISASI, NOSAP, TGL_TRANSAKSI, INPUTER, UPDSTAMP, TGL_SURAT, NO_SURAT FROM MIG_ACB.TERLANJUR_BYR;
INSERT INTO TASPEN.TGL_APPROVAL(TGLDAPEM, KDJNSTRANS, DAPEM, TGL_AWAL, TGL_AKHIR, KDKAI, AWAL_POT, AKHIR_POT, AWAL_PASIF, AKHIR_PASIF, AWAL_CAIR, AKHIR_CAIR) SELECT TGLDAPEM, KDJNSTRANS, DAPEM, TGL_AWAL, TGL_AKHIR, KDKAI, AWAL_POT, AKHIR_POT, AWAL_PASIF, AKHIR_PASIF, AWAL_CAIR, AKHIR_CAIR FROM MIG_ACB.TGL_APPROVAL;
INSERT INTO TASPEN.TGL_PROSES(TGLPROSES, KETERANGAN, CATATAN, UPDSTAMP, RUNNED, KDCABANG, KDJNSTRANS, KDPRODUK, INPUTER, KDPENS13, KDRAPEL, KDPENS13KAI, SPJ13, SPJRAPEL, SPJ13KAI, TGL_SETUJU, OTORISATOR, TGLSTART, JMLSTART, JMLPROSES, TGLFINISHED, JMLFINISHED, STATUSPROSES, KDTHR, SPJTHR) SELECT TGLPROSES, KETERANGAN, CATATAN, UPDSTAMP, RUNNED, KDCABANG, KDJNSTRANS, KDPRODUK, INPUTER, KDPENS13, KDRAPEL, KDPENS13KAI, SPJ13, SPJRAPEL, SPJ13KAI, TGL_SETUJU, OTORISATOR, TGLSTART, JMLSTART, JMLPROSES, TGLFINISHED, JMLFINISHED, STATUSPROSES, KDTHR, SPJTHR FROM MIG_ACB.TGL_PROSES;
INSERT INTO TASPEN.TMSBMS_HIST(NOTAS, NAMA_PESERTA, NAMA_PEMOHON, KDHUBKEL_PEMOHON, JENIS, KDCABANG, KDPRODUK, KDKLAIM, NMPRODUK, NMKLAIM, NOANTRI, TGLPENGAJUAN, TGLANTRI, SUMBER_SPP, TGLREKAM, ALM_PEMOHON, KDDATI1, KDDATI2, KDDATI3, KDDATI4, TELEPON, ALASAN1, ALASAN2, ALASAN3, ALASAN4, ALASAN5, ALASAN6, KETERANGAN, NOSURAT, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), NAMA_PESERTA, NAMA_PEMOHON, KDHUBKEL_PEMOHON, JENIS, KDCABANG, KDPRODUK, KDKLAIM, NMPRODUK, NMKLAIM, NOANTRI, TGLPENGAJUAN, TGLANTRI, SUMBER_SPP, TGLREKAM, ALM_PEMOHON, KDDATI1, KDDATI2, KDDATI3, KDDATI4, TELEPON, ALASAN1, ALASAN2, ALASAN3, ALASAN4, ALASAN5, ALASAN6, KETERANGAN, NOSURAT,CURRENT_DATE, INPUTER FROM MIG_ACB.TMSBMS_HIST;
INSERT INTO TASPEN.TRANS_DAMUUPL(NOTAS, KDHUBKEL, TGLPROSES, KDJNSTRANS, TGLREKAM, TGLDAMU, NILAI_DAMU, KDCABANG, KDBENDAHARA, KDGROUP, JNSBAYAR, KDKANBYR, NOKTRSETOR, NILAI_BALIK, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, TGLPROSES, KDJNSTRANS, TGLREKAM, TGLDAMU, NILAI_DAMU, KDCABANG, KDBENDAHARA, KDGROUP, JNSBAYAR, KDKANBYR, NOKTRSETOR, NILAI_BALIK, UPDSTAMP, INPUTER FROM MIG_ACB.TRANS_DAMUUPL;
INSERT INTO TASPEN.TRANS_JKKJKM(NOTAS, KDHUBKEL, TGLKLAIM, KDKLAIM, KDTRANS, KDJNSTRANS, KDPRODUK, NILAI, KDKELOMPOK, KDCABANG, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, TGLKLAIM, KDKLAIM, KDTRANS, KDJNSTRANS, KDPRODUK, NILAI, KDKELOMPOK, KDCABANG, UPDSTAMP, INPUTER FROM MIG_ACB.TRANS_JAMINAN;
INSERT INTO TASPEN.TRS_KET_TAGUDW(NOTAS, KDHUBKEL, TGLPROSES, KDJNSTRANS, KETERANGAN, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, TGLPROSES, KDJNSTRANS, KETERANGAN, UPDSTAMP, INPUTER FROM MIG_ACB.KET_TAGUDW;
INSERT INTO TASPEN.TRS_MONCREATE_TAGIH_PENS(TGLCATAT, KDCABANG, UPDSTAMP, INPUTER) SELECT TGLCATAT, KDCABANG, UPDSTAMP, INPUTER FROM MIG_ACB.MONCREATE_TAGIHAN_PENS;
INSERT INTO TASPEN.TRS_NOVOUCHER_HILANG(KDCABANG, NOTAS, TGLKLAIM, KDKEJADIAN, TGL_KEJADIAN, KDPRODUK, NOVOUCHER, KETERANGAN, KDHUBKEL, RETUR_KE, INPUTER, UPDSTAMP, NMPENERIMA, TGLHAPUS, JNS_HAPUS) SELECT KDCABANG, TRIM(NOTAS), TGLKLAIM, KDKEJADIAN, TGL_KEJADIAN, KDPRODUK, NOVOUCHER, KETERANGAN, KDHUBKEL, RETUR_KE, INPUTER, UPDSTAMP, NMPENERIMA, TGLHAPUS, JNS_HAPUS FROM MIG_ACB.NOVOUCHER_HILANG WHERE NOTAS IS NOT NULL AND KDKEJADIAN IS NOT NULL;
INSERT INTO TASPEN.TRS_RSSP(NORUT, NPWP, JNS_PAJAK, JNS_DPM, KDCABANG, NOP, ALM_OP, KD_ACCPJK, KD_JNS_SETORAN, URAIAN, MASA_PAJAK, NO_KTETAPAN, RUPIAH, NO_NTPN, TGL_SETOR, NM_SETOR, TEMPAT_STR, NOVOUCHER, TGLPOSTING, TGLLAPOR, UPDSTAMP, INPUTER) SELECT NORUT, NPWP, JNS_PAJAK, JNS_DPM, KDCAB, NOP, ALM_OP, KD_ACCPJK, KD_JNS_SETORAN, URAIAN, MASA_PAJAK, NO_KTETAPAN, RUPIAH, NO_NTPN, TGL_SETOR, NM_SETOR, TEMPAT_STR, NOVOUCHER, TGLPOSTING, TGLLAPOR, UPDSTAMP, INPUTER FROM MIG_ACB.RSSP;
INSERT INTO TASPEN.VACUM_IURAN(TMT_VACUM, KDHUBKEL, NOTAS, TAT_VACUM, KDJIWA, KDVACUM, MASKER, TMT_GAPOK, KDPANGKAT, KDKELOMPOK, KETERANGAN, UPDSTSTAMP, INPUTER, SUMBER_VACUM) SELECT TMT_VACUM, KDHUBKEL, TRIM(NOTAS), TAT_VACUM, KDJIWA, KDVACUM, MASKER, TMT_GAPOK, TRIM(KDPANGKAT), KDKELOMPOK, KETERANGAN, UPDSTSTAMP, INPUTER,NULL FROM MIG_ACB.VACUM;
INSERT INTO TASPEN.WALI_JKKJKM(NOTAS, KDHUBKELWALI, KDHUBKEL, TGLKEJADIAN, NMKEL, TGLLHR, PENERBIT, TGLPENETAPAN, NOMOR, KETERANGAN, NMKELWALI, TGLLHRWALI, KDSTSWALI, UPDSTAMP, INPUTER) SELECT  TRIM(NOTAS), KDHUBKELWALI, KDHUBKEL, TGLKEJADIAN, NMKEL, TGLLHR, PENERBIT, TGLPENETAPAN, NOMOR, KETERANGAN, NMKELWALI, TGLLHRWALI, KDSTSWALI, UPDSTAMP, INPUTER FROM MIG_ACB.WALI_JKKJKM;
INSERT INTO TASPEN.WORK_UKP_DETAIL(NOTAS, TGLKLAIM, JENISHIT, TGLPROSES, KDTRANS, NILAI, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), TGLKLAIM, JENISHIT, TGLPROSES, KDTRANS, NILAI, UPDSTAMP, INPUTER FROM MIG_ACB.WORK_UKP_DETAIL;
INSERT INTO TASPEN.WORK_UKP(NOTAS, TGLKLAIM, TMT_EFEKTIF, JENISHIT, TIPEHIT, TMT_AKHIR, KDJIWA, KDJNSPENSIUN, KDKELOMPOK, KDPANGKAT, MASKER, KD_UKP, KDTP, KDSIFATPOK, PENS_POKOK, KDHIT, POTKPKN, POTKASDA, SEWARMH, TUNJ_TEWAS, TUNJ_CACAT, KOND_DAPEM, TMT_PENPOK, KOND_BERAS, TDAHOR, TGR, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), TGLKLAIM, TMT_EFEKTIF, JENISHIT, TIPEHIT, TMT_AKHIR, KDJIWA, KDJNSPENSIUN, KDKELOMPOK, TRIM(KDPANGKAT), MASKER, KD_UKP, KDTP, KDSIFATPOK, PENS_POKOK, KDHIT, POTKPKN, POTKASDA, SEWARMH, TUNJ_TEWAS, TUNJ_CACAT, KOND_DAPEM, TMT_PENPOK, KOND_BERAS, TDAHOR, TGR, UPDSTAMP, INPUTER FROM MIG_ACB.WORK_UKP;
INSERT INTO TASPEN.KLAIM_HUTANG(TGLKLAIM, KDHUBKEL, NOTAS, TGLTERIMA_PENS, TGLRENBAYAR, GLRDEPAN, NMPENERIMA, GLRAKHIR, ALM_KLIMPENS, KDDATI1, KDDATI2, KDDATI3, KDDATI4, KODEPOS, TELEPON, NOKTP, NOREK, JMLANAK, KDJNSPENERIMA, KDPANGKAT, KDKELOMPOK, KDSIFATPOK, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, KDJNSPENSIUN, KDPRODUK, TMT_RAPEL, TAT_RAPEL, TGLLHR_PENERIMA, JENKEL_PENERIMA, JMLISTRI, UPDSTAMP, INPUTER) SELECT TGLKLAIM, KDHUBKEL, TRIM(NOTAS), TGLTERIMA_PENS, TGLRENBAYAR, GLRDEPAN, NMPENERIMA, GLRAKHIR, ALM_KLIMPENS, KDDATI1, KDDATI2, KDDATI3, KDDATI4, KODEPOS, TELEPON, NOKTP, NOREK, JMLANAK, KDJNSPENERIMA, TRIM(KDPANGKAT), KDKELOMPOK, KDSIFATPOK, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, KDJNSPENSIUN, KDPRODUK, TMT_RAPEL, TAT_RAPEL, TGLLHR_PENERIMA, JENKEL_PENERIMA, JMLISTRI, UPDSTAMP, INPUTER FROM MIG_ACB.KLAIM_HUTANG;
INSERT INTO TASPEN.WORK_HUTANG(NOTAS, KDHUBKEL, TGLKLAIM, TMT_EFEKTIF, JENISHIT, TIPEHIT, TMT_AKHIR, KDJIWA, KDJNSPENSIUN, KDKELOMPOK, KDPANGKAT, MASKER, KD_UKP, KDTP, KDSIFATPOK, PENS_POKOK, KDHIT, POTKPKN, POTKASDA, SEWA_RUMAH, TUNJ_TEWAS, TUNJ_CACAT, KOND_DAPEM, TMT_PENPOK, KOND_BERAS, UPDSTAMP, INPUTER)             SELECT TRIM(A.NOTAS), A.KDHUBKEL, A.TGLKLAIM, TMT_EFEKTIF, JENISHIT, TIPEHIT, TMT_AKHIR, KDJIWA, A.KDJNSPENSIUN, A.KDKELOMPOK, TRIM(A.KDPANGKAT), A.MASKER, KD_UKP, KDTP, A.KDSIFATPOK, PENS_POKOK, KDHIT, POTKPKN, POTKASDA, SEWARMH, TUNJ_TEWAS, TUNJ_CACAT, KOND_DAPEM, TMT_PENPOK, KOND_BERAS, A.UPDSTAMP, A.INPUTER FROM MIG_ACB.WORK_HUTANG  A INNER JOIN TASPEN.KLAIM_HUTANG AS B ON A.TGLKLAIM = B.TGLKLAIM AND A.KDHUBKEL=B.KDHUBKEL AND   TRIM(A.NOTAS) = B.NOTAS;
INSERT INTO TASPEN.WORK_HUTANG_DETAIL(NOTAS, KDHUBKEL, TGLKLAIM, JENISHIT, TGLPROSES, KDTRANS, NILAI, UPDSTAMP, INPUTER) SELECT TRIM(A.NOTAS), A.KDHUBKEL, A.TGLKLAIM, JENISHIT, TGLPROSES, KDTRANS, NILAI, A.UPDSTAMP, A.INPUTER FROM MIG_ACB.WORK_HUTANG_DETAIL AS A INNER JOIN TASPEN.KLAIM_HUTANG B ON A.TGLKLAIM=B.TGLKLAIM AND A.KDHUBKEL=B.KDHUBKEL AND TRIM(A.NOTAS) = B.NOTAS;
INSERT INTO TASPEN.MASTER_IURAN (BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, KDPRODUK, KDTABEL, IURAN, STATUS, NOVOUCHER, KELSSBP, KDSSBP, KDSATKER, NOSAP, INPUTER, UPDSTAMP, KDSTAPEG) SELECT DISTINCT BLTHGAJI, TRIM(NOTAS), KDCABANG, JNSGAJI, 7 KDPRODUK, 4 KDTABEL, IUR_JKK IURAN,     STATUS, NULL NOVOUCHER, KELSSBP, KDSSBP, NULL KDSATKER, NULL NOSAP, 'MIGRASI NCB1'  INPUTER, CURRENT_TIMESTAMP UPDSTAMP,NULL KDSTAPEG FROM MIG_ACB.UTANG_JKK; 
INSERT INTO TASPEN.MASTER_IURAN (BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, KDPRODUK, KDTABEL, IURAN, STATUS, NOVOUCHER, KELSSBP, KDSSBP, KDSATKER, NOSAP, INPUTER, UPDSTAMP, KDSTAPEG) SELECT DISTINCT BLTHGAJI, TRIM(NOTAS), KDCABANG, JNSGAJI, 8 KDPRODUK, 4 KDTABEL, IUR_JKM IURAN,     STATUS, NULL NOVOUCHER, KELSSBP, KDSSBP, NULL KDSATKER, NULL NOSAP, 'MIGRASI NCB2'  INPUTER, CURRENT_TIMESTAMP UPDSTAMP,NULL KDSTAPEG FROM MIG_ACB.UTANG_JKK ; 
INSERT INTO TASPEN.MASTER_IURAN (BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, KDPRODUK, KDTABEL, IURAN, STATUS, NOVOUCHER, KELSSBP, KDSSBP, KDSATKER, NOSAP, INPUTER, UPDSTAMP, KDSTAPEG) SELECT DISTINCT BLTHGAJI, TRIM(NOTAS), KDCABANG, JNSGAJI, 4 KDPRODUK, 3 KDTABEL, IUR_PENS IURAN,    STATUS, NULL NOVOUCHER, KELSSBP, KDSSBP, NULL KDSATKER, NULL NOSAP, 'MIGRASI NCB3'  INPUTER, CURRENT_TIMESTAMP UPDSTAMP,NULL KDSTAPEG FROM MIG_ACB.UTANG_IWP;
INSERT INTO TASPEN.MASTER_IURAN (BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, KDPRODUK, KDTABEL, IURAN, STATUS, NOVOUCHER, KELSSBP, KDSSBP, KDSATKER, NOSAP, INPUTER, UPDSTAMP, KDSTAPEG) SELECT DISTINCT BLTHGAJI, TRIM(NOTAS), KDCABANG, JNSGAJI, 1 KDPRODUK, 3 KDTABEL, IUR_THT IURAN,     STATUS, NULL NOVOUCHER, KELSSBP, KDSSBP, NULL KDSATKER, NULL NOSAP, 'MIGRASI NCB4'  INPUTER, CURRENT_TIMESTAMP UPDSTAMP,NULL KDSTAPEG FROM MIG_ACB.UTANG_IWP;
INSERT INTO TASPEN.MASTER_IURAN (BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, KDPRODUK, KDTABEL, IURAN, STATUS, NOVOUCHER, KELSSBP, KDSSBP, KDSATKER, NOSAP, INPUTER, UPDSTAMP, KDSTAPEG) SELECT          BLTHGAJI, TRIM(NOTAS), KDCABANG, JNSGAJI, 7 KDPRODUK, 2 KDTABEL, IUR_JKK IURAN,     STATUS, NULL NOVOUCHER, KELSSBP, KDSSBP, NULL KDSATKER, NULL NOSAP, 'MIGRASI NCB5'  INPUTER, CURRENT_TIMESTAMP UPDSTAMP,NULL KDSTAPEG FROM MIG_ACB.KOREKSI_JKK A WHERE A.NOTAS IS NOT NULL AND NOT EXISTS (SELECT Z.NOTAS FROM (SELECT NOTAS,BLTHGAJI  FROM (  SELECT BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, 7 KDPRODUK, 2 KDTABEL, KELSSBP, KDSSBP ,COUNT(*)    FROM   MIG_ACB.KOREKSI_JKK  GROUP BY BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, 7, 2, KELSSBP, KDSSBP  HAVING COUNT(*) > 1)XX ) Z   WHERE   Z.NOTAS=A.NOTAS AND Z.BLTHGAJI=A.BLTHGAJI);
INSERT INTO TASPEN.MASTER_IURAN (BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, KDPRODUK, KDTABEL, IURAN, STATUS, NOVOUCHER, KELSSBP, KDSSBP, KDSATKER, NOSAP, INPUTER, UPDSTAMP, KDSTAPEG) SELECT DISTINCT BLTHGAJI, TRIM(NOTAS), KDCABANG, JNSGAJI, 8 KDPRODUK, 2 KDTABEL, IUR_JKM IURAN,     STATUS, NULL NOVOUCHER, KELSSBP, KDSSBP, NULL KDSATKER, NULL NOSAP, 'MIGRASI NCB6'  INPUTER, CURRENT_TIMESTAMP UPDSTAMP,NULL KDSTAPEG FROM MIG_ACB.KOREKSI_JKK A WHERE A.NOTAS IS NOT NULL AND NOT EXISTS (SELECT Z.NOTAS FROM (SELECT NOTAS,BLTHGAJI FROM (SELECT  BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, 8 KDPRODUK, 2 KDTABEL, KELSSBP, KDSSBP,COUNT(*) FROM MIG_ACB.KOREKSI_JKK GROUP BY BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, 8, 2, KELSSBP, KDSSBP HAVING COUNT(*) > 1)XX) Z WHERE Z.NOTAS=A.NOTAS AND Z.BLTHGAJI=A.BLTHGAJI);
INSERT INTO TASPEN.MASTER_IURAN (BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, KDPRODUK, KDTABEL, IURAN, STATUS, NOVOUCHER, KELSSBP, KDSSBP, KDSATKER, NOSAP, INPUTER, UPDSTAMP, KDSTAPEG) SELECT DISTINCT BLTHGAJI, TRIM(NOTAS), KDCABANG, JNSGAJI, 4 KDPRODUK, 1 KDTABEL, IUR_PENS IURAN,    STATUS, NULL NOVOUCHER, KELSSBP, KDSSBP, NULL KDSATKER, NULL NOSAP, 'MIGRASI NCB7'  INPUTER, CURRENT_TIMESTAMP UPDSTAMP,NULL KDSTAPEG FROM MIG_ACB.KOREKSI_IWP A WHERE NOT EXISTS (SELECT Z.NOTAS FROM (SELECT NOTAS,BLTHGAJI FROM (SELECT  BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, 4 KDPRODUK, 1 KDTABEL, KELSSBP, KDSSBP,COUNT(*) FROM MIG_ACB.KOREKSI_IWP GROUP BY BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, 4, 1, KELSSBP, KDSSBP HAVING COUNT(*) > 1)XX) Z WHERE Z.NOTAS=A.NOTAS AND Z.BLTHGAJI=A.BLTHGAJI);
INSERT INTO TASPEN.MASTER_IURAN (BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, KDPRODUK, KDTABEL, IURAN, STATUS, NOVOUCHER, KELSSBP, KDSSBP, KDSATKER, NOSAP, INPUTER, UPDSTAMP, KDSTAPEG) SELECT DISTINCT BLTHGAJI, TRIM(NOTAS), KDCABANG, JNSGAJI, 1 KDPRODUK, 1 KDTABEL, IUR_THT IURAN,     STATUS, NULL NOVOUCHER, KELSSBP, KDSSBP, NULL KDSATKER, NULL NOSAP, 'MIGRASI NCB8'  INPUTER, CURRENT_TIMESTAMP UPDSTAMP,NULL KDSTAPEG FROM MIG_ACB.KOREKSI_IWP A WHERE NOT EXISTS (SELECT Z.NOTAS FROM (SELECT NOTAS,BLTHGAJI FROM (SELECT  BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, 1 KDPRODUK, 1 KDTABEL, KELSSBP, KDSSBP,COUNT(*) FROM MIG_ACB.KOREKSI_IWP GROUP BY BLTHGAJI, NOTAS, KDCABANG, JNSGAJI, 1, 1, KELSSBP, KDSSBP HAVING COUNT(*) > 1)XX) Z WHERE Z.NOTAS=A.NOTAS AND Z.BLTHGAJI=A.BLTHGAJI);




INSERT INTO TASPEN.KELUARGA(KDHUBKEL, NOTAS, NMKEL, JNSKEL, TGLLHR, TGLWAFAT, KDTUNJANG, TMT_TUNJANG, TAT_TUNJANG, GLRDEPAN, GLRAKHIR, HAKBAGI_PENSIUN, KTPNO, KDDOKUMEN, KDAGAMA, KDSTAWIN, UPDSTAMP, CATAT, INPUTER,NPWP)  SELECT TRIM(A.KDHUBKEL),TRIM(TRAILING ' ' FROM A.NOTAS),REPLACE(REPLACE(TRIM(CHAR(160) FROM A.NMKEL),'\t',''),'\n','') NAMA, CASE WHEN A.JENKEL NOT IN(1,2) THEN 1 ELSE A.JENKEL END JNSKEL, A.TGLLHR, A.TGLWAFAT, A.KDTUNJANG, A.TMT_TUNJANG, A.TAT_TUNJANG, REPLACE(REPLACE(REPLACE(A.GLRDEPAN,CHAR(160),''),'\t',''),'\n','') GLRDEPAN, REPLACE(REPLACE(REPLACE(A.GLRAKHIR,CHAR(160),''),'\t',''),'\n','') GLRAKHIR, A.HAKBAGI_PENSIUN, A.KTPNO, A.KDDOKUMEN, A.KDAGAMA, A.KDSTAWIN, A.UPDSTAMP, A.CATAT, A.INPUTER,NULL FROM MIG_ACB.KELUARGA A;
INSERT INTO TASPEN.PENERIMA_SK(KDHUBKEL, NOTAS, TMT_PENSIUN, ISLOCK, KDSIFATPOK, KDJNSPENSIUN, KDJIWA, TMT_STOP, KDSTOP, NIPPA, KDPANGKAT, KDKELOMPOK, KDPRODUK, NMKEL, TGLLHR, TGLSKEP, NOSKEP, KDPENSKEP, TMTSKEP, KDTP, UPDSTAMP, INPUTER, KDHUBKELWALI, NMKELWALI, TGLLHRWALI, KDSTSWALI, NOMOR_PIAGAM, TANGGAL_PIAGAM, PENERBIT_PIAGAM) SELECT A.KDHUBKEL, TRIM(A.NOTAS), TMT_PENSIUN, ISLOCK, KDSIFATPOK, KDJNSPENSIUN, KDJIWA, TMT_STOP, KDSTOP, NIPPA, TRIM(KDPANG), KDKELOM, KDPRODU, NMKELA, TGLLHRA, TGLSKEPA, NOSKEPA, KDPENSKEPA, TMTSKEPA, KDTP, A.UPDSTAMP, A.INPUTER, KDHUBKELWALI, NMKELWALI, TGLLHRWALI, KDSTSWALI, NULL,NULL,NULL FROM MIG_ACB.PENERIMA_SK A INNER JOIN TASPEN.KELUARGA B ON TRIM(A.NOTAS) = B.NOTAS AND A.KDHUBKEL = B.KDHUBKEL;
INSERT INTO TASPEN.TRANS_ASURANSI(KDTRANS, TMT_TRANS, TGLKLAIM, KDHUBKEL, NOTAS, NILAI, KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, UPDSTAMP, KDCABANG, INPUTER) SELECT KDTRANS, TMT_TRANS, TGLKLAIM, A.KDHUBKEL, TRIM(A.NOTAS), NILAI, KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, A.UPDSTAMP, KDCABANG, A.INPUTER FROM MIG_ACB.TRANS_ASURANSI A INNER JOIN TASPEN.KELUARGA B ON TRIM(A.NOTAS) = B.NOTAS AND A.KDHUBKEL = B.KDHUBKEL;
INSERT INTO TASPEN.GAJI_RAPEL(NIP, NAMA, TGLAHIR, KDSEX, ISTRI, ANAK, KDGOL, GAPOK, IURAN_JKK, IURAN_JKM, IURAN_THT, IURAN_PENS, JMLBULAN, TMT_RAPEL, TAT_RAPEL, BLTHGAJI, JNSGAJI, KODESATKER, KDSSBP, KELSSBP, KDCABANG, FILLER, KDDATI1, KDDATI2, KDKELOMPOK, KDSTAPEG, KDDUDUKAN, INPUTER, TUNJ_ISTRI, TUNJ_ANAK, TPP, TUNJ_ESELON, TUNJ_FUNGSIONAL, TUNJ_GURU, TUNJ_LANGKA, TKD, TUNJ_TERPENCIL, TUNJ_KHUSUS, TUNJ_PAJAK, TUNJ_ASKES, TUNJ_BERAS, TUNJ_UMUM, PEMBULATAN, PENGHASILAN_KOTOR, JMLBERSIH, POT_IWP, PERSENGAPOK, KD_ESELON, KD_FUNGSIONAL, KDGURU, TMT_BERLAKU) SELECT NIP, NAMA, TGLAHIR, KDSEX, ISTRI, ANAK, KDGOL, GAPOK, IURAN_JKK, IURAN_JKM, IURAN_THT, IURAN_PENS, JMLBULAN, TMT_RAPEL, TAT_RAPEL, BLTHGAJI, JNSGAJI, KODESATKER, KDSSBP, KELSSBP, A.KDCABANG, FILLER, A.KDDATI1, A.KDDATI2, KDKELOMPOK, KDSTAPEG, KDDUDUKAN, A.INPUTER, TUNJ_ISTRI, TUNJ_ANAK, TPP, TUNJ_ESELON, TUNJ_FUNGSIONAL, TUNJ_GURU, TUNJ_LANGKA, TKD, TUNJ_TERPENCIL, TUNJ_KHUSUS, TUNJ_PAJAK, TUNJ_ASKES, TUNJ_BERAS, TUNJ_UMUM, PEMBULATAN, PENGHASILAN_KOTOR, JMLBERSIH, POT_IWP, PERSENGAPOK, KD_ESELON, KD_FUNGSIONAL, KDGURU, TMT_BERLAKU FROM MIG_ACB.GAJIRAPEL A INNER JOIN TASPEN.REF_CABANG B ON A.KDCABANG = B.KDCABANG;
INSERT INTO TASPEN.TRS_HTG_SKPP(KDHUBKEL, NOTAS, KDCABANG, JMLHUTANG, KDHUTANG, KETERANGAN, UPDSTAMP, INPUTER) SELECT A.KDHUBKEL, TRIM(A.NOTAS), A.KDCABANG, A.JMLHUTANG, A.KDHUTANG, A.KETERANGAN, A.UPDSTAMP, A.INPUTER FROM MIG_ACB.HUTANG_SKPP A INNER JOIN TASPEN.KELUARGA B ON TRIM(A.NOTAS) = B.NOTAS AND A.KDHUBKEL = B.KDHUBKEL;
INSERT INTO TASPEN.MEDICAL_HIST(NOTAS, KDHUBKEL, TGLLHR, NAMA_KLINIK, NAMA_DOKTER_BIDAN, NOSRT_MEDIC, TGLSRT_MEDIC, INPUTER, UPDSTAMP) SELECT TRIM(A.NOTAS), A.KDHUBKEL, A.TGLLHR, NAMA_KLINIK, NAMA_DOKTER_BIDAN, NOSRT_MEDIC, TGLSRT_MEDIC, A.INPUTER, A.UPDSTAMP FROM MIG_ACB.MEDICAL_HIST A INNER JOIN TASPEN.KELUARGA B ON TRIM(A.NOTAS) = B.NOTAS AND A.KDHUBKEL = B.KDHUBKEL;
INSERT INTO TASPEN.SKS_HIST(TMT_SKS, KDHUBKEL, NOTAS, TAT_SKS, NOSURAT, NMSEKOLAH, TGLSURAT, UPDSTAMP, INPUTER, KDPT, KDPRODI, NIM) SELECT TMT_SKS, A.KDHUBKEL, TRIM(A.NOTAS), TAT_SKS, NOSURAT, NMSEKOLAH, TGLSURAT, A.UPDSTAMP, A.INPUTER, NULL,NULL,NULL FROM MIG_ACB.SKS_HIST A INNER JOIN TASPEN.KELUARGA B ON TRIM(A.NOTAS) = B.NOTAS AND A.KDHUBKEL = B.KDHUBKEL;
INSERT INTO TASPEN.KLAIM_PENS13(TGLKLAIM, KDHUBKEL,NOTAS, KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, FLOW_STS, BMS, NOANTRI, KDCABANG, LANGSUNG, NOVOUCHER_PENS, TGLTERIMA_PENS, TGLRENBAYAR, BANKGRP, BANKNAMA, BANKACCT, NMPENERIMA, ALM_KLIMPENS, KDDATI1, KDDATI2, KDDATI3, KDDATI4, KODEPOS, TELEPON, NOKTP, NOREK, MASKER, JMLANAK, TMT_PENPOK, KDJNSPENERIMA, KDPANGKAT, KDSIFATPOK, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KEBERAPA, KDJNSPENSIUN, KDVOUCHER, KDDANA, TMT_RAPEL, TAT_RAPEL, TGLLHR_PENERIMA, JENKEL_PENERIMA, JMLISTRI, KDHIT, PENPOK, TISTRI, TANAK, TP, TCACAT, TPAJAK, TTEWAS, TBULAT, KOTOR, PPAJAK, POTONGAN, BERSIH, NEWTGLKLAIM, STATUS, NEWTGLPOSTING, NOCEKPOS, KDCEKPOS, UPDSTAMP, INPUTER)  SELECT TGLKLAIM, KDHUBKEL, TRIM(NOTAS), KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, FLOW_STS, BMS, NOANTRI, A.KDCABANG, LANGSUNG, NOVOUCHER_PENS, TGLTERIMA_PENS, TGLRENBAYAR, BANKGRP, BANKNAMA, BANKACCT, NMPENERIMA, ALM_KLIMPENS, A.KDDATI1, A.KDDATI2, A.KDDATI3, A.KDDATI4, A.KODEPOS, A.TELEPON, NOKTP, NOREK, MASKER, JMLANAK, TMT_PENPOK, KDJNSPENERIMA, KDPANGKAT, KDSIFATPOK, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KEBERAPA, KDJNSPENSIUN, KDVOUCHER, KDDANA, TMT_RAPEL, TAT_RAPEL, TGLLHR_PENERIMA, JENKEL_PENERIMA, JMLISTRI, KDHIT, PENPOK, TISTRI, TANAK, TP, TCACAT, TPAJAK, TTEWAS, TBULAT, KOTOR, PPAJAK, POTONGAN, BERSIH, NEWTGLKLAIM, STATUS, NEWTGLPOSTING, NOCEKPOS, KDCEKPOS, A.UPDSTAMP, A.INPUTER FROM MIG_ACB.KLAIM_PENS13 A INNER JOIN TASPEN.REF_CABANG B ON A.KDCABANG = B.KDCABANG;



INSERT INTO TASPEN.TMT_PENPOK_HIST(TMT_PENPOK, KDHUBKEL, NOTAS, KDJNSPENERIMA, JMLANAK, PENPOK, INPUTER, UPDSTAMP) SELECT TMT_PENPOK, A.KDHUBKEL, TRIM(A.NOTAS), KDJNSPENERIMA, JMLANAK, PENPOK,'MIGRASI NCB',CURRENT_DATE FROM MIG_ACB.TMT_PENPOK_HIST A INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(A.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(A.NOTAS) = TRIM(B.NOTAS);
INSERT INTO TASPEN.KTRBYR_HIST(TMT_KTRBYR, KDHUBKEL, NOTAS, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NORUT_DAPEM, NOREK, UPDSTAMP, INPUTER) SELECT TMT_KTRBYR, A.KDHUBKEL, TRIM(A.NOTAS), KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NORUT_DAPEM, NOREKA, A.UPDSTAMP, A.INPUTER FROM MIG_ACB.KTRBYR_HIST A INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(A.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(A.NOTAS) = TRIM(B.NOTAS);
INSERT INTO TASPEN.KTRBYR_HIST_JKK(TMT_KTRBYR, KDHUBKEL, NOTAS, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, NOREK, KDLAYANAN, UPDSTAMP, INPUTER) SELECT TMT_KTRBYR, A.KDHUBKEL, TRIM(A.NOTAS), KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, A.KDCABANG, NOREKA, KDLAYANAN , A.UPDSTAMP, A.INPUTER FROM MIG_ACB.KTRBYR_HIST_JKK A INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(A.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(A.NOTAS) = TRIM(B.NOTAS);
INSERT INTO TASPEN.PENPOK_HIST(MASKER, JMLANAK, TMT_PENPOK, TMT_EFEKTIF, KDJNSPENERIMA, KDPANGKAT, KDKELOMPOK, KDPRODUK, KDJNSTRANS, KDSIFATPOK, KDHUBKEL, NOTAS, TGLKLAIM, KDJIWA, PCT_PENPOK, PENPOK, JMLISTRI, GAPOK, TMT_AKHIR, UPDSTAMP, INPUTER, TCACAT, TDAHOR) SELECT MASKER, JMLANAK, TMT_PENPOK, TMT_EFEKTIF, KDJNSPENERIMA, TRIM(A.KDPANGKAT), A.KDKELOMPOK, A.KDPRODUK, A.KDJNSTRANS, A.KDSIFATPOK, A.KDHUBKEL, TRIM(A.NOTAS), TGLKLAIM, A.KDJIWA, A.PCT_PENPOK, PENPOK, JMLISTRI, GAPOK, TMT_AKHIR, A.UPDSTAMP, A.INPUTER,NULL,NULL FROM MIG_ACB.PENPOK_HIST AS A INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(A.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(A.NOTAS) = TRIM(B.NOTAS);
INSERT INTO TASPEN.SPTB_HIST(TGLPROSES, KDHUBKEL, NOTAS, TGLSPTB, TGLKEMBALI, JMLCETAK, KDRETSPTB, KDCABANG, UPDSTAMP, INPUTER, JNS_SPTB, TGLNIKAH, TGLWAFAT, KDLKN, KDSTOP, BLTH, KETERANGAN, RUPIAH, TGLLKN, KETLKN, INPUTEROTS) SELECT TGLPROSES, A.KDHUBKEL, TRIM(A.NOTAS), TGLSPTB, TGLKEMBALI, JMLCETAK, KDRETSPTB, A.KDCABANG, A.UPDSTAMP, A.INPUTER, JNS_SPTB, TGL_NIKAH, TGL_WAFAT, KD_LKN, KD_STOP, BLTH, KETERANGAN, RUPIAH, TGL_LKN, KET_LKN, INPUTEROTS FROM MIG_ACB.SPTB_HIST A INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(A.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(A.NOTAS) = TRIM(B.NOTAS);
INSERT INTO TASPEN.TANDAJASA_HIST(TGLWAFAT, KDKELOMPOK, KDHUBKEL, NOTAS, KDTNDJASA, TERUSAN, KDSTOP, TMT_STOP, INPUTER, UPDSTAMP, TMT_TNDJASA, TGLSURAT, NOSURAT, PENERBIT_SURAT, NOPB, TGLPB) SELECT MIG_ACB.TANDAJASA_HIST.TGL_WAFAT, MIG_ACB.TANDAJASA_HIST.KDKELOMPOK, MIG_ACB.TANDAJASA_HIST.KDHUBKEL, trim(MIG_ACB.TANDAJASA_HIST.NOTAS), MIG_ACB.TANDAJASA_HIST.KDTNDJASA, MIG_ACB.TANDAJASA_HIST.TERUSAN, MIG_ACB.TANDAJASA_HIST.KDSTOP, MIG_ACB.TANDAJASA_HIST.TMT_STOP, MIG_ACB.TANDAJASA_HIST.INPUTER, MIG_ACB.TANDAJASA_HIST.UPDSTAMP, MIG_ACB.TANDAJASA_HIST.TMT_TNDJASA, MIG_ACB.TANDAJASA_HIST.TGL_SURAT, MIG_ACB.TANDAJASA_HIST.NO_SURAT, MIG_ACB.TANDAJASA_HIST.PENERBIT_SURAT, MIG_ACB.TANDAJASA_HIST.NO_PB, MIG_ACB.TANDAJASA_HIST.TGL_PB FROM MIG_ACB.TANDAJASA_HIST INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(TANDAJASA_HIST.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(TANDAJASA_HIST.NOTAS) = TRIM(B.NOTAS);
INSERT INTO TASPEN.TRS_HTG_TERLANJUR(NOTAS, KDHUBKEL, HUTANG, KDTRANS, KDJNSPENSIUN, POTKPKN_DIPOTONG, POTKPKN, POTKASDA_DIPOTONG, POTKASDA, SEWARMH_DIPOTONG, SEWARMH, TGLPROSES, FLOW_STS, KDCABANG, TGLKLAIM) SELECT TRIM(A.NOTAS), A.KDHUBKEL, A.HUTANG, A.KDTRANS, A.KDJNSPENSIUN, A.POTKPKN_DIPOTONG, POTKPKN, POTKASDA_DIPOTONG, POTKASDA, SEWARMH_DIPOTONG, SEWARMH, TGLPROSES, FLOW_STS, A.KDCABANG, TGLKLAIM FROM MIG_ACB.HUTANG_TERLANJUR A INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(A.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(A.NOTAS) = TRIM(B.NOTAS);
INSERT INTO TASPEN.HITUNG_HIST(TMT_HITUNG, KDHUBKEL, NOTAS, KDHIT, KETERANGAN, UPDSTAMP, INPUTER) SELECT A.TMTHIT, A.KDHUBKEL, TRIM(A.NOTAS), A.KDHIT, A.KETERANGAN, A.UPDSTAMP, A.INPUTER FROM MIG_ACB.HITUNG_HIST A INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(A.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(A.NOTAS) = TRIM(B.NOTAS);

-- DATA DOUBLE
INSERT INTO TASPEN.TRANS_KI_PI(NOTAS, KDPRODUK, JNS_TRANS_KIPI, NOVOUCHER, TGL_TRANSAKSI, NILAI, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDPRODUK, JENIS_TRANS_KIPI, NOVOUCHER, TGL_TRANSAKSI, NILAI, UPDSTAMP, INPUTER FROM(SELECT NOTAS, KDPRODUK, JENIS_TRANS_KIPI, NOVOUCHER, TGL_TRANSAKSI, NILAI, UPDSTAMP, INPUTER,ROW_NUMBER() OVER(PARTITION BY TRIM(NOTAS), KDPRODUK, JENIS_TRANS_KIPI ORDER BY UPDSTAMP DESC) AS RN  FROM MIG_ACB.TRANS_KI_PI)WHERE RN=1;
INSERT INTO TASPEN.UMUM_SKEP(NOTAS, KDHUBKEL, NAMA, TGLLHR, NIPPA, KDJNSPENERIMA, KDSURAT, STATUS_SK, PENERBIT_SKEP, NOMOR_SKEP, TANGGAL_SKEP, TMT_PENSIUN, ALAMAT, STATUS_KLIM, TGLTERIMA, KDCABANG, NOMOR_AGENDA, TGLSERAH, PENPOK, BARCODE, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, NMKELA, TGLLHRA, NIPPA, KDJNSPENERIMA, KDSURAT, STATUS_SK, PENERBIT_SKEP, NOMOR_SKEP, TANGGAL_SKEP, TMT_PENSIUN, ALAMAT, STATUS_KLIM, TGLTERIMA, KDCABANG, NOMORAGENDA, TGLSERAH, PENPOK, BARCODE, UPDSTAMP, INPUTER FROM(SELECT NOTAS, KDHUBKEL, NMKELA, TGLLHRA, NIPPA, KDJNSPENERIMA, KDSURAT, STATUS_SK, PENERBIT_SKEP, NOMOR_SKEP, TANGGAL_SKEP, TMT_PENSIUN, ALAMAT, STATUS_KLIM, TGLTERIMA, KDCABANG, NOMORAGENDA, TGLSERAH, PENPOK, BARCODE, UPDSTAMP, INPUTER ,ROW_NUMBER() OVER(PARTITION BY TRIM(NOTAS), KDHUBKEL,KDSURAT ORDER BY UPDSTAMP DESC) AS RN FROM MIG_ACB.UMUM_SKEP)WHERE RN =1;
INSERT INTO TASPEN.WORKFLOW_PROC(TGLKLAIM, KDHUBKEL, NOTAS, KDFLOW, TGLWORK, USERINP, KETERANGAN, UPDSTAMP, INPUTER) SELECT TGLKLAIM, KDHUBKEL, TRIM(NOTAS), KDFLOW, TGLWORK, USERINP, KETERANGAN, UPDSTAMP, INPUTER from(SELECT TGLKLAIM, KDHUBKEL, NOTAS, KDFLOW, TGLWORK, USERINP, KETERANGAN, UPDSTAMP, INPUTER,ROW_NUMBER() OVER(PARTITION BY TGLKLAIM, KDHUBKEL, TRIM(NOTAS), KDFLOW ORDER BY UPDSTAMP DESC) AS RN FROM MIG_ACB.WORKFLOW_PROC) where RN=1;
INSERT INTO TASPEN.PESERTA_DAHOR(NOTAS, KDHUBKEL, KDKELOMPOK, KDJNSPENSIUN, KDCABANG, KDPRODUK, NPV, TMT_PENSIUN, NOMOR_PENGESAHAN, TANGGAL_PENGESAHAN, PENERBIT_PENGESAHAN, NOMOR_PIAGAM, TANGGAL_PIAGAM, PENERBIT_PIAGAM, UPDSTAMP, INPUTER) SELECT TRIM(NOTAS), KDHUBKEL, KDKELOMPOK, KDJNSPENSIUN, KDCABANG, KDPRODUK, NPV, TMT_PENSIUN, NOMOR_PENGESAHAN, TANGGAL_PENGESAHAN, PENERBIT_PENGESAHAN, NOMOR_PIAGAM, TANGGAL_PIAGAM, PENERBIT_PIAGAM, UPDSTAMP, INPUTER FROM (SELECT NOTAS, KDHUBKEL, KDKELOMPOK, KDJNSPENSIUN, KDCABANG, KDPRODUK, NPV, TMT_PENSIUN, NOMOR_PENGESAHAN, TANGGAL_PENGESAHAN, PENERBIT_PENGESAHAN, NOMOR_PIAGAM, TANGGAL_PIAGAM, PENERBIT_PIAGAM, UPDSTAMP, INPUTER ,ROW_NUMBER() OVER(PARTITION BY TRIM(NOTAS), KDHUBKEL, KDKELOMPOK, KDJNSPENSIUN, KDCABANG, KDPRODUK ORDER BY UPDSTAMP DESC) AS RN FROM MIG_ACB.PESERTA_DAHOR) WHERE RN=1;
INSERT INTO TASPEN.KARTU_HIST(KDPRODUK, KDHUBKEL, NOTAS, TMTKARTU, KETERANGAN, STATUS, UPDSTAMP, INPUTER, STS_CETAK) SELECT KDPRODUK, KDHUBKEL, TRIM(NOTAS), TMTKARTU, KETERANGAN, STATUS, UPDSTAMP, INPUTER,STS_CETAK FROM (SELECT KDPRODUK, KDHUBKEL, NOTAS, TMTKARTU, KETERANGAN, STATUS, UPDSTAMP, INPUTER,TRUE STS_CETAK ,ROW_NUMBER() OVER(PARTITION BY KDPRODUK, KDHUBKEL, TRIM(NOTAS), TMTKARTU ORDER BY UPDSTAMP DESC) AS RN FROM MIG_ACB.KARTU_HIST) WHERE RN=1;
INSERT INTO TASPEN.REKAP_REKPASIF(KDCABANG, TGLKEGIATAN, CALON_STOP, RP_CALON, AKTIF, RP_AKTIF, STOP, RP_STOP, INPUTER, TGLAPPROVAL, TGLSTOP, TGLDAPEM, UPDSTAMP) SELECT KDCABANG, TGLKEGIATAN, CALON_STOP, RP_CALON, AKTIF, RP_AKTIF, STOP, RP_STOP, INPUTER, TGLAPPROVAL, TGLSTOP, TGLDAPEM,UPDSTAMP FROM(SELECT KDCABANG, TGLKEGIATAN, CALON_STOP, RP_CALON, AKTIF, RP_AKTIF, STOP, RP_STOP, INPUTER, TGLAPPROVAL, TGLSTOP, TGLDAPEM,current_date AS UPDSTAMP, ROW_NUMBER() OVER(PARTITION BY TGLKEGIATAN,KDCABANG ORDER BY TGLKEGIATAN,TGLDAPEM DESC) AS RN FROM MIG_ACB.REKAPREKPASIF) WHERE RN =1;
insert into TASPEN.GAJIDO(KDCABANG, KODESATKER, NIP, NAMA, TGLAHIR, KDSEX, GAPOK, KDGOL, ISTRI, ANAK, BLTHGAJI, UPDSTAMP, KDDATI1, KDDATI2, FILLER, KDSSBP, KELSSBP, KDKELOMPOK, KDSTAPEG, KDDUDUKAN, INPUTER, JNSGAJI, TUNJ_ISTRI, TUNJ_ANAK, TPP, TUNJ_ESELON, TUNJ_FUNGSIONAL, TUNJ_GURU, TUNJ_LANGKA, TKD, TUNJ_TERPENCIL, TUNJ_KHUSUS, TUNJ_PAJAK, TUNJ_ASKES, TUNJ_BERAS, TUNJ_UMUM, PEMBULATAN, PENGHASILAN_KOTOR, JMLBERSIH, POT_IWP, PERSENGAPOK, IURAN_JKK, IURAN_JKM, KD_ESELON, KD_FUNGSIONAL, KDGURU, TMT_BERLAKU, TMTRAPEL, TATRAPEL, NILAI_RAPEL, KET_RAPEL, IURAN_RAPEL, NIK, NPWP, NOREK, NAMA_BANK, NOHP, EMAIL, TUNJANGAN_KINERJA, IURAN_THT_BATCHGAJI, IURAN_PENS_BATCHGAJI, IURAN_JKK_BATCHGAJI, IURAN_JKM_BATCHGAJI, NILAI_THP_BATCHGAJI) SELECT KDCABANG, KODESATKER, NIP, NAMA, TGLAHIR, KDSEX, GAPOK, KDGOL, ISTRI, ANAK, BLTHGAJI, UPDSTAMP, KDDATI1, KDDATI2, FILLER, KDSSBP, KELSSBP, KDKELOMPOK, KDSTAPEG, KDDUDUKAN, INPUTER, KDJNSTRANS, TUNJ_ISTRI, TUNJ_ANAK, TPP, TUNJ_ESELON, TUNJ_FUNGSIONAL, TUNJ_GURU, TUNJ_LANGKA, TKD, TUNJ_TERPENCIL, TUNJ_KHUSUS, TUNJ_PAJAK, TUNJ_ASKES, TUNJ_BERAS, TUNJ_UMUM, PEMBULATAN, PENGHASILAN_KOTOR, JMLBERSIH, POT_IWP, PERSENGAPOK, IURAN_JKK, IURAN_JKM, KD_ESELON, KD_FUNGSIONAL, KDGURU, TMT_BERLAKU, TMTRAPEL, TATRAPEL, NILAI_RAPEL, KET_RAPEL, IURAN_RAPEL, NIK, NPWP, NOREK, NAMA_BANK, NOHP, EMAIL, TUNJANGAN_KINERJA,NULL,NULL,NULL,NULL,NULL from (SELECT A.KDCABANG, KODESATKER, NIP, NAMA, TGLAHIR, KDSEX, GAPOK, KDGOL, ISTRI, ANAK, BLTHGAJI, A.UPDSTAMP, A.KDDATI1, A.KDDATI2, FILLER, KDSSBP, KELSSBP, KDKELOMPOK, KDSTAPEG, KDDUDUKAN, A.INPUTER, KDJNSTRANS, TUNJ_ISTRI, TUNJ_ANAK, TPP, TUNJ_ESELON, TUNJ_FUNGSIONAL, TUNJ_GURU, TUNJ_LANGKA, TKD, TUNJ_TERPENCIL, TUNJ_KHUSUS, TUNJ_PAJAK, TUNJ_ASKES, TUNJ_BERAS, TUNJ_UMUM, PEMBULATAN, PENGHASILAN_KOTOR, JMLBERSIH, POT_IWP, PERSENGAPOK, IURAN_JKK, IURAN_JKM, KD_ESELON, KD_FUNGSIONAL, KDGURU, TMT_BERLAKU, TMTRAPEL, TATRAPEL, NILAI_RAPEL, KET_RAPEL, IURAN_RAPEL, NIK, A.NPWP, NOREK, NAMA_BANK, NOHP, EMAIL, TUNJANGAN_KINERJA,ROW_NUMBER()OVER (PARTITION BY NIP,KELSSBP,KDSSBP,A.KDCABANG ORDER BY A.UPDSTAMP DESC) AS RN FROM MIG_ACB.GAJIDO as A INNER JOIN TASPEN.REF_CABANG AS B ON A.KDCABANG=B.KDCABANG) where RN =1;
INSERT INTO TASPEN.ALAMAT_HIST(TMT_ALM, KDHUBKEL, NOTAS, ALAMAT, KOTA, KDPOS, TELEPON, KDDATI1, KDDATI2, KDDATI3, KDDATI4, NOHP, "EMAIL", UPDSTAMP, INPUTER) SELECT A.TMT_ALM, A.KDHUBKEL, A.NOTAS, A.ALM_PESERTA, A.KOTA, A.KODEPOS, A.TELEPON, A.KDDATI1, A.KDDATI2, A.KDDATI3, A.KDDATI4,  A.NOHP, "EMAIL",A.UPDSTAMP, A.INPUTER FROM MIG_ACB.ALAMAT_HIST A INNER JOIN TASPEN.KELUARGA B ON TRIM(A.NOTAS) = B.NOTAS AND A.KDHUBKEL = B.KDHUBKEL;
INSERT INTO TASPEN.TRANS_PENSIUN(KDHUBKEL, NOTAS, TGLPROSES, TGLKLAIM, TMT_TRANS, KDTRANS, NILAI, KDKLAIM, KDJNSTRANS, KDPRODUK, KDKELOMPOK, UPDSTAMP, INPUTER) SELECT A.KDHUBKEL, TRIM(A.NOTAS), TGLPROSES, TGLKLAIM, TMT_TRANS, KDTRANS, NILAI, KDKLAIM, KDJNSTRANS, A.KDPRODUK, A.KDKELOMPOK, A.UPDSTAMP, A.INPUTER  FROM MIG_ACB.TRANS_PENSIUN A INNER JOIN TASPEN.PENERIMA_SK  AS B ON TRIM(A.KDHUBKEL) = TRIM(B.KDHUBKEL) AND TRIM(A.NOTAS) = TRIM(B.NOTAS) WHERE NOT EXISTS (SELECT * FROM TASPEN.TRANS_PENSIUN AS C WHERE  A.KDHUBKEL=C.KDHUBKEL AND TRIM(A.NOTAS)=C.NOTAS AND A.TGLPROSES=C.TGLPROSES AND A.TGLKLAIM=C.TGLKLAIM AND A.TMT_TRANS=C.TMT_TRANS AND A.KDTRANS=C.KDTRANS AND A.KDKLAIM=C.KDKLAIM AND A.KDJNSTRANS=C.KDJNSTRANS AND A.KDPRODUK=C.KDPRODUK AND A.KDKELOMPOK=C.KDKELOMPOK) ;


INSERT INTO TASPEN.PESERTA
SELECT  A.KDHUBKEL,  A.NOTAS,  A.NIP,  A.NO_KPE,  A.NAMA,  A.JNSKEL,  A.TGLLHR,  A.TMT_KERJA,  A.TMT_TASPEN,  A.TGLWAFAT,  A.TGLPMK,  COALESCE(A.KDKELOMPOK,22) KDKELOMPOK,  COALESCE(A.KDJNSPEG,'99') KDJENPEG,  COALESCE(A.KDPANGKAT,'VA') KDPANGKAT,  COALESCE(A.MASKER,0) MASKER,  COALESCE(A.KDKEDUDUKAN,999) KDKEDUDUKAN,  A.BUP,  COALESCE(A.GAPOK,0) GAPOK,  COALESCE(A.GAPOK_97,0) GAPOK97,  COALESCE(A.KDSTAPEG,23) KDSTAPEG,  COALESCE(A.PERSENGAPOK,100) PERSENGAPOK,  A.TMT_GAPOK,  A.TMT_GAPOK_TBL,  A.KDJIWA_AKTIF,  A.NILAI_THP,  CASE  WHEN A.KDSTAPEG <= 20  AND   A.KDKELOMPOK IN (1,2,3,27) THEN  ROUND(A.GAPOK_97 +(A.GAPOK_97 * ISTRI * 0.10) +(GAPOK_97 * ANAK * 0.02),0)   ELSE ROUND(A.NILAI_THP_97,0)        END NILAI_THP_97,  A.BLTHGAJI,  A.KDREG,  A.TGLREG,  A.NOREG,  A.KDSATKER,  A.ALAMAT,  A.LOKASI_ALAMAT,  A.NOCROSSDEF,  A.JNSUZUR,  A.NIK,  A.NPWP,  COALESCE(A.KDDOKUMEN,0) KDDOKUMEN,  A.KETERANGAN,  A.KDCABANG,  COALESCE(A.INPUTER,'MIGRASI NCB') INPUTER,  A.UPDSTAMP,0 IURAN_THT,0 IURAN_PENSIUN,0 IURAN_JKK,0 IURAN_JKM,0 FLAG_IURAN,0 GAPOK_2015,0 NILAI_THP_2015
FROM 
	(
		SELECT  '00' KDHUBKEL, TRIM(TRAILING ' 'FROM A.NOTAS)NOTAS, A.NIP, A.NO_KPE, A.NAMA, A.JNSKEL, A.TGLLHR, A.TMT_KERJA, A.TMT_TASPEN, A.TGLWAFAT, A.TGLPMK, A.KDKELOMPOK, A.KDJNSPEG, A.KDPANGKAT, A.MASKER, A.KDKEDUDUKAN, A.BUP, A.GAPOK, 
		CASE  WHEN KDSTAPEG > 20 THEN (SELECT MAX(Z.GAPOK97) FROM  TASPEN.PERHITUNGAN_THT Z WHERE Z.NOTAS=A.NOTAS )   
		ELSE   (SELECT MIN(B.NILAI_BAWAH) FROM  MIG_ACB.GAPOK_TBL B WHERE B.TMT_GAPOK='1997-01-01'    AND B.KDPANGKAT=A.KDPANGKAT AND B.MASKER=A.MASKER )  END GAPOK_97,A.KDSTAPEG, A.PERSENGAPOK, A.TMT_GAPOK, (SELECT MAX(B.TMT_GAPOK) FROM  MIG_ACB.GAPOK_TBL B WHERE B.KDKELOMPOK=A.KDKELOMPOK) TMT_GAPOK_TBL, A.KDJIWA_AKTIF, A.NILAI_THP, 
		CASE  WHEN KDSTAPEG > 20 THEN (SELECT MAX(Z.THP2) FROM  TASPEN.PERHITUNGAN_THT Z WHERE Z.NOTAS=A.NOTAS  ) 
		ELSE 0    END NILAI_THP_97, A.BLTHGAJI, A.KDREG, A.TGLREG, A.NOREG, A.KDSATKER, A.ALAMAT, A.LOKASI_ALAMAT, A.NOCROSSDEF, A.JNSUZUR, A.NIK, A.NPWP, A.KDDOKUMEN, A.KETERANGAN, A.KDCABANG, A.INPUTER, A.UPDSTAMP, SUBSTR(A.KDJIWA_AKTIF,2,1) ISTRI, SUBSTR(A.KDJIWA_AKTIF,4,1) ANAK
		FROM  
			(
				SELECT 
				A.NOTAS
				,A.NIP
				,A.NO_KPE
				,(SELECT NMKEL  FROM  TASPEN.KELUARGA Z WHERE Z.NOTAS=TRIM(A.NOTAS) AND Z.KDHUBKEL='00') NAMA
				,(SELECT Z.JNSKEL FROM  TASPEN.KELUARGA Z WHERE Z.NOTAS=TRIM(A.NOTAS) AND Z.KDHUBKEL='00') JNSKEL
				,(SELECT Z.TGLLHR FROM  TASPEN.KELUARGA Z WHERE Z.NOTAS=TRIM(A.NOTAS) AND Z.KDHUBKEL='00') TGLLHR
				,A.TMT_KERJA
				,A.TMT_TASPEN
				,(SELECT Z.TGLWAFAT         FROM  TASPEN.KELUARGA Z WHERE Z.NOTAS=TRIM(A.NOTAS) AND Z.KDHUBKEL='00') TGLWAFAT
				,A.TGLPMK
				,(SELECT W.KDKELOMPOK       FROM  MIG_ACB.MUTASI_HIST W 		WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) KDKELOMPOK
				,(SELECT W.KDJENPEG         FROM  MIG_ACB.MUTASI_HIST W			WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) KDJNSPEG
				,(SELECT W.KDPANGKAT        FROM  MIG_ACB.MUTASI_HIST W			WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) KDPANGKAT
				,(SELECT W.MASKER 	        FROM  MIG_ACB.MUTASI_HIST W			WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) MASKER
				,(SELECT W.KDDUDUKAN        FROM  MIG_ACB.MUTASI_HIST W			WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) KDKEDUDUKAN
				,(SELECT N.BUP_MAX          FROM  MIG_ACB.KEDUDUKAN_TBL N 	WHERE N.KDDUDUKAN=(SELECT W.KDDUDUKAN FROM  MIG_ACB.MUTASI_HIST W WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS ))) BUP
				,(SELECT W.GAPOK 			FROM  MIG_ACB.MUTASI_HIST W 			WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) GAPOK
				,NULL GAPOK97
				,(SELECT W.KDSTAPEG 		FROM  MIG_ACB.MUTASI_HIST W 		WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) KDSTAPEG
				,(SELECT W.PERSENGAPOK 	    FROM  MIG_ACB.MUTASI_HIST W 		WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) PERSENGAPOK
				,(SELECT W.TMT_GAPOK 		FROM  MIG_ACB.MUTASI_HIST W 		WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) TMT_GAPOK
				,NULL TMT_GAPOK_TBL
				,(SELECT P.KDJIWA 			FROM  MIG_ACB.THP_HIST P 				WHERE P.NOTAS=A.NOTAS AND P.TMT_THP= (SELECT MAX(Y.TMT_THP)  FROM  MIG_ACB.THP_HIST Y WHERE Y.NOTAS=P.NOTAS)) KDJIWA_AKTIF
				,(SELECT P.NILAI_THP 		FROM  MIG_ACB.THP_HIST P 				WHERE P.NOTAS=A.NOTAS AND P.TMT_THP= (SELECT MAX(Y.TMT_THP)  FROM  MIG_ACB.THP_HIST Y WHERE Y.NOTAS=P.NOTAS))NILAI_THP
				,NULL NILAI_THP_97
				,A.BLTHGAJI
				,(SELECT MAX(Q.KDREG) 		FROM  MIG_ACB.REGISTRASI Q 			WHERE Q.NOTAS=A.NOTAS AND Q.KDHUBKEL='00' AND Q.TGLREG =(SELECT MAX(U.TGLREG) FROM MIG_ACB.REGISTRASI U WHERE U.NOTAS=Q.NOTAS)) KDREG
				,(SELECT MAX(Q.TGLREG) 		FROM  MIG_ACB.REGISTRASI Q 			WHERE Q.NOTAS=A.NOTAS AND Q.KDHUBKEL='00' AND Q.TGLREG =(SELECT MAX(U.TGLREG) FROM MIG_ACB.REGISTRASI U WHERE U.NOTAS=Q.NOTAS)) TGLREG
				,(SELECT MAX(Q.NOREG)  		FROM  MIG_ACB.REGISTRASI Q 			WHERE Q.NOTAS=A.NOTAS AND Q.KDHUBKEL='00' AND Q.TGLREG =(SELECT MAX(U.TGLREG) FROM MIG_ACB.REGISTRASI U WHERE U.NOTAS=Q.NOTAS)) NOREG
				,(SELECT W.KDSATKER 		FROM  MIG_ACB.MUTASI_HIST W 		WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) KDSATKER
				,(SELECT R.ALM_PESERTA 		FROM  MIG_ACB.ALAMAT_HIST R 		WHERE R.NOTAS=A.NOTAS AND R.KDHUBKEL='00' AND R.TMT_ALM=(SELECT MAX(N.TMT_ALM) FROM MIG_ACB.ALAMAT_HIST N WHERE N.NOTAS=R.NOTAS)) ALAMAT
				,(SELECT MAX(R.KDDATI1||R.KDDATI2||R.KDDATI3||R.KDDATI4)  
				                            FROM  MIG_ACB.ALAMAT_HIST R         WHERE R.NOTAS=A.NOTAS AND R.KDHUBKEL='00' AND  R.TMT_ALM=(SELECT MAX(N.TMT_ALM) FROM MIG_ACB.ALAMAT_HIST N WHERE N.NOTAS=R.NOTAS)) LOKASI_ALAMAT
				,(SELECT MAX(T.NOCROSSDEF)  FROM  MIG_ACB.CROSSDEFAULT T 	WHERE T.NOTAS=A.NOTAS  AND T.UPDSTAMP=(SELECT MAX(J.UPDSTAMP) FROM MIG_ACB.CROSSDEFAULT J WHERE J.NOTAS=T.NOTAS)) NOCROSSDEF
				,(SELECT MAX(U.JNSUZUR) 	FROM  MIG_ACB.HAK_UZUR U 		WHERE U.NOTAS=A.NOTAS AND U.KDHUBKEL='00' AND U.UPDSTAMP=(SELECT MAX(J.UPDSTAMP) FROM MIG_ACB.CROSSDEFAULT J WHERE J.NOTAS=U.NOTAS) ) JNSUZUR
				,(SELECT TRIM(Z.KTPNO) 		FROM  TASPEN.KELUARGA Z  		WHERE Z.NOTAS=TRIM(A.NOTAS) AND Z.KDHUBKEL='00')NIK
				,A.NPWP
				,(SELECT W.KDDOKUMEN 		FROM  MIG_ACB.MUTASI_HIST W		WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) KDDOKUMEN
				,(SELECT W.KETERANGAN 		FROM  MIG_ACB.MUTASI_HIST W		WHERE W.NOTAS=A.NOTAS  AND W.TMT_MUTASI =(SELECT MAX(G.TMT_MUTASI)FROM MIG_ACB.MUTASI_HIST G WHERE G.NOTAS=W.NOTAS )) KETERANGAN
				,A.KDCABANGO KDCABANG
				,A.INPUTER,
				A.UPDSTAMP
				,ROW_NUMBER() OVER ( PARTITION BY A.NOTAS ORDER BY A.UPDSTAMP DESC)AS RN
				FROM  MIG_ACB.PESERTA A 
			) A WHERE RN =1
	) A, TASPEN.KELUARGA V 
WHERE
trim(A.NOTAS)=trim(V.NOTAS) 
AND 
trim(A.KDHUBKEL)=TRIM(V.KDHUBKEL) 
AND 
V.KDHUBKEL='00' ;
INSERT INTO TASPEN.TRANS_DOSIR(KDSTATUS, KDCABANG, NODOSIR, KDHUBKEL, NOTAS, TMT_TRANSDOSIR, STS_DOSIR, PEMAKAI, KETERANGAN, PETUGAS_DOSIR, ATASAN_PEMAKAI, UPDSTAMP, INPUTER, TGLKEMBALI, TGLPINJAM)  SELECT 2,A.KDCABANG, NODOSIR, A.KDHUBKEL, TRIM(A.NOTAS), TMT_TRANSDOSIR, STS_DOSIR, PEMAKAI, A.KETERANGAN,NULL ,NULL,A.UPDSTAMP, A.INPUTER,NULL,NULL FROM MIG_ACB.DOSIR_KEMBALI A INNER JOIN TASPEN.PESERTA AS B ON TRIM(A.NOTAS)=B.NOTAS ;
INSERT INTO TASPEN.TRANS_DOSIR(KDSTATUS, KDCABANG, NODOSIR, KDHUBKEL, NOTAS, TMT_TRANSDOSIR, STS_DOSIR, PEMAKAI, KETERANGAN, PETUGAS_DOSIR, ATASAN_PEMAKAI, UPDSTAMP, INPUTER, TGLKEMBALI, TGLPINJAM) SELECT 1,A.KDCABANG, NODOSIR, A.KDHUBKEL, TRIM(A.NOTAS), TMT_TRANSDOSIR, STS_DOSIR, PEMAKAI, A.KETERANGAN, PETUGASDOSIR, ATASANPEMAKAI, CURRENT_DATE,'MIGRASI NCB',NULL,NULL FROM MIG_ACB.DOSIR_TRANS A INNER JOIN TASPEN.PESERTA AS B ON TRIM(A.NOTAS)=B.NOTAS ;
INSERT INTO TASPEN.KASUS_HIST(TMT_KASUS, KDKASUS, KDHUBKEL, NOTAS, KETERANGAN, UPDSTAMP, INPUTER) SELECT TMT_KASUS, KDKASUS, A.KDHUBKEL, TRIM(A.NOTAS), A.KETERANGAN, A.UPDSTAMP, A.INPUTER FROM MIG_ACB.KASUS_HIST A INNER JOIN TASPEN.PESERTA AS B ON TRIM(A.NOTAS)=B.NOTAS ;
INSERT INTO TASPEN.ROLLBACK_HIST(NOTAS, TGLKLAIM, KDPRODUK, KDKLAIM, KDFLOW_LAMA, KDFLOW_BARU, INPUTER, KDCABANG, UPDSTAMP, KDAJUAN, KETERANGAN) SELECT NOTAS, TGLKLAIM, KDPRODUK, KDKLAIM, KDFLOW_LAMA, KDFLOW_BARU, INPUTER, KDCABANG, UPDSTAMP, KDAJUAN, KETERANGAN FROM( SELECT A.NOTAS, TGLKLAIM, KDPRODUK, KDKLAIM, KDFLOW_LAMA, KDFLOW_BARU, A.INPUTER, A.KDCABANG, A.UPDSTAMP, KDAJUAN, A.KETERANGAN,ROW_NUMBER()OVER (PARTITION BY A.NOTAS, TGLKLAIM, KDPRODUK, KDKLAIM ORDER BY A.UPDSTAMP DESC) RN FROM MIG_ACB.ROLLBACK_HIST AS A INNER JOIN TASPEN.PESERTA AS B ON TRIM(A.NOTAS)=B.NOTAS) WHERE RN =1;









INSERT INTO TASPEN.APPROVE_REKONIURAN
SELECT 
"KDCABANG",
"BLTHGAJI",
"KELSSBP",
"KDSSBP",
"JNSGAJI",
1 "KDPRODUK",
"NAMA_INSTANSI",
"PEGAWAI_DBI",
(325/10000) *(IWP_DBI * 100/8) "IWP_DBI",
"PEGAWAI_GDO",
(325/10000) *(IWP_GDO * 100/8)  "IWP_GDO",
"PEGAWAI_SEL",
(325/10000) *(IWP_SEL * 100/8)  "IWP_SEL",
"PMK_DBI",
(325/10000) *(IWPPMK_DBI * 100/8) "IWPPMK_DBI",
"PMK_GDO",
(325/10000) *(IWPPMK_GDO * 100/8) "IWPPMK_GDO",
"PMK_SEL",
(325/10000) *(IWPPMK_SEL * 100/8)  "IWPPMK_SEL",
"DOBEL_DBI",
(325/10000) *(IWPDOBEL_DBI * 100/8)  "IWPDOBEL_DBI",
"DOBEL_GDO",
(325/10000) *(IWPDOBEL_GDO * 100/8)  "IWPDOBEL_GDO",
"DOBEL_SEL",
(325/10000) *(IWPDOBEL_SEL * 100/8) "IWPDOBEL_SEL",
"LAINNYA_DBI",
(325/10000) *(IWPLAINNYA_DBI * 100/8) "IWPLAINNYA_DBI",
"LAINNYA_GDO",
(325/10000) *(IWPLAINNYA_GDO * 100/8) "IWPLAINNYA_GDO",
"LAINNYA_SEL",
(325/10000) *(IWPLAINNYA_SEL * 100/8) "IWPLAINNYA_SEL",
"KETERANGAN_SELLAINNYA",
"HARUS_DBI",
(475/10000) *(IWPHARUS_DBI * 100/8) "IWPHARUS_DBI",
"HARUS_GDO",
(475/10000) *(IWPHARUS_GDO * 100/8) "IWPHARUS_GDO",
"HARUS_SEL",
(475/10000) *(IWPHARUS_SEL * 100/8) "IWPHARUS_SEL",
"INPUTER",
"UPDSTAMP"
 FROM "MIG_ACB"."APPROVE_REKONIWP"
  UNION ALL
SELECT 
"KDCABANG",
"BLTHGAJI",
"KELSSBP",
"KDSSBP",
"JNSGAJI",
4 "KDPRODUK",
"NAMA_INSTANSI",
"PEGAWAI_DBI",
(475/10000) *(IWP_DBI * 100/8) "IWP_DBI",
"PEGAWAI_GDO",
(475/10000) *(IWP_GDO * 100/8)  "IWP_GDO",
"PEGAWAI_SEL",
(475/10000) *(IWP_SEL * 100/8)  "IWP_SEL",
"PMK_DBI",
(475/10000) *(IWPPMK_DBI * 100/8) "IWPPMK_DBI",
"PMK_GDO",
(475/10000) *(IWPPMK_GDO * 100/8) "IWPPMK_GDO",
"PMK_SEL",
(475/10000) *(IWPPMK_SEL * 100/8)  "IWPPMK_SEL",
"DOBEL_DBI",
(475/10000) *(IWPDOBEL_DBI * 100/8)  "IWPDOBEL_DBI",
"DOBEL_GDO",
(475/10000) *(IWPDOBEL_GDO * 100/8)  "IWPDOBEL_GDO",
"DOBEL_SEL",
(475/10000) *(IWPDOBEL_SEL * 100/8) "IWPDOBEL_SEL",
"LAINNYA_DBI",
(475/10000) *(IWPLAINNYA_DBI * 100/8) "IWPLAINNYA_DBI",
"LAINNYA_GDO",
(475/10000) *(IWPLAINNYA_GDO * 100/8) "IWPLAINNYA_GDO",
"LAINNYA_SEL",
(475/10000) *(IWPLAINNYA_SEL * 100/8) "IWPLAINNYA_SEL",
"KETERANGAN_SELLAINNYA",
"HARUS_DBI",
(475/10000) *(IWPHARUS_DBI * 100/8) "IWPHARUS_DBI",
"HARUS_GDO",
(475/10000) *(IWPHARUS_GDO * 100/8) "IWPHARUS_GDO",
"HARUS_SEL",
(475/10000) *(IWPHARUS_SEL * 100/8) "IWPHARUS_SEL",
"INPUTER",
"UPDSTAMP"
 FROM "MIG_ACB"."APPROVE_REKONIWP"
   UNION ALL
SELECT 
"KDCABANG",
"BLTHGAJI",
"KELSSBP",
"KDSSBP",
"JNSGAJI",
8 "KDPRODUK",
"NAMA_INSTANSI",
"PEGAWAI_DBI",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWP_DBI * 100/54) ELSE (72/10000) *(IWP_DBI * 100/94) END  "IWP_DBI",
"PEGAWAI_GDO",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWP_GDO * 100/54) ELSE (72/10000) *(IWP_GDO * 100/94) END  "IWP_GDO",
"PEGAWAI_SEL",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWP_SEL * 100/54) ELSE (72/10000) *(IWP_SEL * 100/94) END  "IWP_SEL",
"PMK_DBI",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPPMK_DBI * 100/54) ELSE (72/10000) *(IWPPMK_DBI * 100/94) END "IWPPMK_DBI",
"PMK_GDO",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPPMK_GDO * 100/54) ELSE (72/10000) *(IWPPMK_GDO * 100/94) END "IWPPMK_GDO",
"PMK_SEL",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPPMK_SEL * 100/54) ELSE (72/10000) *(IWPPMK_SEL * 100/94)  END "IWPPMK_SEL",
"DOBEL_DBI",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPDOBEL_DBI * 100/54) ELSE (72/10000) *(IWPDOBEL_DBI * 100/94) END  "IWPDOBEL_DBI",
"DOBEL_GDO",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPDOBEL_GDO * 100/54) ELSE (72/10000) *(IWPDOBEL_GDO * 100/94)  END "IWPDOBEL_GDO",
"DOBEL_SEL",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPDOBEL_SEL * 100/54) ELSE (72/10000) *(IWPDOBEL_SEL * 100/94)  END"IWPDOBEL_SEL",
"LAINNYA_DBI",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPLAINNYA_DBI * 100/54) ELSE (72/10000) *(IWPLAINNYA_DBI * 100/94) END "IWPLAINNYA_DBI",
"LAINNYA_GDO",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPLAINNYA_GDO * 100/54) ELSE (72/10000) *(IWPLAINNYA_GDO * 100/94)  END"IWPLAINNYA_GDO",
"LAINNYA_SEL",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPLAINNYA_SEL * 100/54) ELSE (72/10000) *(IWPLAINNYA_SEL * 100/94) END "IWPLAINNYA_SEL",
"KETERANGAN_SELLAINNYA",
"HARUS_DBI",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPHARUS_DBI * 100/54) ELSE (72/10000) *(IWPHARUS_DBI * 100/94)END  "IWPHARUS_DBI",
"HARUS_GDO",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPHARUS_GDO * 100/54) ELSE (72/10000) *(IWPHARUS_GDO * 100/94) END  "IWPHARUS_GDO",
"HARUS_SEL",
CASE WHEN BLTHGAJI < '2018-02-01' THEN (24/10000) *(IWPHARUS_SEL * 100/54) ELSE (72/10000) *(IWPHARUS_SEL * 100/94) END "IWPHARUS_SEL",
"INPUTER",
"UPDSTAMP"
 FROM "MIG_ACB"."APPROVE_REKONJKK"
 UNION ALL
SELECT 
"KDCABANG",
"BLTHGAJI",
"KELSSBP",
"KDSSBP",
"JNSGAJI",
7 "KDPRODUK",
"NAMA_INSTANSI",
"PEGAWAI_DBI",
(30/10000) *(IWP_DBI * 100/54) "IWP_DBI",
"PEGAWAI_GDO",
(30/10000) *(IWP_GDO * 100/54)  "IWP_GDO",
"PEGAWAI_SEL",
(30/10000) *(IWP_SEL * 100/54)  "IWP_SEL",
"PMK_DBI",
(30/10000) *(IWPPMK_DBI * 100/54) "IWPPMK_DBI",
"PMK_GDO",
(30/10000) *(IWPPMK_GDO * 100/54) "IWPPMK_GDO",
"PMK_SEL",
(30/10000) *(IWPPMK_SEL * 100/54)  "IWPPMK_SEL",
"DOBEL_DBI",
(30/10000) *(IWPDOBEL_DBI * 100/54)  "IWPDOBEL_DBI",
"DOBEL_GDO",
(30/10000) *(IWPDOBEL_GDO * 100/54)  "IWPDOBEL_GDO",
"DOBEL_SEL",
(30/10000) *(IWPDOBEL_SEL * 100/54) "IWPDOBEL_SEL",
"LAINNYA_DBI",
(30/10000) *(IWPLAINNYA_DBI * 100/54) "IWPLAINNYA_DBI",
"LAINNYA_GDO",
(30/10000) *(IWPLAINNYA_GDO * 100/54) "IWPLAINNYA_GDO",
"LAINNYA_SEL",
(30/10000) *(IWPLAINNYA_SEL * 100/54) "IWPLAINNYA_SEL",
"KETERANGAN_SELLAINNYA",
"HARUS_DBI",
(30/10000) *(IWPHARUS_DBI * 100/54) "IWPHARUS_DBI",
"HARUS_GDO",
(30/10000) *(IWPHARUS_GDO * 100/54) "IWPHARUS_GDO",
"HARUS_SEL",
(30/10000) *(IWPHARUS_SEL * 100/54) "IWPHARUS_SEL",
"INPUTER",
"UPDSTAMP"
 FROM "MIG_ACB"."APPROVE_REKONJKK";
 
 
INSERT INTO TASPEN.KTRBYR_HIST 
SELECT A.TMT_KTRBYR, A.KDHUBKEL, A.NOTAS, A.KDKANBYR, A.JNSBAYAR, A.KDGROUP, 
    A.KDBENDAHARA, A.KDCABANG, A.NORUT_DAPEM, A.NOREKA, A.UPDSTAMP, A.INPUTER
	FROM MIG_ACB.KTRBYR_HIST A , TASPEN.PENERIMA_SK B, TASPEN.REF_JURU_BAYAR C 
	WHERE A.KDHUBKEL=B.KDHUBKEL AND A.NOTAS=B.NOTAS
	AND A.KDKANBYR=C.KDKANBYR
	 AND A.JNSBAYAR=C.JNSBAYAR
	 AND A.KDGROUP=C.KDGROUP
	 AND A.KDBENDAHARA = C.KDBENDAHARA
	 AND A.KDCABANG=C.KDCABANG;

INSERT INTO TASPEN.KLAIM_PENSIUN(TGLKLAIM, KDHUBKEL, NOTAS, NOVOUCHER, TGLTERIMA, TGLRENBAYAR, NMBANK, KDHUBKEL_PENERIMA, NMPENERIMA, TGLLHR_PENERIMA, JNSKELPENERIMA, ALAMAT, KDDATI1, KDDATI2, KDDATI3, KDDATI4, KDPOS, TELEPON, NOHP, NOKTP, NOREK, MASKER, JMLANAK, TMT_PENPOK, KDJNSPENERIMA, KDPANGKAT, KDKELOMPOK, KDSIFATPOK, KDKANBYR, JNSBAYAR, KDGROUP, KDBENDAHARA, KDCABANG, KEBERAPA, KDJNSPENSIUN, KDVOUCHER, KDDANA, KDPRODUK, TMT_RAPEL, TAT_RAPEL, JMLISTRI, KDHIT, HAKBERSIH, KDJNSPEG, NOSAP, KDKLAIM, KDJNSTRANS, KETERANGAN, NOANTRI, KDCABANG_PROSES, LANGSUNG, SUMBER_SPP, KODE_DOK, TGLDAMU, KDSTSDAMU, TGLCAIR, NOSETOR, TGLTERIMA_DAMU, UPDSTAMP, INPUTER) 
SELECT A.TGLKLAIM, A.KDHUBKEL KDHUBKEL_YMK,TRIM(A.NOTAS),A.NOVOUCHER_PENS NOVOUCHER,A.TGLTERIMA_PENS, A.TGLRENBAYAR,A.BANKNAMA NMBANK, 
NULL KDHUBKEL_PENERIMA, A.NMPENERIMA, A.TGLLHR_PENERIMA, A.JENKEL_PENERIMA , A.ALM_KLIMPENS, A.KDDATI1, A.KDDATI2, A.KDDATI3, A.KDDATI4, 
A.KODEPOS, A.TELEPON, A.TELEPON, A.NOKTP, A.NOREK, A.MASKER, A.JMLANAK, A.TMT_PENPOK, A.KDJNSPENERIMA, A.KDPANGKAT, A.KDKELOMPOK, 
A.KDSIFATPOK, A.KDKANBYR, A.JNSBAYAR, A.KDGROUP, A.KDBENDAHARA, A.KDCABANG, A.KEBERAPA, A.KDJNSPENSIUN, 
A.KDVOUCHER, A.KDDANA, A.KDPRODUK, A.TMT_RAPEL, A.TAT_RAPEL, A.JMLISTRI, A.KDHIT, 
0 HAKBERSIH, NULL KDJNSPEG, NULL NOSAP, 
B.KDKLAIM, B.KDJNSTRANS, B.KETERANGAN, B.NOANTRI, 
B.KDCABANG KDCABANG_PROSES, B.LANGSUNG, B.SUMBER_SPP, B.KODE_DOK, 
C.TGLDAMU, C.KDSTSDAMU, C.TGLCAIR, C.NOSETOR, C.TGLTERIMA TGLTERIMA_DAMU, A.UPDSTAMP, TRIM(A.INPUTER)
FROM MIG_ACB.KLAIM_PENSIUN A 
INNER JOIN  MIG_ACB.KLAIM_FLOW B ON A.NOTAS=B.NOTAS AND A.TGLKLAIM=B.TGLKLAIM AND A.KDHUBKEL =B.KDHUBKEL
LEFT JOIN MIG_ACB.TRANS_DAMUNONDAPEM C ON A.NOTAS=C.NOTAS
AND A.KDHUBKEL=C.KDHUBKEL
AND A.TGLKLAIM=C.TGLKLAIM AND C.NOSETOR IS NOT NULL
INNER JOIN TASPEN.KELUARGA D ON TRIM(A.NOTAS)=D.NOTAS AND A.KDHUBKEL =D.KDHUBKEL
INNER JOIN TASPEN.REF_DATI4 E ON  A.KDDATI4=E.KDDATI4 AND A.KDDATI3=E.KDDATI3 AND A.KDDATI2=E.KDDATI2 AND A.KDDATI1=E.KDDATI1 
WHERE A.KDKANBYR IS NOT NULL;



INSERT INTO TASPEN.TRS_DAPEM
( 
TGLDAPEM,
KDJNSTRANS,
NOTAS,
KDHUBKEL,
KDHUBKEL_WALI,
KDJIWA,
KDJNSPENSIUN,
DESK_JNSPENSIUN,
KDCABANG,
NMCABANG,
PENPOK,
TISTRI,
TANAK,
TP,
TKD,
TPP,
TPAJAK,
TBERAS,
TCACAT,
TTEWAS,
TDAHOR,
RAPEL,
TBULAT,
KOTOR,
PPAJAK,
PASKES,
PKPKN,
PKASDA,
PTASPEN,
PSEWA,
PASSOS,
PALIMENTASI,
TGR,
POTONGAN,
BERSIH,
NAMA_PENSIUNAN,
TGL_LAHIR_PENSIUNAN,
JNS_KELAMIN_PENSIUNAN,
NAMA_PENERIMA,
TGL_LAHIR_PENERIMA,
JNS_KELAMIN_PENERIMA,
KDPANGKAT,
KDHITUNG,
KDSIFATPOK,
MASKER,
JMLISTRI,
NPWP,
KDJURUBAYAR,
NMJURUBAYAR,
NOREK,
KDKELBAYAR,
NMKELBAYAR,
KD_OTENTIKASI,
TGL_OTENTIKASI,
KD_SETOR,
TGL_SETOR,
NOSETOR,
JNS_OTENTIKASI,
FLAG_LOCK,
NOTAS_CROSSDEFAULT,
JNS_TAGIHAN,
TGLREKAM,
TGLKEJADIAN,
UPDSTAMP,
INPUTER
)

SELECT 

AA.TGLDAPEM, 
AA.KDJNSTRANS, 
AA.NOTAS,
AA.KDHUBKEL,
AA.KDHUBKEL_WALI,
AA.KDJIWA,
AA.KDJNSPENSIUN,
AA.DESK_JNSPENSIUN,
AA.KDCABANG,
AA.NMCABANG,

AA.PENPOK, 
AA.TISTRI, 
AA.TANAK, 
AA.TP, 
AA.TKD, 
AA.TPP, 
AA.TPAJAK, 
AA.TBERAS, 
AA.TCACAT, 
AA.TTEWAS, 
AA.TDAHOR,
AA.RAPEL,
AA.TBULAT, 
AA.KOTOR, 

AA.PPAJAK, 
AA.PASKES, 
AA.PKPKN, 
AA.PKASDA, 
AA.PTASPEN, 
AA.PSEWA, 
AA.PASSOS, 
AA.PALIMENTASI, 
AA.TGR,
AA.POTONGAN, 
AA.BERSIH,

AA.NAMA_PENSIUNAN,
AA.TGL_LAHIR_PENSIUNAN,
AA.JNS_KELAMIN_PENSIUNAN,
AA.NAMA_PENERIMA,
AA.TGL_LAHIR_PENERIMA,
AA.JNS_KELAMIN_PENERIMA,

AA.KDPANGKAT,
AA.KDHITUNG,
AA.KDSIFATPOK,
AA.MASKER,
AA.JMLISTRI,
AA.NPWP,

AA.KDJURUBAYAR,
AA.NMJURUBAYAR,
AA.NOREK,
AA.KDKELBAYAR,
AA.NMKELBAYAR,

AA.KD_OTENTIKASI, 
AA.TGL_OTENTIKASI, 
AA.KD_SETOR, 
AA.TGL_SETOR,
AA.NOSETOR,

AA.JNS_OTENTIKASI,
AA.FLAG_LOCK,
AA.NOTAS_CROSSDEFAULT,

CASE 
	WHEN AA.JNS_TAGIHAN = 11 THEN 1
	WHEN AA.JNS_TAGIHAN = 22 THEN 2
	ELSE AA.JNS_TAGIHAN
END JNS_TAGIHAN,

CASE
	WHEN AA.JNS_TAGIHAN = 1 THEN
		(SELECT X.TGLKLAIM FROM MIG_ACB.TAGIHAN_UDW X 
			WHERE TRIM(X.NOTAS) = TRIM(AA.NOTAS) AND X.KDHUBKEL = AA.KDHUBKEL AND X.TGLPROSES = AA.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = AA.KDJNSTRANS) 
	WHEN AA.JNS_TAGIHAN IN (11,22) THEN
		(SELECT X.TGLREKAM FROM MIG_ACB.TAGIHAN_NONUDW X 
			WHERE TRIM(X.NOTAS) = TRIM(AA.NOTAS) AND X.KDHUBKEL = AA.KDHUBKEL AND X.TGLPROSES = AA.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = AA.KDJNSTRANS)
	WHEN AA.JNS_TAGIHAN = 3 THEN
		(SELECT X.TGLREKAM FROM MIG_ACB.TAGIHAN_REKPASIF X 
			WHERE TRIM(X.NOTAS) = TRIM(AA.NOTAS) AND X.KDHUBKEL = AA.KDHUBKEL AND X.TGLPROSES = AA.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = AA.KDJNSTRANS)
END TGLREKAM,

CASE
	WHEN AA.JNS_TAGIHAN = 1 THEN
		(SELECT X.TGLWAFAT FROM MIG_ACB.TAGIHAN_UDW X 
			WHERE TRIM(X.NOTAS) = TRIM(AA.NOTAS) AND X.KDHUBKEL = AA.KDHUBKEL AND X.TGLPROSES = AA.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = AA.KDJNSTRANS)
	WHEN AA.JNS_TAGIHAN IN (11,22) THEN
		(SELECT X.TGLKEJADIAN FROM MIG_ACB.TAGIHAN_NONUDW X 
			WHERE TRIM(X.NOTAS) = TRIM(AA.NOTAS) AND X.KDHUBKEL = AA.KDHUBKEL AND X.TGLPROSES = AA.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = AA.KDJNSTRANS)
END TGLKEJADIAN,

AA.UPDSTAMP,
AA.INPUTER


FROM (

SELECT 

A.TGLDAPEM, 
A.KDJNSTRANS, 
TRIM(A.NOTAS) AS NOTAS,
A.KDHUBKEL,
COALESCE((SELECT TRIM(X.KDHUBKELWALI) FROM MIG_ACB.PENERIMA_SK X WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) AND X.KDHUBKEL = A.KDHUBKEL), A.KDHUBKEL) AS KDHUBKEL_WALI,
A.KDJIWA,
A.JENIS AS KDJNSPENSIUN,
(SELECT TRIM(X.KETERANGAN) FROM MIG_ACB.KONV_PENSIUN X WHERE TRIM(X.KDJNSPENSIUN) = TRIM(A.JENIS)) AS DESK_JNSPENSIUN,
A.KODECABANG AS KDCABANG,
( SELECT TRIM(X.NMCABANG) FROM MIG_ACB.CABANG_TBL X WHERE TRIM(X.KDCABANG) = TRIM(A.KODECABANG) ) AS NMCABANG,

A.PENPOK, 
A.TISTRI, 
A.TANAK, 
A.TP, 
A.TKD, 
A.TPP, 
A.TPAJAK, 
A.TBERAS, 
A.TCACAT, 
A.TTEWAS, 
A.TDAHOR,
A.RAPEL,
A.TBULAT, 
A.KOTOR, 

A.PPAJAK, 
A.PASKES, 
A.PKPKN, 
A.PKASDA, 
A.PTASPEN, 
A.PSEWA, 
A.PASSOS, 
A.PALIMENTASI, 
COALESCE(A.TGR,0) AS TGR,
A.POTONGAN, 
A.BERSIH,

TRIM(A.NAMAPENSIUNAN) AS NAMA_PENSIUNAN,
A.TGL_LAHIR_PENSIUNAN,
(SELECT X.JENKEL FROM MIG_ACB.KELUARGA X WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) AND X.KDHUBKEL = '00') AS JNS_KELAMIN_PENSIUNAN,
TRIM(A.NAMA_PENERIMA) AS NAMA_PENERIMA,
A.TGL_LAHIR_PENERIMA,
(SELECT X.JENKEL FROM MIG_ACB.KELUARGA X WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) AND X.KDHUBKEL = A.KDHUBKEL) AS JNS_KELAMIN_PENERIMA,

A.KDPANGKAT,
A.KDHITUNG,
A.KDSIFATPOK,
A.MASKER,
A.JMLISTRI,
TRIM(A.NPWP) AS NPWP,

A.KODEBYR AS KDJURUBAYAR,
TRIM(B.NMKANBYR) AS NMJURUBAYAR,
TRIM(A.NOREK) AS NOREK,
B.KDKELBAYAR,
(SELECT TRIM(X.NMKELBAYAR) FROM MIG_ACB.KELOMPOK_BAYAR X WHERE X.KDKELBAYAR = B.KDKELBAYAR) AS NMKELBAYAR,

A.INFOBANK AS KD_OTENTIKASI, 
A.TGLDIAMBIL AS TGL_OTENTIKASI, 
A.JNSSETOR AS KD_SETOR, 
A.TGLSETOR AS TGL_SETOR,
 
( SELECT MAX(TRIM(X.NOSETOR)) 
	FROM MIG_ACB.TRANS_DAMU X 
	WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) AND X.TGLPROSES = A.TGLDAPEM 
		AND CAST(X.KDJNSTRANS AS SMALLINT) = A.KDJNSTRANS AND X.KDSTSDAMU IN (2,3,4) 
		AND X.KDHUBKEL = A.KDHUBKEL ) AS NOSETOR,
		
COALESCE(A.KDOTENTIKASI,4) AS JNS_OTENTIKASI,
CAST(0 AS SMALLINT) AS FLAG_LOCK,

( SELECT MAX(TRIM(X.NOCROSSDEF)) FROM MIG_ACB.CROSSDEFAULT X WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) ) AS NOTAS_CROSSDEFAULT,

CASE
	WHEN (SELECT COUNT(*) FROM MIG_ACB.TAGIHAN_UDW X 
			WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) AND X.KDHUBKEL = A.KDHUBKEL AND X.TGLPROSES = A.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = A.KDJNSTRANS) > 0 THEN 1
	WHEN (SELECT COUNT(*) FROM MIG_ACB.TAGIHAN_NONUDW X 
			WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) AND X.KDHUBKEL = A.KDHUBKEL AND X.TGLPROSES = A.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = A.KDJNSTRANS AND X.KODE = 1) > 0 THEN 11
	WHEN (SELECT COUNT(*) FROM MIG_ACB.TAGIHAN_NONUDW X 
			WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) AND X.KDHUBKEL = A.KDHUBKEL AND X.TGLPROSES = A.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = A.KDJNSTRANS AND X.KODE = 2) > 0 THEN 22
	WHEN (SELECT COUNT(*) FROM MIG_ACB.TAGIHAN_REKPASIF X 
			WHERE TRIM(X.NOTAS) = TRIM(A.NOTAS) AND X.KDHUBKEL = A.KDHUBKEL AND X.TGLPROSES = A.TGLDAPEM AND CAST(X.KDJNSTRANS AS SMALLINT) = A.KDJNSTRANS) > 0 THEN 3
	ELSE 0
END JNS_TAGIHAN,

A.UPDSTAMP,
TRIM(A.INPUTER) AS INPUTER

FROM MIG_ACB.DAPEM_B A, MIG_ACB.JURU_BAYAR B
WHERE A.TGLDAPEM > '2018-01-01'
	AND SUBSTR(A.KODEBYR,1,3) = B.KDCABANG
	AND SUBSTR(A.KODEBYR,4,1) = B.KDBENDAHARA
	AND SUBSTR(A.KODEBYR,5,2) = B.KDGROUP
	AND SUBSTR(A.KODEBYR,7,2) = B.JNSBAYAR
	AND SUBSTR(A.KODEBYR,9,4) = B.KDKANBYR
ORDER BY A.TGLDAPEM DESC

) AA
;

	UPSERT TASPEN.PESERTA_CUTOFF (TANGGAL_CUTOFF,BLTHGAJI,NOTAS,KDCABANG,KDHUBKEL,NIP,NO_KPE,NAMA,JNSKEL,TGLLHR,TMT_KERJA,TMT_TASPEN,TGLWAFAT,TGLPMK,KDKELOMPOK,KDJNSPEG,KDPANGKAT,MASKER,KDKEDUDUKAN,BUP,GAPOK,GAPOK_97,KDSTAPEG,PERSENGAPOK,TMT_GAPOK,TMT_GAPOK_TBL,KDJIWA_AKTIF,JMLISTRI,JMLANAK,NILAI_THP,NILAI_THP_97,KDREG,TGLREG,NOREG,KDSATKER,ALAMAT,LOKASI_ALAMAT,NOCROSSDEF,JNSUZUR,NIK,NPWP,KDDOKUMEN,KETERANGAN,IURAN_THT,IURAN_PENSIUN,IURAN_JKK,IURAN_JKM,FLAG_IURAN,USIA,USIAMASUK,USIA2001,NOURUT,GAPOK_2015,NILAI_THP_2015,INPUTER,UPDSTAMP)
	SELECT 
	A.TMT_PREMI,
	A.TMT_MUTASI AS  BLTHGAJI,
	TRIM(trailing ' ' from A.NOTAS) NOTAS,
	A.KDCAB AS KDCABANG,
	'00'  KDHUBKEL,
	A.NIPPA NIP,
	A.NO_KPE,
	REPLACE (REPLACE(TRIM(CHAR(160) FROM A.NAMA),'\t',''),'\n','') NAMA,
	CASE WHEN A.SEX  NOT IN(1,2) THEN 1 ELSE A.SEX END JNSKEL,
	A.TGLLHR,
	A.TMT_KERJA,
	A.TMT_TASPEN,
	NULL TGLWAFAT,
	(SELECT B.TGLPMK FROM MIG_ACB.PESERTA B WHERE B.NOTAS=A.NOTAS) ,
	A.KDKELOMPOK,
	A.KDJENPEG KDJNSPEG,
	TRIM(A.KDPANGKAT),
	(SELECT Z.MASKER FROM MIG_ACB.MUTASI_HIST Z 
	WHERE Z.NOTAS=A.NOTAS
	AND Z.TMT_MUTASI=(SELECT MAX(R.TMT_MUTASI) FROM MIG_ACB.MUTASI_HIST R WHERE R.NOTAS=Z.NOTAS AND R.TMT_MUTASI < A.TMT_PREMI)---'2018-08-01';
	) MASKER,
	A.KDDUDUKAN,
	A.USIA_BUP BUP,
	A.GAPOK,
	NULL GAPOK_97,
	A.KDSTAPEG,
	(SELECT Z.PERSENGAPOK FROM MIG_ACB.MUTASI_HIST Z 
	WHERE Z.NOTAS=A.NOTAS
	AND Z.TMT_MUTASI=(SELECT MAX(R.TMT_MUTASI) FROM MIG_ACB.MUTASI_HIST R WHERE R.NOTAS=Z.NOTAS AND R.TMT_MUTASI < A.TMT_PREMI) ---'2018-08-01';
	) PERSENGAPOK,
	A.TMT_GAPOK,
	NULL TMT_GAPOK_TBL,
	'1'||CAST(J_ISTRI AS CHAR(1))||'0'||CAST(J_ANAK  AS CHAR(1)) AS KDJIWA_AKTIF,
	J_ISTRI AS JMLISTRI,
	J_ANAK AS JMLANAK,
	A.THP NILAI_THP,
	NULL NILAI_THP_97,
	(SELECT MAX(Q.KDREG) FROM  MIG_ACB.REGISTRASI Q WHERE Q.NOTAS=A.NOTAS AND Q.KDHUBKEL='00'
	 AND Q.TGLREG =(SELECT MAX(U.TGLREG) FROM MIG_ACB.REGISTRASI U WHERE U.NOTAS=Q.NOTAS)) KDREG,
	(SELECT MAX(Q.TGLREG) FROM  MIG_ACB.REGISTRASI Q WHERE Q.NOTAS=A.NOTAS AND Q.KDHUBKEL='00' 
	AND Q.TGLREG =(SELECT MAX(U.TGLREG) FROM MIG_ACB.REGISTRASI U WHERE U.NOTAS=Q.NOTAS) ) TGLREG,
	(SELECT MAX(Q.NOREG)  FROM  MIG_ACB.REGISTRASI Q WHERE Q.NOTAS=A.NOTAS AND Q.KDHUBKEL='00'
	 AND Q.TGLREG =(SELECT MAX(U.TGLREG) FROM MIG_ACB.REGISTRASI U WHERE U.NOTAS=Q.NOTAS)) NOREG,
	REPLACE (REPLACE(TRIM(CHAR(160) FROM A.KDSATKER),'\t',''),'\n','')KDSATKER,
	(SELECT  R.ALM_PESERTA FROM  MIG_ACB.ALAMAT_HIST R WHERE R.NOTAS=A.NOTAS AND R.KDHUBKEL='00'
	 AND R.TMT_ALM=(SELECT MAX(N.TMT_ALM) FROM MIG_ACB.ALAMAT_HIST N WHERE N.NOTAS=R.NOTAS))  ALAMAT,
	(SELECT MAX(R.KDDATI1||R.KDDATI2||R.KDDATI3||R.KDDATI4) FROM  MIG_ACB.ALAMAT_HIST R WHERE R.NOTAS=A.NOTAS 
	AND R.KDHUBKEL='00' AND  R.TMT_ALM=(SELECT MAX(N.TMT_ALM) FROM MIG_ACB.ALAMAT_HIST N WHERE N.NOTAS=R.NOTAS)) LOKASI_ALAMAT,
	(SELECT MAX(T.NOCROSSDEF) FROM  MIG_ACB.CROSSDEFAULT T WHERE T.NOTAS=A.NOTAS 
	AND T.UPDSTAMP=(SELECT MAX(J.UPDSTAMP) FROM MIG_ACB.CROSSDEFAULT J WHERE J.NOTAS=T.NOTAS))  NOCROSSDEF,
	(SELECT MAX(U.JNSUZUR) FROM  MIG_ACB.HAK_UZUR U WHERE U.NOTAS=A.NOTAS AND U.KDHUBKEL='00'
	AND U.UPDSTAMP=(SELECT MAX(J.UPDSTAMP) FROM MIG_ACB.HAK_UZUR J WHERE J.NOTAS=U.NOTAS) ) JNSUZUR,
	(SELECT  TRIM(Z.KTPNO) FROM  MIG_ACB.KELUARGA Z WHERE Z.NOTAS=A.NOTAS AND Z.KDHUBKEL='00') NIK,
	(SELECT B.NPWP FROM MIG_ACB.PESERTA B WHERE B.NOTAS=A.NOTAS) AS NPWP,
	0 KDDOKUMEN,
	NULL KETERANGAN,
	(SELECT MAX(Z.IUR_THT)   FROM   MIG_ACB.ESTIMASI_IWP Z WHERE Z.NOTAS=A.NOTAS AND Z.JNSGAJI=1 AND Z.TMT_PREMI=A.TMT_PREMI )IUR_THT,
	(SELECT MAX(Z.IUR_PENS)   FROM  MIG_ACB.ESTIMASI_IWP Z WHERE Z.NOTAS=A.NOTAS AND Z.JNSGAJI=1 AND Z.TMT_PREMI=A.TMT_PREMI )IUR_PENS,
	(SELECT MAX(Z.TAGIHAN_JKK)   FROM  MIG_ACB.TAGIHAN_JKK Z WHERE Z.NOTAS=A.NOTAS AND Z.JNSGAJI=1 AND Z.BLTH_TAGIHAN=A.TMT_PREMI )IUR_JKK,
	(SELECT MAX(Z.TAGIHAN_JKM)   FROM  MIG_ACB.TAGIHAN_JKK Z WHERE Z.NOTAS=A.NOTAS AND Z.JNSGAJI=1 AND Z.BLTH_TAGIHAN=A.TMT_PREMI )IUR_JKM
	,0 FLAG_IURAN
	,0 USIA
	,0 USIAMASUK
	,0 USIA2001
	,0 NOURUT
	,0 GAPOK_2015
	,0 NILAI_THP_2015 ,
	'MIGRASI NCB' AS INPUTER,
	A.TGLUPD AS UPDSTAMP
	FROM  MIG_ACB.PESERTA_CUTOFF AS A INNER JOIN TASPEN.REF_CABANG AS RC ON TRIM(A.KDCAB)=TRIM(RC.REF_CABANG)
	WHERE	A.KDPANGKAT IS NOT NULL AND A.NIPPA IS NOT NULL
	--AND 
	--YEAR(TMT_PREMI) =2008
	--YEAR(TMT_PREMI) =2009
	--YEAR(TMT_PREMI) =2010
	--YEAR(TMT_PREMI) =2011
	--YEAR(TMT_PREMI) =2012
	--YEAR(TMT_PREMI) =2013
	--YEAR(TMT_PREMI) =2014
	--YEAR(TMT_PREMI) =2015
	--YEAR(TMT_PREMI) =2016
	--YEAR(TMT_PREMI) =2017
	--YEAR(TMT_PREMI) =2018
	;


ALTER TABLE "TASPEN"."TRANS_PENSIUN" 	ADD CONSTRAINT "FK_TRANS_PENSIUN_PENERIMA_SK" FOREIGN KEY ( "KDHUBKEL", "NOTAS" ) REFERENCES "TASPEN"."PENERIMA_SK" ("KDHUBKEL", "NOTAS") ON UPDATE RESTRICT ON DELETE CASCADE;
ALTER TABLE "TASPEN"."PESERTA_CUTOFF" 	ADD CONSTRAINT "KDCABANG_17_FK" FOREIGN KEY ( "KDCABANG" ) REFERENCES "TASPEN"."REF_CABANG" ("KDCABANG") ON UPDATE RESTRICT ON DELETE RESTRICT;

UPDATE TASPEN.PESERTA_CUTOFF
SET 
USIA = TASPEN.FC_CARIMASA_TAHUN(TGLLHR,BLTHGAJI),
USIAMASUK = ROUND(TASPEN.FC_CARIMASA_TAHUN(TGLLHR,TMT_TASPEN)  + TASPEN.FC_HIT_UM(TGLLHR,TMT_TASPEN),2),
USIA2001 = CASE WHEN YEAR(TMT_TASPEN) >  2001 THEN
        USIAMASUK ELSE 
        ROUND(TASPEN.FC_CARIMASA_TAHUN(TGLLHR,CAST('2001-01-01' AS DATE))  + TASPEN.FC_HIT_UM(TGLLHR,CAST('2001-01-01' AS DATE)),2)
        END ,
JMLISTRI = TO_INT(SUBSTRING(KDJIWA_AKTIF,2,1)),
JMLANAK = TO_INT(SUBSTRING(KDJIWA_AKTIF,4,1)),
NO_URUT =ROW_NUMBER() OVER(partition by notas order by blthgaji,notas)
;

